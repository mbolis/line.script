{"version":3,"file":"app.js","sources":["../node_modules/mainloop.js/build/mainloop.min.js","../node_modules/codemirror/lib/codemirror.js","../node_modules/codemirror/mode/javascript/javascript.js","../src/geometry.ts","../src/frames.ts","../__vite-browser-external","../node_modules/js-interpreter/lib/js-interpreter.js","../src/scene.ts","../src/output.ts","../src/interpreter.ts","../src/gui.ts","../node_modules/events/events.js","../src/disk.ts","../src/index.ts"],"sourcesContent":["/**\n * mainloop.js 1.0.3-20170529\n *\n * @author Isaac Sukin (http://www.isaacsukin.com/)\n * @license MIT\n */\n\n!function(a){function b(a){if(x=q(b),!(a<e+l)){for(d+=a-e,e=a,t(a,d),a>i+h&&(f=g*j*1e3/(a-i)+(1-g)*f,i=a,j=0),j++,k=0;d>=c;)if(u(c),d-=c,++k>=240){o=!0;break}v(d/c),w(f,o),o=!1}}var c=1e3/60,d=0,e=0,f=60,g=.9,h=1e3,i=0,j=0,k=0,l=0,m=!1,n=!1,o=!1,p=\"object\"==typeof window?window:a,q=p.requestAnimationFrame||function(){var a=Date.now(),b,d;return function(e){return b=Date.now(),d=Math.max(0,c-(b-a)),a=b+d,setTimeout(function(){e(b+d)},d)}}(),r=p.cancelAnimationFrame||clearTimeout,s=function(){},t=s,u=s,v=s,w=s,x;a.MainLoop={getSimulationTimestep:function(){return c},setSimulationTimestep:function(a){return c=a,this},getFPS:function(){return f},getMaxAllowedFPS:function(){return 1e3/l},setMaxAllowedFPS:function(a){return\"undefined\"==typeof a&&(a=1/0),0===a?this.stop():l=1e3/a,this},resetFrameDelta:function(){var a=d;return d=0,a},setBegin:function(a){return t=a||t,this},setUpdate:function(a){return u=a||u,this},setDraw:function(a){return v=a||v,this},setEnd:function(a){return w=a||w,this},start:function(){return n||(n=!0,x=q(function(a){v(1),m=!0,e=a,i=a,j=0,x=q(b)})),this},stop:function(){return m=!1,n=!1,r(x),this},isRunning:function(){return m}},\"function\"==typeof define&&define.amd?define(a.MainLoop):\"object\"==typeof module&&null!==module&&\"object\"==typeof module.exports&&(module.exports=a.MainLoop)}(this);\n//# sourceMappingURL=mainloop.min.js.map","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\n\n// This is CodeMirror (https://codemirror.net/5), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\/(\\d+)/.exec(userAgent);\n  var chrome_version = chrome && +chrome[1];\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = safari && (/Mobile\\/\\w+/.test(userAgent) || navigator.maxTouchPoints > 2);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt(rootNode) {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var doc = rootNode.ownerDocument || rootNode;\n    var activeElement;\n    try {\n      activeElement = rootNode.activeElement;\n    } catch(e) {\n      activeElement = doc.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function doc(cm) { return cm.display.wrapper.ownerDocument }\n\n  function root(cm) {\n    return rootNode(cm.display.wrapper)\n  }\n\n  function rootNode(element) {\n    // Detect modern browsers (2017+).\n    return element.getRootNode ? element.getRootNode() : element.ownerDocument\n  }\n\n  function win(cm) { return doc(cm).defaultView }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 50;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\\\s)\" + lineClass[2] + \"(?:$|\\\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n\n  // Add a span to a line.\n  function addMarkedSpan(line, span, op) {\n    var inThisOp = op && window.WeakSet && (op.markedSpans || (op.markedSpans = new WeakSet));\n    if (inThisOp && line.markedSpans && inThisOp.has(line.markedSpans)) {\n      line.markedSpans.push(span);\n    } else {\n      line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n      if (inThisOp) { inThisOp.add(line.markedSpans); }\n    }\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css || attributes) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      gutterWrap.setAttribute(\"aria-hidden\", \"true\");\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    if (lineView.rest) {\n      for (var i = 0; i < lineView.rest.length; i++)\n        { if (lineView.rest[i] == line)\n          { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n      for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n        { if (lineNo(lineView.rest[i$1]) > lineN)\n          { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n    }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX(doc) {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(doc.body.getBoundingClientRect().left - parseInt(getComputedStyle(doc.body).marginLeft)) }\n    return doc.defaultView.pageXOffset || (doc.documentElement || doc.body).scrollLeft\n  }\n  function pageScrollY(doc) {\n    if (chrome && android) { return -(doc.body.getBoundingClientRect().top - parseInt(getComputedStyle(doc.body).marginTop)) }\n    return doc.defaultView.pageYOffset || (doc.documentElement || doc.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var ref = visualLine(lineObj);\n    var widgets = ref.widgets;\n    var height = 0;\n    if (widgets) { for (var i = 0; i < widgets.length; ++i) { if (widgets[i].above)\n      { height += widgetHeight(widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY(doc(cm)));\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX(doc(cm)));\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX(doc(cm));\n      top -= pageScrollY(doc(cm));\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e$1) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    var customCursor = cm.options.$customCursor;\n    if (customCursor) { primary = true; }\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (customCursor) {\n        var head = customCursor(cm, range);\n        if (head) { drawSelectionCursor(cm, head, curFragment); }\n      } else if (collapsed || cm.options.showCursorWhenSelecting) {\n        drawSelectionCursor(cm, range.head, curFragment);\n      }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (/\\bcm-fat-cursor\\b/.test(cm.getWrapperElement().className)) {\n      var charPos = charCoords(cm, head, \"div\", null, null);\n      var width = charPos.right - charPos.left;\n      cursor.style.width = (width > 0 ? width : cm.defaultCharWidth()) + \"px\";\n    }\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () {\n        if (!cm.hasFocus()) { onBlur(cm); }\n        display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.hasFocus()) {\n      cm.display.input.focus();\n      if (!cm.state.focused) { onFocus(cm); }\n    }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      if (cm.state.focused) { onBlur(cm); }\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent && !cm.state.draggingText) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    var viewTop = Math.max(0, display.scroller.getBoundingClientRect().top);\n    var oldHeight = display.lineDiv.getBoundingClientRect().top;\n    var mustScroll = 0;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      oldHeight += cur.line.height;\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        if (oldHeight < viewTop) { mustScroll -= diff; }\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n    if (Math.abs(mustScroll) > 2) { display.scroller.scrollTop += mustScroll; }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    var doc = display.wrapper.ownerDocument;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (doc.defaultView.innerHeight || doc.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var gutterSpace = cm.options.fixedGutter ? 0 : display.gutters.offsetWidth;\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft - gutterSpace;\n    var screenw = displayWidth(cm) - display.gutters.offsetWidth;\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left + gutterSpace - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.scrollTop = 0;\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.visibility = this.vert.style.visibility = \"hidden\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.visibility = \"\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.visibility = \"hidden\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId,          // Unique ID\n      markArrays: null         // Used by addMarkedSpan\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt(root(cm));\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt(root(cm));\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = win(cm).getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt(rootNode(snapshot.activeElt))) { return }\n    snapshot.activeElt.focus();\n    if (!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName) &&\n        snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var doc = snapshot.activeElt.ownerDocument;\n      var sel = doc.defaultView.getSelection(), range = doc.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n    // Send an event to consumers responding to changes in gutter width.\n    signalLater(display, \"gutterChanged\", display);\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n    // See #6982. FIXME remove when this has been fixed for a while in Chrome\n    if (chrome && chrome_version >= 105) { d.wrapper.style.clipPath = \"inset(0px)\"; }\n\n    // This attribute is respected by automatic translation systems such as Google Translate,\n    // and may also be respected by tools used by human translators.\n    d.wrapper.setAttribute('translate', 'no');\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    // On Chrome 102, viewport updates somehow stop wheel-based\n    // scrolling. Turning off pointer events during the scroll seems\n    // to avoid the issue.\n    if (chrome && chrome_version == 102) {\n      if (cm.display.chromeScrollHack == null) { cm.display.sizer.style.pointerEvents = \"none\"; }\n      else { clearTimeout(cm.display.chromeScrollHack); }\n      cm.display.chromeScrollHack = setTimeout(function () {\n        cm.display.chromeScrollHack = null;\n        cm.display.sizer.style.pointerEvents = \"\";\n      }, 100);\n    }\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n    var pixelsPerUnit = wheelPixelsPerUnit;\n    if (e.deltaMode === 0) {\n      dx = e.deltaX;\n      dy = e.deltaY;\n      pixelsPerUnit = 1;\n    }\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && pixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * pixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * pixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && pixelsPerUnit != null) {\n      var pixels = dy * pixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20 && e.deltaMode !== 0) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    cm.options.direction = doc.direction;\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(prev) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = prev ? prev.undoDepth : Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = prev ? prev.maxGeneration : 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm && doc.cm.getOption(\"readOnly\") != \"nocursor\")\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = range.head == range.anchor ? newAnchor : skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null), doc.cm && doc.cm.curOp);\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      if (lineSep === '') { return lines.join('') }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head || ranges[i].anchor)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e$1){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 224: \"Mod\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\", \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\",\n    \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\",\n    \"Ctrl-T\": \"transposeChars\", \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Mod\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"codepoint\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    cm.curOp.focus = activeElt(root(cm));\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    win(cm).focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(root(cm)); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      if (cm.state.delayingBlurEvent) {\n        if (cm.hasFocus()) { cm.state.delayingBlurEvent = false; }\n        else { delayBlurEvent(cm); }\n      }\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if ((webkit && !safari) || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus({preventScroll: true}); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { return display.input.focus(); }, 20);\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    if (ie) { delayBlurEvent(cm); }\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt(root(cm));\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e$1) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b\\u200e\\u200f\\u2028\\u2029\\u202d\\u202e\\u2066\\u2067\\u2069\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n\n    option(\"screenReaderLabel\", null, function (cm, val) {\n      val = (val === '') ? null : val;\n      cm.display.input.screenReaderLabelChanged(val);\n    });\n\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(function () {\n        if (this$1.hasFocus() && !this$1.state.focused) { onFocus(this$1); }\n      }, 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == textLines.join(\"\\n\"))\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput && cm.hasFocus())\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"on\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"on\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){win(this).focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt(root(this)) },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5 || this.options.lineWrapping)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"codepoint\", \"char\", \"column\" (like char, but\n  // doesn't cross line boundaries), \"word\" (across next word), or\n  // \"group\" (to the start of next group of word or\n  // non-word-non-whitespace chars). The visually param controls\n  // whether, in right-to-left text, direction 1 means to move towards\n  // the next index in the string, or towards the character to the right\n  // of the current position. The resulting position will have a\n  // hitSide=true property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (unit == \"codepoint\") {\n        var ch = lineObj.text.charCodeAt(pos.ch + (dir > 0 ? 0 : -1));\n        if (isNaN(ch)) {\n          next = null;\n        } else {\n          var astral = dir > 0 ? ch >= 0xD800 && ch < 0xDC00 : ch >= 0xDC00 && ch < 0xDFFF;\n          next = new Pos(pos.line, Math.max(0, Math.min(lineObj.text.length, pos.ch + dir * (astral ? 2 : 1))), -dir);\n        }\n      } else if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\" || unit == \"codepoint\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, win(cm).innerHeight || doc(cm).documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    div.contentEditable = true;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    function belongsToInput(e) {\n      for (var t = e.target; t; t = t.parentNode) {\n        if (t == div) { return true }\n        if (/\\bCodeMirror-(?:line)?widget\\b/.test(t.className)) { break }\n      }\n      return false\n    }\n\n    on(div, \"paste\", function (e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      disableBrowserMagic(te);\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = activeElt(rootNode(div));\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.div.setAttribute('aria-label', label);\n    } else {\n      this.div.removeAttribute('aria-label');\n    }\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = activeElt(rootNode(this.div)) == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || activeElt(rootNode(this.div)) != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n      var this$1 = this;\n\n    var input = this;\n    if (this.selectionInEditor())\n      { setTimeout(function () { return this$1.pollSelection(); }, 20); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n    this.resetting = false;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n    var opts = this.cm.options;\n    disableBrowserMagic(this.textarea, opts.spellcheck, opts.autocorrect, opts.autocapitalize);\n  };\n\n  TextareaInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.textarea.setAttribute('aria-label', label);\n    } else {\n      this.textarea.removeAttribute('aria-label');\n    }\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing && typing) { return }\n    var cm = this.cm;\n    this.resetting = true;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n    this.resetting = false;\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt(rootNode(this.textarea)) != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || this.resetting || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = te.ownerDocument.defaultView.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { te.ownerDocument.defaultView.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n    this.textarea.readOnly = !!val;\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt(rootNode(textarea));\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, …*/) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.65.18\";\n\n  return CodeMirror;\n\n})));\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var trackScope = parserConfig.trackScope !== false\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d[\\d_]*(?:[eE][+\\-]?[\\d_]+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^[\\d_]*(?:n|(?:\\.[\\d_]*)?(?:[eE][+\\-]?[\\d_]+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\" && stream.peek() == \"!\") {\n      stream.skipToEnd();\n      return ret(\"meta\", \"meta\");\n    } else if (ch == \"#\" && stream.eatWhile(wordRE)) {\n      return ret(\"variable\", \"property\")\n    } else if (ch == \"<\" && stream.match(\"!--\") ||\n               (ch == \"-\" && stream.match(\"->\") && !/\\S/.test(stream.string.slice(0, stream.start)))) {\n      stream.skipToEnd()\n      return ret(\"comment\", \"comment\")\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-|&?]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      if (ch == \"?\" && stream.eat(\".\")) return ret(\".\")\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*([^*]|\\*(?!\\/))*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/`]/.test(ch)) {\n        for (;; --pos) {\n          if (pos == 0) return\n          var next = stream.string.charAt(pos - 1)\n          if (next == ch && stream.string.charAt(pos - 2) != \"\\\\\") { pos--; break }\n        }\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true,\n                     \"regexp\": true, \"this\": true, \"import\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    if (!trackScope) return false\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (!trackScope) return\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  pushcontext.lex = pushblockcontext.lex = true\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), pushblockcontext, forspec, statement, popcontext, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(maybeexpression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^<>]|<[^<>]*>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(maybeexpression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function maybetypeOrIn(type, value) {\n    if (isTS && (type == \":\" || value == \"in\")) return cont(typeexpr)\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\" || value == \"readonly\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), typeprops, poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n    if (type == \"quasi\") { return pass(quasiType, afterType); }\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprops(type) {\n    if (type.match(/[\\}\\)\\]]/)) return cont()\n    if (type == \",\" || type == \";\") return cont(typeprops)\n    return pass(typeprop, typeprops)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetypeOrIn, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    } else if (!type.match(/[;\\}\\)\\],]/)) {\n      return cont()\n    }\n  }\n  function quasiType(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasiType);\n    return cont(typeexpr, continueQuasiType);\n  }\n  function continueQuasiType(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasiType);\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+#?[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(classfield, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(classfield, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), classfield, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"!\") return cont(classfield)\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    if (type == \".\") return pass(maybeoperatorComma);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment || state.tokenize == tokenQuasi) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse && c != popcontext) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      parseJS(state, \"atom\", \"atom\", \"true\", new CodeMirror.StringStream(\"\", 2, null))\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", { name: \"javascript\", json: true });\nCodeMirror.defineMIME(\"application/x-json\", { name: \"javascript\", json: true });\nCodeMirror.defineMIME(\"application/manifest+json\", { name: \"javascript\", json: true })\nCodeMirror.defineMIME(\"application/ld+json\", { name: \"javascript\", jsonld: true });\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","export type Radians = number;\nexport type Degrees = number;\n\nexport function deg2rad(degrees: Degrees): Radians {\n  return degrees / 180 * Math.PI;\n}\nexport function rad2deg(radians: Radians): Degrees {\n  return radians * 180 / Math.PI;\n}\n\nexport class Vector2d {\n  readonly x: number;\n  readonly y: number;\n\n  static x(x: number): Vector2d {\n    return new Vector2d(x, 0);\n  }\n  static y(y: number): Vector2d {\n    return new Vector2d(0, y);\n  }\n  static polar(angle: Radians, modulo: number) {\n    return Vector2d.y(modulo).rotate(angle);\n  }\n\n  constructor(x: number = 0, y: number = 0) {\n    this.x = x;\n    this.y = y;\n  }\n\n  plus(that: Vector2d): Vector2d {\n    return new Vector2d(this.x + that.x, this.y + that.y);\n  }\n\n  minus(that: Vector2d): Vector2d {\n    return new Vector2d(this.x - that.x, this.y - that.y);\n  }\n\n  scale(k: number): Vector2d {\n    return new Vector2d(k * this.x, k * this.y);\n  }\n\n  rotate(th: Radians): Vector2d {\n    let x = this.x * Math.cos(th) - this.y * Math.sin(th);\n    let y = this.x * Math.sin(th) + this.y * Math.cos(th);\n    return new Vector2d(x, y);\n  }\n\n  segmentTo(point: Vector2d): Segment {\n    return new Segment(this, point);\n  }\n  segmentBy(translation: Vector2d): Segment {\n    return new Segment(this, this.plus(translation));\n  }\n\n  toString(): string {\n    return `(${this.x},${this.y})`;\n  }\n};\nexport namespace Vector2d {\n  export const ORIGIN = new Vector2d;\n}\n\nexport type Coords = [number, number];\n\nexport function coords2Vector2d(coords: Coords) {\n  return new Vector2d(coords[0], coords[1]);\n}\n\nexport class Segment {\n  private from: Vector2d;\n  private to: Vector2d;\n\n  constructor(from: Vector2d | Coords, to: Vector2d | Coords) {\n    this.from = (from instanceof Vector2d) ? from : coords2Vector2d(from);\n    this.to = (to instanceof Vector2d) ? to : coords2Vector2d(to);\n  }\n\n  private _length: number;\n  get length(): number {\n    if (typeof this._length === \"undefined\") {\n      let delta = this.to.minus(this.from);\n      this._length = Math.sqrt(delta.x * delta.x + delta.y * delta.y);\n    }\n    return this._length;\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    ctx.beginPath();\n    ctx.moveTo(this.from.x, this.from.y);\n    ctx.lineTo(this.to.x, this.to.y);\n    ctx.stroke();\n  }\n\n  lerp(ratio: number): Segment {\n    if (ratio < 0 || ratio > 1) {\n      throw new Error(\"Cannot generate line with ratio=\" + ratio);\n    }\n\n    let delta = this.to.minus(this.from).scale(ratio);\n    return new Segment(this.from, this.from.plus(delta));\n  }\n\n  scaled(k: number): Segment {\n    return new Segment(this.from.scale(k), this.to.scale(k));\n  }\n\n  toString(): string {\n    return `${this.from}->${this.to}`;\n  }\n}\n\ntype FromTo = [Coords, Coords];\n\nfunction fromTo2Segment(fromTo: FromTo) {\n  return new Segment(fromTo[0], fromTo[1]);\n}\n\nexport class Path {\n  private fragments: Segment[];\n  constructor(fragments: Array<Segment | FromTo> = []) {\n    this.fragments = fragments.map(fragment =>\n      (fragment instanceof Segment) ? fragment : fromTo2Segment(fragment));\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    ctx.save();\n    this.fragments.forEach(segment => segment.draw(ctx));\n    ctx.restore();\n  }\n\n  push(next: Segment): Path {\n    return new Path(this.fragments.concat(next));\n  }\n\n  get totalLength(): number {\n    let totalLength = 0;\n    for (let i = 0; i < this.fragments.length; i++) {\n      let fragment = this.fragments[i];\n      totalLength += fragment.length;\n    }\n\n    return totalLength;\n  }\n\n  scaled(k: number) {\n    return new Path(this.fragments.map(segment => segment.scaled(k)));\n  }\n\n  toString(): string {\n    return this.fragments.join(\", \");\n  }\n}\n","import { Vector2d, Degrees, Radians, deg2rad } from \"./geometry\";\nimport { Stroke } from \"./scene\";\n\ntype FrameMutations = {\n  position?: Vector2d;\n  facing?: Degrees;\n  height?: number;\n  opacity?: number;\n  newStrokes?: Stroke[];\n  foreground?: string;\n  background?: string;\n}\nexport class Frame {\n  static new() {\n    return new Frame;\n  }\n\n  private constructor(\n    readonly position: Vector2d = Vector2d.ORIGIN,\n    readonly facing: Degrees = 0,\n    readonly height: number = 0,\n    readonly opacity: number = 1,\n    readonly strokes: Stroke[] = [],\n    readonly foreground: string = \"\",\n    readonly background: string = \"\") { }\n\n  get facingRadians(): Radians {\n    return deg2rad(this.facing);\n  }\n\n  with(properties: FrameMutations): Frame {\n    return new Frame(\n      properties.position || this.position,\n      \"facing\" in properties ? properties.facing : this.facing,\n      \"height\" in properties ? properties.height : this.height,\n      \"opacity\" in properties ? properties.opacity : this.opacity,\n      \"newStrokes\" in properties ? this.strokes.concat(properties.newStrokes) : this.strokes,\n      \"foreground\" in properties ? properties.foreground : this.foreground,\n      \"background\" in properties ? properties.background : this.background);\n  }\n}\n\nexport class Animation {\n  keyFrame: Frame;\n  elapsed = 0;\n\n  constructor(\n    readonly duration: number,\n    readonly update: (delta: number, keyFrame: Frame) => Frame) { }\n\n  get currentFrame(): Frame {\n    return this.update(this.elapsed / this.duration, this.keyFrame);\n  }\n  get lastFrame(): Frame {\n    return this.update(1, this.keyFrame);\n  }\n\n  withKeyFrame(keyFrame: Frame): Animation {\n    this.keyFrame = keyFrame;\n    return this;\n  }\n}","export default {}","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JSInterpreter\"] = factory();\n\telse\n\t\troot[\"JSInterpreter\"] = factory();\n})(this, () => {\nreturn /******/ (() => { // webpackBootstrap\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ \"./original-repo/interpreter.js\":\n/*!**************************************!*\\\n  !*** ./original-repo/interpreter.js ***!\n  \\**************************************/\n/***/ (function(module, __unused_webpack_exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * @license\n * Copyright 2013 Neil Fraser\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Interpreting JavaScript in JavaScript.\n * @author interpreter@neil.fraser.name (Neil Fraser)\n */\n\n\n/**\n * Create a new interpreter.\n * @param {string|!Object} code Raw JavaScript text or AST.\n * @param {Function=} opt_initFunc Optional initialization function.  Used to\n *     define APIs.  When called it is passed the interpreter object and the\n *     global scope object.\n * @constructor\n */\nvar Interpreter = function(code, opt_initFunc) {\n  if (typeof code === 'string') {\n    code = this.parse_(code, 'code');\n  }\n  // Get a handle on Acorn's node_t object.\n  var nodeConstructor = code.constructor;\n  this.newNode = function() {\n    return new nodeConstructor({'options': {}});\n  };\n  // Clone the root 'Program' node so that the AST may be modified.\n  var ast = this.newNode();\n  for (var prop in code) {\n    ast[prop] = (prop === 'body') ? code[prop].slice() : code[prop];\n  }\n  this.ast = ast;\n  /**\n   * Sorted array of setTimeout/setInterval tasks waiting to execute.\n   * @type {!Array<!Interpreter.Task>}\n   */\n  this.tasks = [];\n  this.initFunc_ = opt_initFunc;\n  /**\n   * True if the interpreter is paused while waiting for an async function.\n   */\n  this.paused_ = false;\n  /**\n   * Lines of code to execute during startup of Interpreter.\n   * @type {!Array<string>|undefined}\n   */\n  this.polyfills_ = [];\n  // Unique identifier for native functions.  Used in serialization.\n  this.functionCounter_ = 0;\n  // Map node types to our step function names; a property lookup is faster\n  // than string concatenation with \"step\" prefix.\n  this.stepFunctions_ = Object.create(null);\n  var stepMatch = /^step([A-Z]\\w*)$/;\n  var m;\n  for (var methodName in this) {\n    if ((typeof this[methodName] === 'function') &&\n        (m = methodName.match(stepMatch))) {\n      this.stepFunctions_[m[1]] = this[methodName].bind(this);\n    }\n  }\n  // Create and initialize the global scope.\n  this.globalScope = this.createScope(this.ast, null);\n  this.globalObject = this.globalScope.object;\n  // Run the polyfills.\n  this.ast = this.parse_(this.polyfills_.join('\\n'), 'polyfills');\n  this.polyfills_ = undefined;  // Allow polyfill strings to garbage collect.\n  Interpreter.stripLocations_(this.ast, undefined, undefined);\n  var state = new Interpreter.State(this.ast, this.globalScope);\n  state.done = false;\n  this.stateStack = [state];\n  this.run();\n  this.value = undefined;\n  // Point at the main program.\n  this.ast = ast;\n  state = new Interpreter.State(this.ast, this.globalScope);\n  state.done = false;\n  this.stateStack.length = 0;\n  this.stateStack[0] = state;\n};\n\n/**\n * Completion Value Types.\n * @enum {number}\n */\nInterpreter.Completion = {\n  NORMAL: 0,\n  BREAK: 1,\n  CONTINUE: 2,\n  RETURN: 3,\n  THROW: 4,\n};\n\n/**\n * Interpreter status values.\n * @enum {number}\n */\nInterpreter.Status = {\n  'DONE': 0,\n  'STEP': 1,\n  'TASK': 2,\n  'ASYNC': 3,\n};\n\n/**\n * @const {!Object} Configuration used for all Acorn parsing.\n */\nInterpreter.PARSE_OPTIONS = {\n  locations: true,\n  ecmaVersion: 5,  // Needed in the event a version > 0.5.0 of Acorn is used.\n};\n\n/**\n * Property descriptor of readonly properties.\n */\nInterpreter.READONLY_DESCRIPTOR = {\n  'configurable': true,\n  'enumerable': true,\n  'writable': false,\n};\n\n/**\n * Property descriptor of non-enumerable properties.\n */\nInterpreter.NONENUMERABLE_DESCRIPTOR = {\n  'configurable': true,\n  'enumerable': false,\n  'writable': true,\n};\n\n/**\n * Property descriptor of readonly, non-enumerable properties.\n */\nInterpreter.READONLY_NONENUMERABLE_DESCRIPTOR = {\n  'configurable': true,\n  'enumerable': false,\n  'writable': false,\n};\n\n/**\n * Property descriptor of non-configurable, readonly, non-enumerable properties.\n * E.g. NaN, Infinity.\n */\nInterpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR = {\n  'configurable': false,\n  'enumerable': false,\n  'writable': false,\n};\n\n/**\n * Property descriptor of variables.\n */\nInterpreter.VARIABLE_DESCRIPTOR = {\n  'configurable': false,\n  'enumerable': true,\n  'writable': true,\n};\n\n/**\n * Unique symbol for indicating that a step has encountered an error, has\n * added it to the stack, and will be thrown within the user's program.\n * When STEP_ERROR is thrown in the JS-Interpreter, the error can be ignored.\n */\nInterpreter.STEP_ERROR = {'STEP_ERROR': true};\n\n/**\n * Unique symbol for indicating that a reference is a variable on the scope,\n * not an object property.\n */\nInterpreter.SCOPE_REFERENCE = {'SCOPE_REFERENCE': true};\n\n/**\n * Unique symbol for indicating, when used as the value of the value\n * parameter in calls to setProperty and friends, that the value\n * should be taken from the property descriptor instead.\n */\nInterpreter.VALUE_IN_DESCRIPTOR = /** @type {!Interpreter.Value} */({\n  'VALUE_IN_DESCRIPTOR': true\n});\n\n/**\n * Unique symbol for indicating that a RegExp timeout has occurred in a VM.\n */\nInterpreter.REGEXP_TIMEOUT = {'REGEXP_TIMEOUT': true};\n\n/**\n * For cycle detection in array to string and error conversion;\n * see spec bug github.com/tc39/ecma262/issues/289\n * Since this is for atomic actions only, it can be a class property.\n */\nInterpreter.toStringCycles_ = [];\n\n/**\n * Node's vm module, if loaded and required.\n * @type {Object}\n */\nInterpreter.vm = null;\n\n/**\n * Currently executing interpreter.  Needed so Interpreter.Object instances\n * can know their environment.\n * @type {Interpreter}\n */\nInterpreter.currentInterpreter_ = null;\n\n/**\n * The global object.  Ideally use `globalThis`.  Failing that try `this` or\n * `window`.  Other options to consider are `self` and `global`.\n * Same logic as in Acorn.\n */\nInterpreter.nativeGlobal =\n    (typeof globalThis === 'undefined') ? this || window : globalThis;\n\n/**\n * Code for executing regular expressions in a thread.\n */\nInterpreter.WORKER_CODE = [\n  \"onmessage = function(e) {\",\n    \"var result;\",\n    \"var data = e.data;\",\n    \"switch (data[0]) {\",\n      \"case 'split':\",\n        // ['split', string, separator, limit]\n        \"result = data[1].split(data[2], data[3]);\",\n        \"break;\",\n      \"case 'match':\",\n        // ['match', string, regexp]\n        \"result = data[1].match(data[2]);\",\n        \"break;\",\n      \"case 'search':\",\n        // ['search', string, regexp]\n        \"result = data[1].search(data[2]);\",\n        \"break;\",\n      \"case 'replace':\",\n        // ['replace', string, regexp, newSubstr]\n        \"result = data[1].replace(data[2], data[3]);\",\n        \"break;\",\n      \"case 'exec':\",\n        // ['exec', regexp, lastIndex, string]\n        \"var regexp = data[1];\",\n        \"regexp.lastIndex = data[2];\",\n        \"result = [regexp.exec(data[3]), data[1].lastIndex];\",\n        \"break;\",\n      \"default:\",\n        \"throw Error('Unknown RegExp operation: ' + data[0]);\",\n    \"}\",\n    \"postMessage(result);\",\n    \"close();\",\n  \"};\"];\n\n/**\n * Is a value a legal integer for an array length?\n * @param {Interpreter.Value} x Value to check.\n * @returns {number} Zero, or a positive integer if the value can be\n *     converted to such.  NaN otherwise.\n */\nInterpreter.legalArrayLength = function(x) {\n  var n = x >>> 0;\n  // Array length must be between 0 and 2^32-1 (inclusive).\n  return (n === Number(x)) ? n : NaN;\n};\n\n/**\n * Is a value a legal integer for an array index?\n * @param {Interpreter.Value} x Value to check.\n * @returns {number} Zero, or a positive integer if the value can be\n *     converted to such.  NaN otherwise.\n */\nInterpreter.legalArrayIndex = function(x) {\n  var n = x >>> 0;\n  // Array index cannot be 2^32-1, otherwise length would be 2^32.\n  // 0xffffffff is 2^32-1.\n  return (String(n) === String(x) && n !== 0xffffffff) ? n : NaN;\n};\n\n/**\n * Remove start and end values from AST, or set start and end values to a\n * constant value.  Used to remove highlighting from polyfills and to set\n * highlighting in an eval to cover the entire eval expression.\n * @param {!Object} node AST node.\n * @param {number=} start Starting character of all nodes, or undefined.\n * @param {number=} end Ending character of all nodes, or undefined.\n * @private\n */\nInterpreter.stripLocations_ = function(node, start, end) {\n  if (start) {\n    node.start = start;\n  } else {\n    delete node.start;\n  }\n  if (end) {\n    node.end = end;\n  } else {\n    delete node.end;\n  }\n  for (var name in node) {\n    if (name !== 'loc' && node.hasOwnProperty(name)) {\n      var prop = node[name];\n      if (prop && typeof prop === 'object') {\n        Interpreter.stripLocations_(/** @type {!Object} */(prop), start, end);\n      }\n    }\n  }\n};\n\n/**\n * Some pathological regular expressions can take geometric time.\n * Regular expressions are handled in one of three ways:\n * 0 - throw as invalid.\n * 1 - execute natively (risk of unresponsive program).\n * 2 - execute in separate thread (not supported by IE 9).\n */\nInterpreter.prototype['REGEXP_MODE'] = 2;\n\n/**\n * If REGEXP_MODE = 2, the length of time (in ms) to allow a RegExp\n * thread to execute before terminating it.\n */\nInterpreter.prototype['REGEXP_THREAD_TIMEOUT'] = 1000;\n\n/**\n * Length of time (in ms) to allow a polyfill to run before ending step.\n * If set to 0, polyfills will execute step by step.\n * If set to 1000, polyfills will run for up to a second per step\n * (execution will resume in the polyfill in the next step).\n * If set to Infinity, polyfills will run to completion in a single step.\n */\nInterpreter.prototype['POLYFILL_TIMEOUT'] = 1000;\n\n/**\n * Flag indicating that a getter function needs to be called immediately.\n * @private\n */\nInterpreter.prototype.getterStep_ = false;\n\n/**\n * Flag indicating that a setter function needs to be called immediately.\n * @private\n */\nInterpreter.prototype.setterStep_ = false;\n\n/**\n * Number of code chunks appended to the interpreter.\n * @private\n */\nInterpreter.prototype.appendCodeNumber_ = 0;\n\n/**\n * Number of parsed tasks.\n * @private\n */\nInterpreter.prototype.taskCodeNumber_ = 0;\n\n/**\n * Parse JavaScript code into an AST using Acorn.\n * @param {string} code Raw JavaScript text.\n * @param {string} sourceFile Name of filename (for stack trace).\n * @returns {!Object} AST.\n * @private\n */\nInterpreter.prototype.parse_ = function(code, sourceFile) {\n   // Create a new options object, since Acorn will modify this object.\n   // Inheritance can't be used since Acorn uses hasOwnProperty.\n   // Object.assign can't be used since that's ES6.\n   var options = {};\n   for (var name in Interpreter.PARSE_OPTIONS) {\n     options[name] = Interpreter.PARSE_OPTIONS[name];\n   }\n   options.sourceFile = sourceFile;\n   return Interpreter.nativeGlobal.acorn.parse(code, options);\n};\n\n/**\n * Add more code to the interpreter.\n * @param {string|!Object} code Raw JavaScript text or AST.\n */\nInterpreter.prototype.appendCode = function(code) {\n  var state = this.stateStack[0];\n  if (!state || state.node.type !== 'Program') {\n    throw Error('Expecting original AST to start with a Program node');\n  }\n  if (typeof code === 'string') {\n    code = this.parse_(code, 'appendCode' + (this.appendCodeNumber_++));\n  }\n  if (!code || code.type !== 'Program') {\n    throw Error('Expecting new AST to start with a Program node');\n  }\n  this.populateScope_(code, state.scope);\n  // Append the new program to the old one.\n  Array.prototype.push.apply(state.node.body, code.body);\n  state.node.body.variableCache_ = null;\n  state.done = false;\n};\n\n/**\n * Execute one step of the interpreter.\n * @returns {boolean} True if a step was executed, false if no more instructions.\n */\nInterpreter.prototype.step = function() {\n  var stack = this.stateStack;\n  var endTime;\n  do {\n    var state = stack[stack.length - 1];\n    if (this.paused_) {\n      // Blocked by an asynchronous function.\n      return true;\n    } else if (!state || (state.node.type === 'Program' && state.done)) {\n      if (!this.tasks.length) {\n        // Main program complete and no queued tasks.  We're done!\n        return false;\n      }\n      state = this.nextTask_();\n      if (!state) {\n        // Main program complete, queued tasks, but nothing to run right now.\n        return true;\n      }\n      // Found a queued task, execute it.\n    }\n    var node = state.node;\n    // Record the interpreter in a global property so calls to toString/valueOf\n    // can execute in the proper context.\n    var oldInterpreterValue = Interpreter.currentInterpreter_;\n    Interpreter.currentInterpreter_ = this;\n    try {\n      var nextState = this.stepFunctions_[node.type](stack, state, node);\n    } catch (e) {\n      // Eat any step errors.  They have been thrown on the stack.\n      if (e !== Interpreter.STEP_ERROR) {\n        // This is a real error, either in the JS-Interpreter, or an uncaught\n        // error in the interpreted code.  Rethrow.\n        if (this.value !== e) {\n          // Uh oh.  Internal error in the JS-Interpreter.\n          this.value = undefined;\n        }\n        throw e;\n      }\n    } finally {\n      // Restore to previous value (probably null, maybe nested toString calls).\n      Interpreter.currentInterpreter_ = oldInterpreterValue;\n    }\n    if (nextState) {\n      stack.push(nextState);\n    }\n    if (this.getterStep_) {\n      // Getter from this step was not handled.\n      this.value = undefined;\n      throw Error('Getter not supported in this context');\n    }\n    if (this.setterStep_) {\n      // Setter from this step was not handled.\n      this.value = undefined;\n      throw Error('Setter not supported in this context');\n    }\n    // This may be polyfill code.  Keep executing until we arrive at user code.\n    if (!endTime && !node.end) {\n      // Ideally this would be defined at the top of the function, but that\n      // wastes time if the step isn't a polyfill.\n      endTime = Date.now() + this['POLYFILL_TIMEOUT'];\n    }\n  } while (!node.end && endTime > Date.now());\n  return true;\n};\n\n/**\n * Execute the interpreter to program completion.  Vulnerable to infinite loops.\n * @returns {boolean} True if a execution is asynchronously blocked,\n *     false if no more instructions.\n */\nInterpreter.prototype.run = function() {\n  while (!this.paused_ && this.step()) {}\n  return this.paused_;\n};\n\n/**\n * Current status of the interpreter.\n * @returns {Interpreter.Status} One of DONE, STEP, TASK, or ASYNC.\n */\nInterpreter.prototype.getStatus = function() {\n  if (this.paused_) {\n    return Interpreter.Status['ASYNC'];\n  }\n  var stack = this.stateStack;\n  var state = stack[stack.length - 1];\n  if (state && (state.node.type !== 'Program' || !state.done)) {\n    // There's a step ready to execute.\n    return Interpreter.Status['STEP'];\n  }\n  var task = this.tasks[0];\n  if (task) {\n    if (task.time > Date.now()) {\n      // There's a pending task, but it's not ready.\n      return Interpreter.Status['TASK'];\n    }\n    // There's a task ready to execute.\n    return Interpreter.Status['STEP'];\n  }\n  return Interpreter.Status['DONE'];\n};\n\n/**\n * Initialize the global object with built-in properties and functions.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initGlobal = function(globalObject) {\n  // Initialize uneditable global properties.\n  this.setProperty(globalObject, 'NaN', NaN,\n      Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'Infinity', Infinity,\n      Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'undefined', undefined,\n      Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'window', globalObject,\n      Interpreter.READONLY_DESCRIPTOR);\n  this.setProperty(globalObject, 'this', globalObject,\n      Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'self', globalObject);  // Editable.\n\n  // Create the objects which will become Object.prototype and\n  // Function.prototype, which are needed to bootstrap everything else.\n  this.OBJECT_PROTO = new Interpreter.Object(null);\n  this.FUNCTION_PROTO = new Interpreter.Object(this.OBJECT_PROTO);\n  // Initialize global objects.\n  this.initFunction(globalObject);\n  this.initObject(globalObject);\n  // Unable to set globalObject's parent prior (OBJECT did not exist).\n  // Note that in a browser this would be `Window`, whereas in Node.js it would\n  // be `Object`.  This interpreter is closer to Node in that it has no DOM.\n  globalObject.proto = this.OBJECT_PROTO;\n  this.setProperty(globalObject, 'constructor', this.OBJECT,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.initArray(globalObject);\n  this.initString(globalObject);\n  this.initBoolean(globalObject);\n  this.initNumber(globalObject);\n  this.initDate(globalObject);\n  this.initRegExp(globalObject);\n  this.initError(globalObject);\n  this.initMath(globalObject);\n  this.initJSON(globalObject);\n\n  // Initialize global functions.\n  var thisInterpreter = this;\n  var wrapper;\n  var func = this.createNativeFunction(\n      function(_x) {throw EvalError(\"Can't happen\");}, false);\n  func.eval = true;\n  this.setProperty(globalObject, 'eval', func,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(globalObject, 'parseInt',\n      this.createNativeFunction(parseInt, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'parseFloat',\n      this.createNativeFunction(parseFloat, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(globalObject, 'isNaN',\n      this.createNativeFunction(isNaN, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(globalObject, 'isFinite',\n      this.createNativeFunction(isFinite, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  var strFunctions = [\n    [escape, 'escape'], [unescape, 'unescape'],\n    [decodeURI, 'decodeURI'], [decodeURIComponent, 'decodeURIComponent'],\n    [encodeURI, 'encodeURI'], [encodeURIComponent, 'encodeURIComponent']\n  ];\n  for (var i = 0; i < strFunctions.length; i++) {\n    wrapper = (function(nativeFunc) {\n      return function(str) {\n        try {\n          return nativeFunc(str);\n        } catch (e) {\n          // decodeURI('%xy') will throw an error.  Catch and rethrow.\n          thisInterpreter.throwException(thisInterpreter.URI_ERROR, e.message);\n        }\n      };\n    })(strFunctions[i][0]);\n    this.setProperty(globalObject, strFunctions[i][1],\n        this.createNativeFunction(wrapper, false),\n        Interpreter.NONENUMERABLE_DESCRIPTOR);\n  }\n\n  wrapper = function setTimeout(var_args) {\n    return thisInterpreter.createTask_(false, arguments);\n  };\n  this.setProperty(globalObject, 'setTimeout',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function setInterval(var_args) {\n    return thisInterpreter.createTask_(true, arguments);\n  };\n  this.setProperty(globalObject, 'setInterval',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function clearTimeout(pid) {\n    thisInterpreter.deleteTask_(pid);\n  };\n  this.setProperty(globalObject, 'clearTimeout',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function clearInterval(pid) {\n    thisInterpreter.deleteTask_(pid);\n  };\n  this.setProperty(globalObject, 'clearInterval',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Preserve public properties from being pruned/renamed by JS compilers.\n  // Add others as needed.\n  this['OBJECT'] = this.OBJECT;     this['OBJECT_PROTO'] = this.OBJECT_PROTO;\n  this['FUNCTION'] = this.FUNCTION; this['FUNCTION_PROTO'] = this.FUNCTION_PROTO;\n  this['ARRAY'] = this.ARRAY;       this['ARRAY_PROTO'] = this.ARRAY_PROTO;\n  this['REGEXP'] = this.REGEXP;     this['REGEXP_PROTO'] = this.REGEXP_PROTO;\n  this['DATE'] = this.DATE;         this['DATE_PROTO'] = this.DATE_PROTO;\n\n  // Run any user-provided initialization.\n  if (this.initFunc_) {\n    this.initFunc_(this, globalObject);\n  }\n};\n\n/**\n * Number of functions created by the interpreter.\n * @private\n */\nInterpreter.prototype.functionCodeNumber_ = 0;\n\n/**\n * Initialize the Function class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initFunction = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  var identifierRegexp = /^[A-Za-z_$][\\w$]*$/;\n  // Function constructor.\n  wrapper = function Function(var_args) {\n    if (arguments.length) {\n      var code = String(arguments[arguments.length - 1]);\n    } else {\n      var code = '';\n    }\n    var argsStr = Array.prototype.slice.call(arguments, 0, -1).join(',').trim();\n    if (argsStr) {\n      var args = argsStr.split(/\\s*,\\s*/);\n      for (var i = 0; i < args.length; i++) {\n        var name = args[i];\n        if (!identifierRegexp.test(name)) {\n          thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR,\n              'Invalid function argument: ' + name);\n        }\n      }\n      argsStr = args.join(', ');\n    }\n    // Acorn needs to parse code in the context of a function or else `return`\n    // statements will be syntax errors.\n    try {\n      var ast = thisInterpreter.parse_('(function(' + argsStr + ') {' + code + '})',\n          'function' + (thisInterpreter.functionCodeNumber_++));\n    } catch (e) {\n      // Acorn threw a SyntaxError.  Rethrow as a trappable error.\n      thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR,\n          'Invalid code: ' + e.message);\n    }\n    if (ast.body.length !== 1) {\n      // Function('a', 'return a + 6;}; {alert(1);');\n      thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR,\n          'Invalid code in function body');\n    }\n    var node = ast.body[0].expression;\n    // Note that if this constructor is called as `new Function()` the function\n    // object created by stepCallExpression and assigned to `this` is discarded.\n    // Interestingly, the scope for constructed functions is the global scope,\n    // even if they were constructed in some other scope.\n    return thisInterpreter.createFunction(node, thisInterpreter.globalScope,\n       'anonymous');\n  };\n  this.FUNCTION = this.createNativeFunction(wrapper, true);\n\n  this.setProperty(globalObject, 'Function', this.FUNCTION,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  // Throw away the created prototype and use the root prototype.\n  this.setProperty(this.FUNCTION, 'prototype', this.FUNCTION_PROTO,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Configure Function.prototype.\n  this.setProperty(this.FUNCTION_PROTO, 'constructor', this.FUNCTION,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.FUNCTION_PROTO.nativeFunc = function() {};\n  this.FUNCTION_PROTO.nativeFunc.id = this.functionCounter_++;\n  this.FUNCTION_PROTO.illegalConstructor = true;\n  this.setProperty(this.FUNCTION_PROTO, 'length', 0,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.FUNCTION_PROTO.class = 'Function';\n\n  wrapper = function apply_(func, thisArg, args) {\n    var state =\n        thisInterpreter.stateStack[thisInterpreter.stateStack.length - 1];\n    // Rewrite the current CallExpression state to apply a different function.\n    // Note: 'func' is provided by the polyfill as a non-standard argument.\n    state.func_ = func;\n    // Assign the `this` object.\n    state.funcThis_ = thisArg;\n    // Bind any provided arguments.\n    state.arguments_ = [];\n    if (args !== null && args !== undefined) {\n      if (args instanceof Interpreter.Object) {\n        // Convert the pseudo array of args into a native array.\n        // The pseudo array's properties object happens to be array-like.\n        state.arguments_ = Array.from(args.properties);\n      } else {\n        thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n            'CreateListFromArrayLike called on non-object');\n      }\n    }\n    state.doneExec_ = false;\n  };\n  this.setNativeFunctionPrototype(this.FUNCTION, 'apply', wrapper);\n\n  this.polyfills_.push(\n/* POLYFILL START */\n// Flatten the apply args list to remove any inheritance or getter functions.\n\"(function() {\",\n  \"var apply_ = Function.prototype.apply;\",\n  \"Function.prototype.apply = function apply(thisArg, args) {\",\n    \"var a2 = [];\",\n    \"for (var i = 0; i < args.length; i++) {\",\n      \"a2[i] = args[i];\",\n    \"}\",\n    \"return apply_(this, thisArg, a2);\",  // Note: Non-standard 'this' arg.\n  \"};\",\n\"})();\"\n/* POLYFILL END */\n);\n\n  wrapper = function call(thisArg /*, var_args */) {\n    var state =\n        thisInterpreter.stateStack[thisInterpreter.stateStack.length - 1];\n    // Rewrite the current CallExpression state to call a different function.\n    state.func_ = this;\n    // Assign the `this` object.\n    state.funcThis_ = thisArg;\n    // Bind any provided arguments.\n    state.arguments_ = [];\n    for (var i = 1; i < arguments.length; i++) {\n      state.arguments_.push(arguments[i]);\n    }\n    state.doneExec_ = false;\n  };\n  this.setNativeFunctionPrototype(this.FUNCTION, 'call', wrapper);\n\n  this.polyfills_.push(\n/* POLYFILL START */\n// Polyfill copied from:\n// developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_objects/Function/bind\n\"Object.defineProperty(Function.prototype, 'bind',\",\n    \"{configurable: true, writable: true, value:\",\n  \"function bind(oThis) {\",\n    \"if (typeof this !== 'function') {\",\n      \"throw TypeError('What is trying to be bound is not callable');\",\n    \"}\",\n    \"var aArgs   = Array.prototype.slice.call(arguments, 1),\",\n        \"fToBind = this,\",\n        \"fNOP    = function() {},\",\n        \"fBound  = function() {\",\n          \"return fToBind.apply(this instanceof fNOP\",\n                 \"? this\",\n                 \": oThis,\",\n                 \"aArgs.concat(Array.prototype.slice.call(arguments)));\",\n        \"};\",\n    \"if (this.prototype) {\",\n      \"fNOP.prototype = this.prototype;\",\n    \"}\",\n    \"fBound.prototype = new fNOP();\",\n    \"return fBound;\",\n  \"}\",\n\"});\",\n\"\"\n/* POLYFILL END */\n);\n\n  // Function has no parent to inherit from, so it needs its own mandatory\n  // toString and valueOf functions.\n  wrapper = function toString() {\n    return String(this);\n  };\n  this.setNativeFunctionPrototype(this.FUNCTION, 'toString', wrapper);\n  this.setProperty(this.FUNCTION, 'toString',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  wrapper = function valueOf() {\n    return this.valueOf();\n  };\n  this.setNativeFunctionPrototype(this.FUNCTION, 'valueOf', wrapper);\n  this.setProperty(this.FUNCTION, 'valueOf',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Initialize the Object class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initObject = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // Object constructor.\n  wrapper = function Object(value) {\n    if (value === undefined || value === null) {\n      // Create a new object.\n      if (thisInterpreter.calledWithNew()) {\n        // Called as `new Object()`.\n        return this;\n      } else {\n        // Called as `Object()`.\n        return thisInterpreter.createObjectProto(thisInterpreter.OBJECT_PROTO);\n      }\n    }\n    if (!(value instanceof Interpreter.Object)) {\n      // Wrap the value as an object.\n      var box = thisInterpreter.createObjectProto(\n          thisInterpreter.getPrototype(value));\n      box.data = value;\n      return box;\n    }\n    // Return the provided object.\n    return value;\n  };\n  this.OBJECT = this.createNativeFunction(wrapper, true);\n  // Throw away the created prototype and use the root prototype.\n  this.setProperty(this.OBJECT, 'prototype', this.OBJECT_PROTO,\n                   Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.OBJECT_PROTO, 'constructor', this.OBJECT,\n                   Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(globalObject, 'Object', this.OBJECT,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  /**\n   * Checks if the provided value is null or undefined.\n   * If so, then throw an error in the call stack.\n   * @param {Interpreter.Value} value Value to check.\n   */\n  var throwIfNullUndefined = function(value) {\n    if (value === undefined || value === null) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          \"Cannot convert '\" + value + \"' to object\");\n    }\n  };\n\n  // Static methods on Object.\n  wrapper = function getOwnPropertyNames(obj) {\n    throwIfNullUndefined(obj);\n    var props = (obj instanceof Interpreter.Object) ? obj.properties : obj;\n    return thisInterpreter.nativeToPseudo(Object.getOwnPropertyNames(props));\n  };\n  this.setProperty(this.OBJECT, 'getOwnPropertyNames',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function keys(obj) {\n    throwIfNullUndefined(obj);\n    if (obj instanceof Interpreter.Object) {\n      obj = obj.properties;\n    }\n    return thisInterpreter.nativeToPseudo(Object.keys(obj));\n  };\n  this.setProperty(this.OBJECT, 'keys',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function create_(proto) {\n    // Support for the second argument is the responsibility of a polyfill.\n    if (proto === null) {\n      return thisInterpreter.createObjectProto(null);\n    }\n    if (!(proto instanceof Interpreter.Object)) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          'Object prototype may only be an Object or null, not ' + proto);\n    }\n    return thisInterpreter.createObjectProto(proto);\n  };\n  this.setProperty(this.OBJECT, 'create',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Add a polyfill to handle create's second argument.\n  this.polyfills_.push(\n/* POLYFILL START */\n\"(function() {\",\n  \"var create_ = Object.create;\",\n  \"Object.create = function create(proto, props) {\",\n    \"var obj = create_(proto);\",\n    \"props && Object.defineProperties(obj, props);\",\n    \"return obj;\",\n  \"};\",\n\"})();\",\n\"\"\n/* POLYFILL END */\n);\n\n  wrapper = function defineProperty(obj, prop, descriptor) {\n    prop = String(prop);\n    if (!(obj instanceof Interpreter.Object)) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          'Object.defineProperty called on non-object: ' + obj);\n    }\n    if (!(descriptor instanceof Interpreter.Object)) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          'Property description must be an object');\n    }\n    if (obj.preventExtensions && !(prop in obj.properties)) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          \"Can't define property '\" + prop + \"', object is not extensible\");\n    }\n    // The polyfill guarantees no inheritance and no getter functions.\n    // Therefore the descriptor properties map is the native object needed.\n    thisInterpreter.setProperty(obj, prop, Interpreter.VALUE_IN_DESCRIPTOR,\n                                descriptor.properties);\n    return obj;\n  };\n  this.setProperty(this.OBJECT, 'defineProperty',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.polyfills_.push(\n// Flatten the descriptor to remove any inheritance or getter functions.\n/* POLYFILL START */\n\"(function() {\",\n  \"var defineProperty_ = Object.defineProperty;\",\n  \"Object.defineProperty = function defineProperty(obj, prop, d1) {\",\n    \"var d2 = {};\",\n    \"if ('configurable' in d1) d2.configurable = d1.configurable;\",\n    \"if ('enumerable' in d1) d2.enumerable = d1.enumerable;\",\n    \"if ('writable' in d1) d2.writable = d1.writable;\",\n    \"if ('value' in d1) d2.value = d1.value;\",\n    \"if ('get' in d1) d2.get = d1.get;\",\n    \"if ('set' in d1) d2.set = d1.set;\",\n    \"return defineProperty_(obj, prop, d2);\",\n  \"};\",\n\"})();\",\n\n\"Object.defineProperty(Object, 'defineProperties',\",\n    \"{configurable: true, writable: true, value:\",\n  \"function defineProperties(obj, props) {\",\n    \"var keys = Object.keys(props);\",\n    \"for (var i = 0; i < keys.length; i++) {\",\n      \"Object.defineProperty(obj, keys[i], props[keys[i]]);\",\n    \"}\",\n    \"return obj;\",\n  \"}\",\n\"});\",\n\"\"\n/* POLYFILL END */\n);\n\n  wrapper = function getOwnPropertyDescriptor(obj, prop) {\n    if (!(obj instanceof Interpreter.Object)) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          'Object.getOwnPropertyDescriptor called on non-object: ' + obj);\n    }\n    prop = String(prop);\n    if (!(prop in obj.properties)) {\n      return undefined;\n    }\n    var descriptor = Object.getOwnPropertyDescriptor(obj.properties, prop);\n    var getter = obj.getter[prop];\n    var setter = obj.setter[prop];\n\n    var pseudoDescriptor =\n        thisInterpreter.createObjectProto(thisInterpreter.OBJECT_PROTO);\n    if (getter || setter) {\n      thisInterpreter.setProperty(pseudoDescriptor, 'get', getter);\n      thisInterpreter.setProperty(pseudoDescriptor, 'set', setter);\n    } else {\n      thisInterpreter.setProperty(pseudoDescriptor, 'value',\n          /** @type {!Interpreter.Value} */(descriptor['value']));\n      thisInterpreter.setProperty(pseudoDescriptor, 'writable',\n          descriptor['writable']);\n    }\n    thisInterpreter.setProperty(pseudoDescriptor, 'configurable',\n        descriptor['configurable']);\n    thisInterpreter.setProperty(pseudoDescriptor, 'enumerable',\n        descriptor['enumerable']);\n    return pseudoDescriptor;\n  };\n  this.setProperty(this.OBJECT, 'getOwnPropertyDescriptor',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function getPrototypeOf(obj) {\n    throwIfNullUndefined(obj);\n    return thisInterpreter.getPrototype(obj);\n  };\n  this.setProperty(this.OBJECT, 'getPrototypeOf',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function isExtensible(obj) {\n    return Boolean(obj) && !obj.preventExtensions;\n  };\n  this.setProperty(this.OBJECT, 'isExtensible',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function preventExtensions(obj) {\n    if (obj instanceof Interpreter.Object) {\n      obj.preventExtensions = true;\n    }\n    return obj;\n  };\n  this.setProperty(this.OBJECT, 'preventExtensions',\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Instance methods on Object.\n  this.setNativeFunctionPrototype(this.OBJECT, 'toString',\n      Interpreter.Object.prototype.toString);\n  this.setNativeFunctionPrototype(this.OBJECT, 'toLocaleString',\n      Interpreter.Object.prototype.toString);\n  this.setNativeFunctionPrototype(this.OBJECT, 'valueOf',\n      Interpreter.Object.prototype.valueOf);\n\n  wrapper = function hasOwnProperty(prop) {\n    throwIfNullUndefined(this);\n    if (this instanceof Interpreter.Object) {\n      return String(prop) in this.properties;\n    }\n    // Primitive.\n    return this.hasOwnProperty(prop);\n  };\n  this.setNativeFunctionPrototype(this.OBJECT, 'hasOwnProperty', wrapper);\n\n  wrapper = function propertyIsEnumerable(prop) {\n    throwIfNullUndefined(this);\n    if (this instanceof Interpreter.Object) {\n      return Object.prototype.propertyIsEnumerable.call(this.properties, prop);\n    }\n    // Primitive.\n    return this.propertyIsEnumerable(prop);\n  };\n  this.setNativeFunctionPrototype(this.OBJECT, 'propertyIsEnumerable', wrapper);\n\n  wrapper = function isPrototypeOf(obj) {\n    while (true) {\n      // Note, circular loops shouldn't be possible.\n      obj = thisInterpreter.getPrototype(obj);\n      if (!obj) {\n        // No parent; reached the top.\n        return false;\n      }\n      if (obj === this) {\n        return true;\n      }\n    }\n  };\n  this.setNativeFunctionPrototype(this.OBJECT, 'isPrototypeOf',  wrapper);\n};\n\n/**\n * Initialize the Array class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initArray = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // Array constructor.\n  wrapper = function Array(var_args) {\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new Array()`.\n      var newArray = this;\n    } else {\n      // Called as `Array()`.\n      var newArray = thisInterpreter.createArray();\n    }\n    var first = arguments[0];\n    if (arguments.length === 1 && typeof first === 'number') {\n      if (isNaN(Interpreter.legalArrayLength(first))) {\n        thisInterpreter.throwException(thisInterpreter.RANGE_ERROR,\n                                       'Invalid array length: ' + first);\n      }\n      newArray.properties.length = first;\n    } else {\n      for (var i = 0; i < arguments.length; i++) {\n        newArray.properties[i] = arguments[i];\n      }\n      newArray.properties.length = i;\n    }\n    return newArray;\n  };\n  this.ARRAY = this.createNativeFunction(wrapper, true);\n  this.ARRAY_PROTO = this.ARRAY.properties['prototype'];\n  this.setProperty(globalObject, 'Array', this.ARRAY,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Static methods on Array.\n  wrapper = function isArray(obj) {\n    return obj && obj.class === 'Array';\n  };\n  this.setProperty(this.ARRAY, 'isArray',\n                   this.createNativeFunction(wrapper, false),\n                   Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Instance methods on Array.\n  this.setProperty(this.ARRAY_PROTO, 'length', 0,\n      {'configurable': false, 'enumerable': false, 'writable': true});\n  this.ARRAY_PROTO.class = 'Array';\n\n  this.polyfills_.push(\n/* POLYFILL START */\n\"(function() {\",\n  \"function createArrayMethod_(name, func) {\",\n    \"Object.defineProperty(func, 'name', {value: name});\",\n    \"Object.defineProperty(Array.prototype, name,\",\n        \"{configurable: true, writable: true, value: func});\",\n  \"}\",\n\n  \"createArrayMethod_('pop',\",\n    \"function() {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (!len || len < 0) {\",\n        \"o.length = 0;\",\n        \"return undefined;\",\n      \"}\",\n      \"len--;\",\n      \"var x = o[len];\",\n      \"delete o[len];\",  // Needed for non-arrays.\n      \"o.length = len;\",\n      \"return x;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('push',\",\n    \"function(var_args) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"for (var i = 0; i < arguments.length; i++) {\",\n        \"o[len] = arguments[i];\",\n        \"len++;\",\n      \"}\",\n      \"o.length = len;\",\n      \"return len;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('shift',\",\n    \"function() {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (!len || len < 0) {\",\n        \"o.length = 0;\",\n        \"return undefined;\",\n      \"}\",\n      \"var value = o[0];\",\n      \"for (var i = 0; i < len - 1; i++) {\",\n        \"if ((i + 1) in o) {\",\n          \"o[i] = o[i + 1];\",\n        \"} else {\",\n          \"delete o[i];\",\n        \"}\",\n      \"}\",\n      \"delete o[i];\",  // Needed for non-arrays.\n      \"o.length = len - 1;\",\n      \"return value;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('unshift',\",\n    \"function(var_args) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (!len || len < 0) {\",\n        \"len = 0;\",\n      \"}\",\n      \"for (var i = len - 1; i >= 0; i--) {\",\n        \"if (i in o) {\",\n          \"o[i + arguments.length] = o[i];\",\n        \"} else {\",\n          \"delete o[i + arguments.length];\",\n        \"}\",\n      \"}\",\n      \"for (var i = 0; i < arguments.length; i++) {\",\n        \"o[i] = arguments[i];\",\n      \"}\",\n      \"return (o.length = len + arguments.length);\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('reverse',\",\n    \"function() {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (!len || len < 2) {\",\n        \"return o;\",  // Not an array, or too short to reverse.\n      \"}\",\n      \"for (var i = 0; i < len / 2 - 0.5; i++) {\",\n        \"var x = o[i];\",\n        \"var hasX = i in o;\",\n        \"if ((len - i - 1) in o) {\",\n          \"o[i] = o[len - i - 1];\",\n        \"} else {\",\n          \"delete o[i];\",\n        \"}\",\n        \"if (hasX) {\",\n          \"o[len - i - 1] = x;\",\n        \"} else {\",\n          \"delete o[len - i - 1];\",\n        \"}\",\n      \"}\",\n      \"return o;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('indexOf',\",\n    \"function(searchElement, fromIndex) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var n = fromIndex | 0;\",\n      \"if (!len || n >= len) {\",\n        \"return -1;\",\n      \"}\",\n      \"var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\",\n      \"while (i < len) {\",\n        \"if (i in o && o[i] === searchElement) {\",\n          \"return i;\",\n        \"}\",\n        \"i++;\",\n      \"}\",\n      \"return -1;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('lastIndexOf',\",\n    \"function(searchElement, fromIndex) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (!len) {\",\n        \"return -1;\",\n      \"}\",\n      \"var n = len - 1;\",\n      \"if (arguments.length > 1) {\",\n        \"n = fromIndex | 0;\",\n        \"if (n) {\",\n          \"n = (n > 0 || -1) * Math.floor(Math.abs(n));\",\n        \"}\",\n      \"}\",\n      \"var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);\",\n      \"while (i >= 0) {\",\n        \"if (i in o && o[i] === searchElement) {\",\n          \"return i;\",\n        \"}\",\n        \"i--;\",\n      \"}\",\n      \"return -1;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('slice',\",\n    \"function(start, end) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      // Handle negative value for \"start\"\n      \"start |= 0;\",\n      \"start = (start >= 0) ? start : Math.max(0, len + start);\",\n      // Handle negative value for \"end\"\n      \"if (typeof end !== 'undefined') {\",\n        \"if (end !== Infinity) {\",\n          \"end |= 0;\",\n        \"}\",\n        \"if (end < 0) {\",\n          \"end = len + end;\",\n        \"} else {\",\n          \"end = Math.min(end, len);\",\n        \"}\",\n      \"} else {\",\n        \"end = len;\",\n      \"}\",\n      \"var size = end - start;\",\n      \"var cloned = new Array(size);\",\n      \"for (var i = 0; i < size; i++) {\",\n        \"if ((start + i) in o) {\",\n          \"cloned[i] = o[start + i];\",\n        \"}\",\n      \"}\",\n      \"return cloned;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('splice',\",\n    \"function(start, deleteCount, var_args) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"start |= 0;\",\n      \"if (start < 0) {\",\n        \"start = Math.max(len + start, 0);\",\n      \"} else {\",\n        \"start = Math.min(start, len);\",\n      \"}\",\n      \"if (arguments.length < 2) {\",\n        \"deleteCount = len - start;\",\n      \"} else {\",\n        \"deleteCount |= 0;\",\n        \"deleteCount = Math.max(0, Math.min(deleteCount, len - start));\",\n      \"}\",\n      \"var removed = [];\",\n      // Remove specified elements.\n      \"for (var i = start; i < start + deleteCount; i++) {\",\n        \"if (i in o) {\",\n          \"removed.push(o[i]);\",\n        \"} else {\",\n          \"removed.length++;\",\n        \"}\",\n        \"if ((i + deleteCount) in o) {\",\n          \"o[i] = o[i + deleteCount];\",\n        \"} else {\",\n          \"delete o[i];\",\n        \"}\",\n      \"}\",\n      // Move other element to fill the gap.\n      \"for (var i = start + deleteCount; i < len - deleteCount; i++) {\",\n        \"if ((i + deleteCount) in o) {\",\n          \"o[i] = o[i + deleteCount];\",\n        \"} else {\",\n          \"delete o[i];\",\n        \"}\",\n      \"}\",\n      // Delete superfluous properties.\n      \"for (var i = len - deleteCount; i < len; i++) {\",\n        \"delete o[i];\",\n      \"}\",\n      \"len -= deleteCount;\",\n      // Insert specified items.\n      \"if (arguments.length > 2) {\",\n        \"var arl = arguments.length - 2;\",\n        \"for (var i = len - 1; i >= start; i--) {\",\n          \"if (i in o) {\",\n            \"o[i + arl] = o[i];\",\n          \"} else {\",\n            \"delete o[i + arl];\",\n          \"}\",\n        \"}\",\n        \"len += arl;\",\n        \"for (var i = 2; i < arguments.length; i++) {\",\n          \"o[start + i - 2] = arguments[i];\",\n        \"}\",\n      \"}\",\n      \"o.length = len;\",\n      \"return removed;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('concat',\",\n    \"function(var_args) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this);\",\n      \"var cloned = [];\",\n      \"for (var i = -1; i < arguments.length; i++) {\",\n        \"var value = (i === -1) ? o : arguments[i];\",\n        \"if (Array.isArray(value)) {\",\n          \"for (var j = 0, l = value.length; j < l; j++) {\",\n            \"if (j in value) {\",\n              \"cloned.push(value[j]);\",\n            \"} else {\",\n              \"cloned.length++;\",\n            \"}\",\n          \"}\",\n        \"} else {\",\n          \"cloned.push(value);\",\n        \"}\",\n      \"}\",\n      \"return cloned;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('join',\",\n    \"function(opt_separator) {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var sep = typeof opt_separator === 'undefined' ?\",\n          \"',' : ('' + opt_separator);\",\n      \"var str = '';\",\n      \"for (var i = 0; i < len; i++) {\",\n        \"if (i && sep) str += sep;\",\n        \"str += (o[i] === null || o[i] === undefined) ? '' : o[i];\",\n      \"}\",\n      \"return str;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/every\n  \"createArrayMethod_('every',\",\n    \"function(callback, thisArg) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var t, k = 0;\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (arguments.length > 1) t = thisArg;\",\n      \"while (k < len) {\",\n        \"if (k in o && !callback.call(t, o[k], k, o)) return false;\",\n        \"k++;\",\n      \"}\",\n      \"return true;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\n  \"createArrayMethod_('filter',\",\n    \"function(callback, var_args) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var res = [];\",\n      \"var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\",\n      \"for (var i = 0; i < len; i++) {\",\n        \"if (i in o) {\",\n          \"var val = o[i];\",\n          \"if (callback.call(thisArg, val, i, o)) res.push(val);\",\n        \"}\",\n      \"}\",\n      \"return res;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\n  \"createArrayMethod_('forEach',\",\n    \"function(callback, thisArg) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var t, k = 0;\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (arguments.length > 1) t = thisArg;\",\n      \"while (k < len) {\",\n        \"if (k in o) callback.call(t, o[k], k, o);\",\n        \"k++;\",\n      \"}\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/map\n  \"createArrayMethod_('map',\",\n    \"function(callback, thisArg) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var t, k = 0;\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"if (arguments.length > 1) t = thisArg;\",\n      \"var a = new Array(len);\",\n      \"while (k < len) {\",\n        \"if (k in o) a[k] = callback.call(t, o[k], k, o);\",\n        \"k++;\",\n      \"}\",\n      \"return a;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce\n  \"createArrayMethod_('reduce',\",\n    \"function(callback /*, initialValue*/) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var k = 0, value;\",\n      \"if (arguments.length === 2) {\",\n        \"value = arguments[1];\",\n      \"} else {\",\n        \"while (k < len && !(k in o)) k++;\",\n        \"if (k >= len) {\",\n          \"throw TypeError('Reduce of empty array with no initial value');\",\n        \"}\",\n        \"value = o[k++];\",\n      \"}\",\n      \"for (; k < len; k++) {\",\n        \"if (k in o) value = callback(value, o[k], k, o);\",\n      \"}\",\n      \"return value;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/ReduceRight\n  \"createArrayMethod_('reduceRight',\",\n    \"function(callback /*, initialValue*/) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var k = len - 1, value;\",\n      \"if (arguments.length >= 2) {\",\n        \"value = arguments[1];\",\n      \"} else {\",\n        \"while (k >= 0 && !(k in o)) k--;\",\n        \"if (k < 0) {\",\n          \"throw TypeError('Reduce of empty array with no initial value');\",\n        \"}\",\n        \"value = o[k--];\",\n      \"}\",\n      \"for (; k >= 0; k--) {\",\n        \"if (k in o) value = callback(value, o[k], k, o);\",\n      \"}\",\n      \"return value;\",\n    \"}\",\n  \");\",\n\n  // Polyfill copied from:\n  // developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/some\n  \"createArrayMethod_('some',\",\n    \"function(callback /*, thisArg*/) {\",\n      \"if (!this || typeof callback !== 'function') throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\",\n      \"for (var i = 0; i < len; i++) {\",\n        \"if (i in o && callback.call(thisArg, o[i], i, o)) return true;\",\n      \"}\",\n      \"return false;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('sort',\",\n    \"function(opt_comp) {\",  // Bubble sort!\n      \"if (!this) throw TypeError();\",\n      \"if (typeof opt_comp !== 'function') {\",\n        \"opt_comp = undefined;\",\n      \"}\",\n      \"for (var i = 0; i < this.length; i++) {\",\n        \"var changes = 0;\",\n        \"for (var j = 0; j < this.length - i - 1; j++) {\",\n          \"if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :\",\n              \"(String(this[j]) > String(this[j + 1]))) {\",\n            \"var swap = this[j];\",\n            \"var hasSwap = j in this;\",\n            \"if ((j + 1) in this) {\",\n              \"this[j] = this[j + 1];\",\n            \"} else {\",\n              \"delete this[j];\",\n            \"}\",\n            \"if (hasSwap) {\",\n              \"this[j + 1] = swap;\",\n            \"} else {\",\n              \"delete this[j + 1];\",\n            \"}\",\n            \"changes++;\",\n          \"}\",\n        \"}\",\n        \"if (!changes) break;\",\n      \"}\",\n      \"return this;\",\n    \"}\",\n  \");\",\n\n  \"createArrayMethod_('toLocaleString',\",\n    \"function() {\",\n      \"if (!this) throw TypeError();\",\n      \"var o = Object(this), len = o.length >>> 0;\",\n      \"var out = [];\",\n      \"for (var i = 0; i < len; i++) {\",\n        \"out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();\",\n      \"}\",\n      \"return out.join(',');\",\n    \"}\",\n  \");\",\n\"})();\",\n\"\"\n/* POLYFILL END */\n);\n};\n\n/**\n * Initialize the String class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initString = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // String constructor.\n  wrapper = function String(value) {\n    value = arguments.length ? Interpreter.nativeGlobal.String(value) : '';\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new String()`.\n      this.data = value;\n      return this;\n    } else {\n      // Called as `String()`.\n      return value;\n    }\n  };\n  this.STRING = this.createNativeFunction(wrapper, true);\n  this.setProperty(globalObject, 'String', this.STRING,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Static methods on String.\n  this.setProperty(this.STRING, 'fromCharCode',\n      this.createNativeFunction(String.fromCharCode, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Instance methods on String.\n  // Methods with exclusively primitive arguments.\n  var functions = ['charAt', 'charCodeAt', 'concat', 'indexOf', 'lastIndexOf',\n      'slice', 'substr', 'substring', 'toLocaleLowerCase', 'toLocaleUpperCase',\n      'toLowerCase', 'toUpperCase', 'trim'];\n  for (var i = 0; i < functions.length; i++) {\n    this.setNativeFunctionPrototype(this.STRING, functions[i],\n                                    String.prototype[functions[i]]);\n  }\n\n  wrapper = function localeCompare(compareString, locales, options) {\n    locales = thisInterpreter.pseudoToNative(locales);\n    options = thisInterpreter.pseudoToNative(options);\n    try {\n      return String(this).localeCompare(compareString,\n          /** @type {?} */(locales), /** @type {?} */(options));\n    } catch (e) {\n      thisInterpreter.throwException(thisInterpreter.ERROR,\n          'localeCompare: ' + e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.STRING, 'localeCompare', wrapper);\n\n  wrapper = function split(separator, limit, callback) {\n    var string = String(this);\n    limit = limit ? Number(limit) : undefined;\n    // Example of catastrophic split RegExp:\n    // 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaac'.split(/^(a+)+b/)\n    if (thisInterpreter.isa(separator, thisInterpreter.REGEXP)) {\n      separator = separator.data;\n      thisInterpreter.maybeThrowRegExp(separator, callback);\n      if (thisInterpreter['REGEXP_MODE'] === 2) {\n        if (Interpreter.vm) {\n          // Run split in vm.\n          var sandbox = {\n            'string': string,\n            'separator': separator,\n            'limit': limit,\n          };\n          var code = 'string.split(separator, limit)';\n          var jsList =\n              thisInterpreter.vmCall(code, sandbox, separator, callback);\n          if (jsList !== Interpreter.REGEXP_TIMEOUT) {\n            callback(thisInterpreter.nativeToPseudo(jsList));\n          }\n        } else {\n          // Run split in separate thread.\n          var splitWorker = thisInterpreter.createWorker();\n          var pid = thisInterpreter.regExpTimeout(separator, splitWorker,\n              callback);\n          splitWorker.onmessage = function(e) {\n            clearTimeout(pid);\n            callback(thisInterpreter.nativeToPseudo(e.data));\n          };\n          splitWorker.postMessage(['split', string, separator, limit]);\n        }\n        return;\n      }\n    }\n    // Run split natively.\n    var jsList = string.split(separator, limit);\n    callback(thisInterpreter.nativeToPseudo(jsList));\n  };\n  this.setAsyncFunctionPrototype(this.STRING, 'split', wrapper);\n\n  wrapper = function match(regexp, callback) {\n    var string = String(this);\n    regexp = thisInterpreter.isa(regexp, thisInterpreter.REGEXP) ?\n        regexp.data : new RegExp(regexp);\n    // Example of catastrophic match RegExp:\n    // 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaac'.match(/^(a+)+b/)\n    thisInterpreter.maybeThrowRegExp(regexp, callback);\n    if (thisInterpreter['REGEXP_MODE'] === 2) {\n      if (Interpreter.vm) {\n        // Run match in vm.\n        var sandbox = {\n          'string': string,\n          'regexp': regexp,\n        };\n        var code = 'string.match(regexp)';\n        var m = thisInterpreter.vmCall(code, sandbox, regexp, callback);\n        if (m !== Interpreter.REGEXP_TIMEOUT) {\n          callback(m && thisInterpreter.matchToPseudo_(m));\n        }\n      } else {\n        // Run match in separate thread.\n        var matchWorker = thisInterpreter.createWorker();\n        var pid = thisInterpreter.regExpTimeout(regexp, matchWorker, callback);\n        matchWorker.onmessage = function(e) {\n          clearTimeout(pid);\n          callback(e.data && thisInterpreter.matchToPseudo_(e.data));\n        };\n        matchWorker.postMessage(['match', string, regexp]);\n      }\n      return;\n    }\n    // Run match natively.\n    var m = string.match(regexp);\n    callback(m && thisInterpreter.matchToPseudo_(m));\n  };\n  this.setAsyncFunctionPrototype(this.STRING, 'match', wrapper);\n\n  wrapper = function search(regexp, callback) {\n    var string = String(this);\n    if (thisInterpreter.isa(regexp, thisInterpreter.REGEXP)) {\n      regexp = regexp.data;\n    } else {\n      regexp = new RegExp(regexp);\n    }\n    // Example of catastrophic search RegExp:\n    // 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaac'.search(/^(a+)+b/)\n    thisInterpreter.maybeThrowRegExp(regexp, callback);\n    if (thisInterpreter['REGEXP_MODE'] === 2) {\n      if (Interpreter.vm) {\n        // Run search in vm.\n        var sandbox = {\n          'string': string,\n          'regexp': regexp\n        };\n        var code = 'string.search(regexp)';\n        var n = thisInterpreter.vmCall(code, sandbox, regexp, callback);\n        if (n !== Interpreter.REGEXP_TIMEOUT) {\n          callback(n);\n        }\n      } else {\n        // Run search in separate thread.\n        var searchWorker = thisInterpreter.createWorker();\n        var pid = thisInterpreter.regExpTimeout(regexp, searchWorker, callback);\n        searchWorker.onmessage = function(e) {\n          clearTimeout(pid);\n          callback(e.data);\n        };\n        searchWorker.postMessage(['search', string, regexp]);\n      }\n      return;\n    }\n    // Run search natively.\n    callback(string.search(regexp));\n  };\n  this.setAsyncFunctionPrototype(this.STRING, 'search', wrapper);\n\n  wrapper = function replace_(substr, newSubstr, callback) {\n    // Support for function replacements is the responsibility of a polyfill.\n    var string = String(this);\n    newSubstr = String(newSubstr);\n    // Example of catastrophic replace RegExp:\n    // 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaac'.replace(/^(a+)+b/, '')\n    if (thisInterpreter.isa(substr, thisInterpreter.REGEXP)) {\n      substr = substr.data;\n      thisInterpreter.maybeThrowRegExp(substr, callback);\n      if (thisInterpreter['REGEXP_MODE'] === 2) {\n        if (Interpreter.vm) {\n          // Run replace in vm.\n          var sandbox = {\n            'string': string,\n            'substr': substr,\n            'newSubstr': newSubstr,\n          };\n          var code = 'string.replace(substr, newSubstr)';\n          var str = thisInterpreter.vmCall(code, sandbox, substr, callback);\n          if (str !== Interpreter.REGEXP_TIMEOUT) {\n            callback(str);\n          }\n        } else {\n          // Run replace in separate thread.\n          var replaceWorker = thisInterpreter.createWorker();\n          var pid = thisInterpreter.regExpTimeout(substr, replaceWorker,\n              callback);\n          replaceWorker.onmessage = function(e) {\n            clearTimeout(pid);\n            callback(e.data);\n          };\n          replaceWorker.postMessage(['replace', string, substr, newSubstr]);\n        }\n        return;\n      }\n    }\n    // Run replace natively.\n    callback(string.replace(substr, newSubstr));\n  };\n  this.setAsyncFunctionPrototype(this.STRING, 'replace', wrapper);\n  // Add a polyfill to handle replace's second argument being a function.\n  this.polyfills_.push(\n/* POLYFILL START */\n\"(function() {\",\n  \"var replace_ = String.prototype.replace;\",\n  \"String.prototype.replace = function replace(substr, newSubstr) {\",\n    \"if (typeof newSubstr !== 'function') {\",\n      // string.replace(string|regexp, string)\n      \"return replace_.call(this, substr, newSubstr);\",\n    \"}\",\n    \"var str = this;\",\n    \"if (substr instanceof RegExp) {\",\n      // string.replace(regexp, function)\n      \"var subs = [];\",\n      \"var m = substr.exec(str);\",\n      \"while (m) {\",\n        \"m.push(m.index, str);\",\n        \"var inject = newSubstr.apply(null, m);\",\n        \"subs.push([m.index, m[0].length, inject]);\",\n        \"m = substr.global ? substr.exec(str) : null;\",\n      \"}\",\n      \"for (var i = subs.length - 1; i >= 0; i--) {\",\n        \"str = str.substring(0, subs[i][0]) + subs[i][2] + \",\n            \"str.substring(subs[i][0] + subs[i][1]);\",\n      \"}\",\n    \"} else {\",\n      // string.replace(string, function)\n      \"var i = str.indexOf(substr);\",\n      \"if (i !== -1) {\",\n        \"var inject = newSubstr(str.substr(i, substr.length), i, str);\",\n        \"str = str.substring(0, i) + inject + \",\n            \"str.substring(i + substr.length);\",\n      \"}\",\n    \"}\",\n    \"return str;\",\n  \"};\",\n\"})();\",\n\"\"\n/* POLYFILL END */\n);\n};\n\n/**\n * Initialize the Boolean class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initBoolean = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // Boolean constructor.\n  wrapper = function Boolean(value) {\n    value = Interpreter.nativeGlobal.Boolean(value);\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new Boolean()`.\n      this.data = value;\n      return this;\n    } else {\n      // Called as `Boolean()`.\n      return value;\n    }\n  };\n  this.BOOLEAN = this.createNativeFunction(wrapper, true);\n  this.setProperty(globalObject, 'Boolean', this.BOOLEAN,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Initialize the Number class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initNumber = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // Number constructor.\n  wrapper = function Number(value) {\n    value = arguments.length ? Interpreter.nativeGlobal.Number(value) : 0;\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new Number()`.\n      this.data = value;\n      return this;\n    } else {\n      // Called as `Number()`.\n      return value;\n    }\n  };\n  this.NUMBER = this.createNativeFunction(wrapper, true);\n  this.setProperty(globalObject, 'Number', this.NUMBER,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  var numConsts = ['MAX_VALUE', 'MIN_VALUE', 'NaN', 'NEGATIVE_INFINITY',\n                   'POSITIVE_INFINITY'];\n  for (var i = 0; i < numConsts.length; i++) {\n    this.setProperty(this.NUMBER, numConsts[i], Number[numConsts[i]],\n        Interpreter.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);\n  }\n\n  // Instance methods on Number.\n  wrapper = function toExponential(fractionDigits) {\n    try {\n      return Number(this).toExponential(fractionDigits);\n    } catch (e) {\n      // Throws if fractionDigits isn't within 0-20.\n      thisInterpreter.throwException(thisInterpreter.ERROR, e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.NUMBER, 'toExponential', wrapper);\n\n  wrapper = function toFixed(digits) {\n    try {\n      return Number(this).toFixed(digits);\n    } catch (e) {\n      // Throws if digits isn't within 0-20.\n      thisInterpreter.throwException(thisInterpreter.ERROR, e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.NUMBER, 'toFixed', wrapper);\n\n  wrapper = function toPrecision(precision) {\n    try {\n      return Number(this).toPrecision(precision);\n    } catch (e) {\n      // Throws if precision isn't within range (depends on implementation).\n      thisInterpreter.throwException(thisInterpreter.ERROR, e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.NUMBER, 'toPrecision', wrapper);\n\n  wrapper = function toString(radix) {\n    try {\n      return Number(this).toString(radix);\n    } catch (e) {\n      // Throws if radix isn't within 2-36.\n      thisInterpreter.throwException(thisInterpreter.ERROR, e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.NUMBER, 'toString', wrapper);\n\n  wrapper = function toLocaleString(locales, options) {\n    locales = locales ? thisInterpreter.pseudoToNative(locales) : undefined;\n    options = options ? thisInterpreter.pseudoToNative(options) : undefined;\n    try {\n      return Number(this).toLocaleString(\n          /** @type {?} */(locales), /** @type {?} */(options));\n    } catch (e) {\n      thisInterpreter.throwException(thisInterpreter.ERROR,\n          'toLocaleString: ' + e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.NUMBER, 'toLocaleString', wrapper);\n};\n\n/**\n * Initialize the Date class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initDate = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // Date constructor.\n  wrapper = function Date(_value, var_args) {\n    if (!thisInterpreter.calledWithNew()) {\n      // Called as `Date()`.\n      // Calling Date() as a function returns a string, no arguments are heeded.\n      return Interpreter.nativeGlobal.Date();\n    }\n    // Called as `new Date(...)`.\n    var args = [null].concat(Array.from(arguments));\n    this.data = new (Function.prototype.bind.apply(\n        Interpreter.nativeGlobal.Date, args));\n    return this;\n  };\n  this.DATE = this.createNativeFunction(wrapper, true);\n  this.DATE_PROTO = this.DATE.properties['prototype'];\n  this.setProperty(globalObject, 'Date', this.DATE,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Static methods on Date.\n  this.setProperty(this.DATE, 'now', this.createNativeFunction(Date.now, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(this.DATE, 'parse',\n      this.createNativeFunction(Date.parse, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(this.DATE, 'UTC', this.createNativeFunction(Date.UTC, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  // Instance methods on Date.\n  var functions = ['getDate', 'getDay', 'getFullYear', 'getHours',\n      'getMilliseconds', 'getMinutes', 'getMonth', 'getSeconds', 'getTime',\n      'getTimezoneOffset', 'getUTCDate', 'getUTCDay', 'getUTCFullYear',\n      'getUTCHours', 'getUTCMilliseconds', 'getUTCMinutes', 'getUTCMonth',\n      'getUTCSeconds', 'getYear',\n      'setDate', 'setFullYear', 'setHours', 'setMilliseconds',\n      'setMinutes', 'setMonth', 'setSeconds', 'setTime', 'setUTCDate',\n      'setUTCFullYear', 'setUTCHours', 'setUTCMilliseconds', 'setUTCMinutes',\n      'setUTCMonth', 'setUTCSeconds', 'setYear',\n      'toDateString', 'toJSON', 'toGMTString', 'toLocaleDateString',\n      'toLocaleString', 'toLocaleTimeString', 'toTimeString', 'toUTCString'];\n  for (var i = 0; i < functions.length; i++) {\n    wrapper = (function(nativeFunc) {\n      return function(var_args) {\n        var date = this.data;\n        if (!(date instanceof Date)) {\n          thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n              nativeFunc + ' not called on a Date');\n        }\n        var args = [];\n        for (var i = 0; i < arguments.length; i++) {\n          args[i] = thisInterpreter.pseudoToNative(arguments[i]);\n        }\n        return date[nativeFunc].apply(date, args);\n      };\n    })(functions[i]);\n    this.setNativeFunctionPrototype(this.DATE, functions[i], wrapper);\n  }\n\n  // Unlike the previous instance methods, toISOString may throw.\n  wrapper = function toISOString() {\n    try {\n      return this.data.toISOString();\n    } catch (e) {\n      thisInterpreter.throwException(thisInterpreter.RANGE_ERROR,\n          'toISOString: ' + e.message);\n    }\n  };\n  this.setNativeFunctionPrototype(this.DATE, 'toISOString', wrapper);\n};\n\n/**\n * Initialize Regular Expression object.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initRegExp = function(globalObject) {\n  var thisInterpreter = this;\n  var wrapper;\n  // RegExp constructor.\n  wrapper = function RegExp(pattern, flags) {\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new RegExp()`.\n      var rgx = this;\n    } else {\n      // Called as `RegExp()`.\n      if (flags === undefined &&\n          thisInterpreter.isa(pattern, thisInterpreter.REGEXP)) {\n        // Regexp(/foo/) returns the same obj.\n        return pattern;\n      }\n      var rgx = thisInterpreter.createObjectProto(thisInterpreter.REGEXP_PROTO);\n    }\n    pattern = pattern === undefined ? '' : String(pattern);\n    flags = flags ? String(flags) : '';\n    if (!/^[gmi]*$/.test(flags)) {\n      // Don't allow ES6 flags 'y' and 's' to pass through.\n      thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR,\n          'Invalid regexp flag: ' + flags);\n    }\n    try {\n      var nativeRegExp = new Interpreter.nativeGlobal.RegExp(pattern, flags)\n    } catch (e) {\n      // Throws if flags are repeated.\n      thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR, e.message);\n    }\n    thisInterpreter.populateRegExp(rgx, nativeRegExp);\n    return rgx;\n  };\n  this.REGEXP = this.createNativeFunction(wrapper, true);\n  this.REGEXP_PROTO = this.REGEXP.properties['prototype'];\n  this.setProperty(globalObject, 'RegExp', this.REGEXP,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  this.setProperty(this.REGEXP.properties['prototype'], 'global', undefined,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.REGEXP.properties['prototype'], 'ignoreCase', undefined,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.REGEXP.properties['prototype'], 'multiline', undefined,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.REGEXP.properties['prototype'], 'source', '(?:)',\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n\n  // Use polyfill to avoid complexity of regexp threads.\n  this.polyfills_.push(\n/* POLYFILL START */\n\"Object.defineProperty(RegExp.prototype, 'test',\",\n    \"{configurable: true, writable: true, value:\",\n  \"function test(str) {\",\n    \"return !!this.exec(str);\",\n  \"}\",\n\"});\"\n/* POLYFILL END */\n);\n\n  wrapper = function exec(string, callback) {\n    var regexp = this.data;\n    string = String(string);\n    // Get lastIndex from wrapped regexp, since this is settable.\n    regexp.lastIndex = Number(thisInterpreter.getProperty(this, 'lastIndex'));\n    // Example of catastrophic exec RegExp:\n    // /^(a+)+b/.exec('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaac')\n    thisInterpreter.maybeThrowRegExp(regexp, callback);\n    if (thisInterpreter['REGEXP_MODE'] === 2) {\n      if (Interpreter.vm) {\n        // Run exec in vm.\n        var sandbox = {\n          'string': string,\n          'regexp': regexp,\n        };\n        var code = 'regexp.exec(string)';\n        var match = thisInterpreter.vmCall(code, sandbox, regexp, callback);\n        if (match !== Interpreter.REGEXP_TIMEOUT) {\n          thisInterpreter.setProperty(this, 'lastIndex', regexp.lastIndex);\n          callback(thisInterpreter.matchToPseudo_(match));\n        }\n      } else {\n        // Run exec in separate thread.\n        // Note that lastIndex is not preserved when a RegExp is passed to a\n        // Web Worker.  Thus it needs to be passed back and forth separately.\n        var execWorker = thisInterpreter.createWorker();\n        var pid = thisInterpreter.regExpTimeout(regexp, execWorker, callback);\n        var thisPseudoRegExp = this;\n        execWorker.onmessage = function(e) {\n          clearTimeout(pid);\n          // Return tuple: [result, lastIndex]\n          thisInterpreter.setProperty(thisPseudoRegExp, 'lastIndex', e.data[1]);\n          callback(thisInterpreter.matchToPseudo_(e.data[0]));\n        };\n        execWorker.postMessage(['exec', regexp, regexp.lastIndex, string]);\n      }\n      return;\n    }\n    // Run exec natively.\n    var match = regexp.exec(string);\n    thisInterpreter.setProperty(this, 'lastIndex', regexp.lastIndex);\n    callback(thisInterpreter.matchToPseudo_(match));\n  };\n  this.setAsyncFunctionPrototype(this.REGEXP, 'exec', wrapper);\n};\n\n/**\n * Regexp.prototype.exec and String.prototype.match both return an array\n * of matches.  This array has two extra properties, 'input' and 'index'.\n * Convert this native JavaScript data structure into an JS-Interpreter object.\n * @param {!Array} match The native JavaScript match array to be converted.\n * @returns {Interpreter.Value} The equivalent JS-Interpreter array or null.\n * @private\n */\nInterpreter.prototype.matchToPseudo_ = function(match) {\n  if (match) {\n    // ES9 adds a 'groups' property.  This isn't part of ES5.  Delete it.\n    // ES13 adds an 'indices' property though Acorn should forbid the\n    // regex 'd' flag that creates it.\n    // Future ES versions may add more properties.\n    // Delete all properties not compatible with ES5.\n    var props = /** @type {!Array<?>} */(Object.getOwnPropertyNames(match));\n    for (var i = 0; i < props.length; i++) {\n      var prop = props[i];\n      if (isNaN(Number(prop)) && prop !== 'length' &&\n          prop !== 'input' && prop !== 'index') {\n        delete match[prop];\n      }\n    }\n    // Convert from a native data structure to JS-Iterpreter objects.\n    return this.nativeToPseudo(match);\n  }\n  return null;\n};\n\n/**\n * Initialize the Error class.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initError = function(globalObject) {\n  var thisInterpreter = this;\n  // Error constructor.\n  this.ERROR = this.createNativeFunction(function Error(opt_message) {\n    if (thisInterpreter.calledWithNew()) {\n      // Called as `new Error()`.\n      var newError = this;\n    } else {\n      // Called as `Error()`.\n      var newError = thisInterpreter.createObject(thisInterpreter.ERROR);\n    }\n    thisInterpreter.populateError(newError, opt_message);\n    return newError;\n  }, true);\n  this.setProperty(globalObject, 'Error', this.ERROR,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.ERROR.properties['prototype'], 'message', '',\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(this.ERROR.properties['prototype'], 'name', 'Error',\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  var createErrorSubclass = function(name) {\n    var constructor = thisInterpreter.createNativeFunction(\n        function(opt_message) {\n          if (thisInterpreter.calledWithNew()) {\n            // Called as `new XyzError()`.\n            var newError = this;\n          } else {\n            // Called as `XyzError()`.\n            var newError = thisInterpreter.createObject(constructor);\n          }\n          thisInterpreter.populateError(newError, opt_message);\n          return newError;\n        }, true);\n    thisInterpreter.setProperty(constructor, 'prototype',\n        thisInterpreter.createObject(thisInterpreter.ERROR),\n        Interpreter.NONENUMERABLE_DESCRIPTOR);\n    thisInterpreter.setProperty(constructor.properties['prototype'], 'name',\n        name, Interpreter.NONENUMERABLE_DESCRIPTOR);\n    thisInterpreter.setProperty(globalObject, name, constructor,\n        Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n    return constructor;\n  };\n\n  this.EVAL_ERROR = createErrorSubclass('EvalError');\n  this.RANGE_ERROR = createErrorSubclass('RangeError');\n  this.REFERENCE_ERROR = createErrorSubclass('ReferenceError');\n  this.SYNTAX_ERROR = createErrorSubclass('SyntaxError');\n  this.TYPE_ERROR = createErrorSubclass('TypeError');\n  this.URI_ERROR = createErrorSubclass('URIError');\n};\n\n/**\n * Initialize Math object.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initMath = function(globalObject) {\n  var myMath = this.createObjectProto(this.OBJECT_PROTO);\n  this.setProperty(globalObject, 'Math', myMath,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  var mathConsts = ['E', 'LN2', 'LN10', 'LOG2E', 'LOG10E', 'PI',\n                    'SQRT1_2', 'SQRT2'];\n  for (var i = 0; i < mathConsts.length; i++) {\n    this.setProperty(myMath, mathConsts[i], Math[mathConsts[i]],\n        Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  }\n  var numFunctions = ['abs', 'acos', 'asin', 'atan', 'atan2', 'ceil', 'cos',\n                      'exp', 'floor', 'log', 'max', 'min', 'pow', 'random',\n                      'round', 'sin', 'sqrt', 'tan'];\n  for (var i = 0; i < numFunctions.length; i++) {\n    this.setProperty(myMath, numFunctions[i],\n        this.createNativeFunction(Math[numFunctions[i]], false),\n        Interpreter.NONENUMERABLE_DESCRIPTOR);\n  }\n};\n\n/**\n * Initialize JSON object.\n * @param {!Interpreter.Object} globalObject Global object.\n */\nInterpreter.prototype.initJSON = function(globalObject) {\n  var wrapper;\n  var thisInterpreter = this;\n  var myJSON = thisInterpreter.createObjectProto(this.OBJECT_PROTO);\n  this.setProperty(globalObject, 'JSON', myJSON,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n\n  wrapper = function parse(text) {\n    try {\n      var nativeObj = JSON.parse(String(text));\n    } catch (e) {\n      thisInterpreter.throwException(thisInterpreter.SYNTAX_ERROR, e.message);\n    }\n    return thisInterpreter.nativeToPseudo(nativeObj);\n  };\n  this.setProperty(myJSON, 'parse', this.createNativeFunction(wrapper, false));\n\n  wrapper = function stringify(value, replacer, space) {\n    if (replacer && replacer.class === 'Function') {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR,\n          'Function replacer on JSON.stringify not supported');\n    } else if (replacer && replacer.class === 'Array') {\n      replacer = thisInterpreter.pseudoToNative(replacer);\n      replacer = replacer.filter(function(word) {\n        // Spec says we should also support boxed primitives here.\n        return typeof word === 'string' || typeof word === 'number';\n      });\n    } else {\n      replacer = null;\n    }\n    // Spec says we should also support boxed primitives here.\n    if (typeof space !== 'string' && typeof space !== 'number') {\n      space = undefined;\n    }\n\n    var nativeObj = thisInterpreter.pseudoToNative(value);\n    try {\n      var str = JSON.stringify(nativeObj, replacer, space);\n    } catch (e) {\n      thisInterpreter.throwException(thisInterpreter.TYPE_ERROR, e.message);\n    }\n    return str;\n  };\n  this.setProperty(myJSON, 'stringify',\n      this.createNativeFunction(wrapper, false));\n};\n\n/**\n * Is an object of a certain class?\n * @param {Interpreter.Value} child Object to check.\n * @param {Interpreter.Object} constructor Constructor of object.\n * @returns {boolean} True if object is the class or inherits from it.\n *     False otherwise.\n */\nInterpreter.prototype.isa = function(child, constructor) {\n  if (child === null || child === undefined || !constructor) {\n    return false;\n  }\n  var proto = constructor.properties['prototype'];\n  if (child === proto) {\n    return true;\n  }\n  // The first step up the prototype chain is harder since the child might be\n  // a primitive value.  Subsequent steps can just follow the .proto property.\n  child = this.getPrototype(child);\n  while (child) {\n    if (child === proto) {\n      return true;\n    }\n    child = child.proto;\n  }\n  return false;\n};\n\n/**\n * Initialize a pseudo regular expression object based on a native regular\n * expression object.\n * @param {!Interpreter.Object} pseudoRegexp The existing object to set.\n * @param {!RegExp} nativeRegexp The native regular expression.\n */\nInterpreter.prototype.populateRegExp = function(pseudoRegexp, nativeRegexp) {\n  pseudoRegexp.data = new RegExp(nativeRegexp.source, nativeRegexp.flags);\n  // lastIndex is settable, all others are read-only attributes\n  this.setProperty(pseudoRegexp, 'lastIndex', nativeRegexp.lastIndex,\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(pseudoRegexp, 'source', nativeRegexp.source,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(pseudoRegexp, 'global', nativeRegexp.global,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(pseudoRegexp, 'ignoreCase', nativeRegexp.ignoreCase,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  this.setProperty(pseudoRegexp, 'multiline', nativeRegexp.multiline,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Initialize a pseudo error object.\n * @param {!Interpreter.Object} pseudoError The existing object to set.\n * @param {string=} opt_message Error's message.\n */\nInterpreter.prototype.populateError = function(pseudoError, opt_message) {\n  if (opt_message) {\n    this.setProperty(pseudoError, 'message', String(opt_message),\n        Interpreter.NONENUMERABLE_DESCRIPTOR);\n  }\n  var tracebackData = [];\n  for (var i = this.stateStack.length - 1; i >= 0; i--) {\n    var state = this.stateStack[i];\n    var node = state.node;\n    if (node.type === 'CallExpression') {\n      var func = state.func_;\n      if (func && tracebackData.length) {\n        tracebackData[tracebackData.length - 1].datumName =\n            this.getProperty(func, 'name');\n      }\n    }\n    if (node.loc &&\n        (!tracebackData.length || node.type === 'CallExpression')) {\n      tracebackData.push({datumLoc: node.loc});\n    }\n  }\n  var errorName = String(this.getProperty(pseudoError, 'name'));\n  var errorMessage = String(this.getProperty(pseudoError, 'message'));\n  var stackString = errorName + ': ' + errorMessage + '\\n';\n  for (var i = 0; i < tracebackData.length; i++) {\n    var loc = tracebackData[i].datumLoc;\n    var name = tracebackData[i].datumName;\n    var locString = loc.source + ':' +\n        loc.start.line + ':' + loc.start.column;\n    if (name) {\n      stackString += '  at ' + name + ' (' + locString + ')\\n';\n    } else {\n      stackString += '  at ' + locString + '\\n';\n    }\n  }\n  this.setProperty(pseudoError, 'stack', stackString.trim(),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Create a Web Worker to execute regular expressions.\n * Using a separate file fails in Chrome when run locally on a file:// URI.\n * Using a data encoded URI fails in IE and Edge.\n * Using a blob works in IE11 and all other browsers.\n * @returns {!Worker} Web Worker with regexp execution code loaded.\n */\nInterpreter.prototype.createWorker = function() {\n  var blob = this.createWorker.blob_;\n  if (!blob) {\n    blob = new Blob([Interpreter.WORKER_CODE.join('\\n')],\n        {type: 'application/javascript'});\n    // Cache the blob, so it doesn't need to be created next time.\n    this.createWorker.blob_ = blob;\n  }\n  return new Worker(URL.createObjectURL(blob));\n};\n\n/**\n * Execute regular expressions in a node vm.\n * @param {string} code Code to execute.\n * @param {!Object} sandbox Global variables for new vm.\n * @param {!RegExp} nativeRegExp Regular expression.\n * @param {!Function} callback Asynchronous callback function.\n */\nInterpreter.prototype.vmCall = function(code, sandbox, nativeRegExp, callback) {\n  var options = {'timeout': this['REGEXP_THREAD_TIMEOUT']};\n  try {\n    return Interpreter.vm['runInNewContext'](code, sandbox, options);\n  } catch (_e) {\n    callback(null);\n    this.throwException(this.ERROR, 'RegExp Timeout: ' + nativeRegExp);\n  }\n  return Interpreter.REGEXP_TIMEOUT;\n};\n\n/**\n * If REGEXP_MODE is 0, then throw an error.\n * Also throw if REGEXP_MODE is 2 and JS doesn't support Web Workers or vm.\n * @param {!RegExp} nativeRegExp Regular expression.\n * @param {!Function} callback Asynchronous callback function.\n */\nInterpreter.prototype.maybeThrowRegExp = function(nativeRegExp, callback) {\n  var ok;\n  if (this['REGEXP_MODE'] === 0) {\n    // Fail: No RegExp support.\n    ok = false;\n  } else if (this['REGEXP_MODE'] === 1) {\n    // Ok: Native RegExp support.\n    ok = true;\n  } else {\n    // Sandboxed RegExp handling.\n    if (Interpreter.vm) {\n      // Ok: Node's vm module already loaded.\n      ok = true;\n    } else if (typeof Worker === 'function' && typeof URL === 'function') {\n      // Ok: Web Workers available.\n      ok = true;\n    } else if (true) {\n      // Try to load Node's vm module.\n      try {\n        Interpreter.vm = __webpack_require__(/*! vm */ \"vm\");\n      } catch (_e) {}\n      ok = !!Interpreter.vm;\n    } else {}\n  }\n  if (!ok) {\n    callback(null);\n    this.throwException(this.ERROR, 'Regular expressions not supported: ' +\n        nativeRegExp);\n  }\n};\n\n/**\n * Set a timeout for regular expression threads.  Unless cancelled, this will\n * terminate the thread and throw an error.\n * @param {!RegExp} nativeRegExp Regular expression (used for error message).\n * @param {!Worker} worker Thread to terminate.\n * @param {!Function} callback Async callback function to continue execution.\n * @returns {number} PID of timeout.  Used to cancel if thread completes.\n */\nInterpreter.prototype.regExpTimeout = function(nativeRegExp, worker, callback) {\n  var thisInterpreter = this;\n  return setTimeout(function() {\n      worker.terminate();\n      callback(null);\n      try {\n        thisInterpreter.throwException(thisInterpreter.ERROR,\n            'RegExp Timeout: ' + nativeRegExp);\n      } catch (_e) {\n        // Eat the expected Interpreter.STEP_ERROR.\n      }\n  }, this['REGEXP_THREAD_TIMEOUT']);\n};\n\n/**\n * Create a new data object based on a constructor's prototype.\n * @param {Interpreter.Object} constructor Parent constructor function,\n *     or null if scope object.\n * @returns {!Interpreter.Object} New data object.\n */\nInterpreter.prototype.createObject = function(constructor) {\n  return this.createObjectProto(constructor &&\n                                constructor.properties['prototype']);\n};\n\n/**\n * Create a new data object based on a prototype.\n * @param {Interpreter.Object} proto Prototype object.\n * @returns {!Interpreter.Object} New data object.\n */\nInterpreter.prototype.createObjectProto = function(proto) {\n  if (typeof proto !== 'object') {\n    throw Error('Non object prototype');\n  }\n  var obj = new Interpreter.Object(proto);\n  if (this.isa(obj, this.ERROR)) {\n    // Record this object as being an error so that its toString function can\n    // process it correctly (toString has no access to the interpreter and could\n    // not otherwise determine that the object is an error).\n    obj.class = 'Error';\n  }\n  return obj;\n};\n\n/**\n * Create a new array.\n * @returns {!Interpreter.Object} New array.\n */\nInterpreter.prototype.createArray = function() {\n  var array = this.createObjectProto(this.ARRAY_PROTO);\n  // Arrays have length.\n  this.setProperty(array, 'length', 0,\n      {'configurable': false, 'enumerable': false, 'writable': true});\n  array.class = 'Array';\n  return array;\n};\n\n/**\n * Create a new function object (could become interpreted or native or async).\n * @param {number} argumentLength Number of arguments.\n * @param {boolean} isConstructor True if function can be used with 'new'.\n * @returns {!Interpreter.Object} New function.\n * @private\n */\nInterpreter.prototype.createFunctionBase_ = function(argumentLength,\n                                                     isConstructor) {\n  var func = this.createObjectProto(this.FUNCTION_PROTO);\n  if (isConstructor) {\n    var proto = this.createObjectProto(this.OBJECT_PROTO);\n    this.setProperty(func, 'prototype', proto,\n                     Interpreter.NONENUMERABLE_DESCRIPTOR);\n    this.setProperty(proto, 'constructor', func,\n                     Interpreter.NONENUMERABLE_DESCRIPTOR);\n  } else {\n    func.illegalConstructor = true;\n  }\n  this.setProperty(func, 'length', argumentLength,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  func.class = 'Function';\n  // When making changes to this function, check to see if those changes also\n  // need to be made to the creation of FUNCTION_PROTO in initFunction.\n  return func;\n};\n\n/**\n * Create a new interpreted function.\n * @param {!Object} node AST node defining the function.\n * @param {!Interpreter.Scope} scope Parent scope.\n * @param {string=} opt_name Optional name for function.\n * @returns {!Interpreter.Object} New function.\n */\nInterpreter.prototype.createFunction = function(node, scope, opt_name) {\n  var func = this.createFunctionBase_(node.params.length, true);\n  func.parentScope = scope;\n  func.node = node;\n  // Choose a name for this function.\n  // function foo() {}             -> 'foo'\n  // var bar = function() {};      -> 'bar'\n  // var bar = function foo() {};  -> 'foo'\n  // foo.bar = function() {};      -> ''\n  // var bar = new Function('');   -> 'anonymous'\n  var name = node.id ? String(node.id.name) : (opt_name || '');\n  this.setProperty(func, 'name', name,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  return func;\n};\n\n/**\n * Create a new native function.\n * @param {!Function} nativeFunc JavaScript function.\n * @param {boolean} isConstructor True if function can be used with 'new'.\n * @returns {!Interpreter.Object} New function.\n */\nInterpreter.prototype.createNativeFunction = function(nativeFunc,\n                                                      isConstructor) {\n  var func = this.createFunctionBase_(nativeFunc.length, isConstructor);\n  func.nativeFunc = nativeFunc;\n  nativeFunc.id = this.functionCounter_++;\n  this.setProperty(func, 'name', nativeFunc.name,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  return func;\n};\n\n/**\n * Create a new native asynchronous function.\n * @param {!Function} asyncFunc JavaScript function.\n * @returns {!Interpreter.Object} New function.\n */\nInterpreter.prototype.createAsyncFunction = function(asyncFunc) {\n  var func = this.createFunctionBase_(asyncFunc.length, true);\n  func.asyncFunc = asyncFunc;\n  asyncFunc.id = this.functionCounter_++;\n  this.setProperty(func, 'name', asyncFunc.name,\n      Interpreter.READONLY_NONENUMERABLE_DESCRIPTOR);\n  return func;\n};\n\n/**\n * Converts from a native JavaScript object or value to a JS-Interpreter object.\n * Can handle JSON-style values, regular expressions, dates and functions.\n * Does NOT handle cycles.\n * @param {*} nativeObj The native JavaScript object to be converted.\n * @param {Object=} opt_cycles Cycle detection object (used by recursive calls).\n * @returns {Interpreter.Value} The equivalent JS-Interpreter object.\n */\nInterpreter.prototype.nativeToPseudo = function(nativeObj, opt_cycles) {\n  if (nativeObj === null || nativeObj === undefined ||\n      nativeObj === true || nativeObj === false ||\n      typeof nativeObj === 'string' || typeof nativeObj === 'number') {\n    // Primitive value.\n    return nativeObj;\n  }\n  if (nativeObj instanceof Interpreter.Object) {\n    throw Error('Object is already pseudo');\n  }\n\n  // Look up if this object has already been converted.\n  var cycles = opt_cycles || {\n    pseudo: [],\n    native: [],\n  };\n  var index = cycles.native.indexOf(nativeObj);\n  if (index !== -1) {\n    return cycles.pseudo[index];\n  }\n  cycles.native.push(nativeObj);\n\n  if (nativeObj instanceof RegExp) {\n    var pseudoRegexp = this.createObjectProto(this.REGEXP_PROTO);\n    this.populateRegExp(pseudoRegexp, nativeObj);\n    cycles.pseudo.push(pseudoRegexp);\n    return pseudoRegexp;\n  }\n\n  if (nativeObj instanceof Date) {\n    var pseudoDate = this.createObjectProto(this.DATE_PROTO);\n    pseudoDate.data = new Date(nativeObj.valueOf());\n    cycles.pseudo.push(pseudoDate);\n    return pseudoDate;\n  }\n\n  if (typeof nativeObj === 'function') {\n    var thisInterpreter = this;\n    var wrapper = function() {\n      var args = Array.prototype.slice.call(arguments).map(function(i) {\n          return thisInterpreter.pseudoToNative(i);\n      });\n      var value = nativeObj.apply(thisInterpreter, args);\n      return thisInterpreter.nativeToPseudo(value);\n    };\n    var prototype = Object.getOwnPropertyDescriptor(nativeObj, 'prototype');\n    var pseudoFunction = this.createNativeFunction(wrapper, !!prototype);\n    cycles.pseudo.push(pseudoFunction);\n    return pseudoFunction;\n  }\n\n  var pseudoObj;\n  if (Array.isArray(nativeObj)) {  // Array.\n    pseudoObj = this.createArray();\n  } else {  // Object.\n    pseudoObj = this.createObjectProto(this.OBJECT_PROTO);\n  }\n  cycles.pseudo.push(pseudoObj);\n  for (var key in nativeObj) {\n    this.setProperty(pseudoObj, key,\n        this.nativeToPseudo(nativeObj[key], cycles));\n  }\n  return pseudoObj;\n};\n\n/**\n * Converts from a JS-Interpreter object to native JavaScript object.\n * Can handle JSON-style values, regular expressions, and dates.\n * Does handle cycles.\n * @param {Interpreter.Value} pseudoObj The JS-Interpreter object to be\n * converted.\n * @param {Object=} opt_cycles Cycle detection object (used by recursive calls).\n * @returns {*} The equivalent native JavaScript object or value.\n */\nInterpreter.prototype.pseudoToNative = function(pseudoObj, opt_cycles) {\n  if (pseudoObj === null || pseudoObj === undefined ||\n      pseudoObj === true || pseudoObj === false ||\n      typeof pseudoObj === 'string' || typeof pseudoObj === 'number') {\n    // Primitive value.\n    return pseudoObj;\n  }\n  if (!(pseudoObj instanceof Interpreter.Object)) {\n    throw Error('Object is not pseudo');\n  }\n\n  // Look up if this object has already been converted.\n  var cycles = opt_cycles || {\n    pseudo: [],\n    native: [],\n  };\n  var index = cycles.pseudo.indexOf(pseudoObj);\n  if (index !== -1) {\n    return cycles.native[index];\n  }\n  cycles.pseudo.push(pseudoObj);\n\n  if (this.isa(pseudoObj, this.REGEXP)) {  // Regular expression.\n    var nativeRegExp = new RegExp(pseudoObj.data.source, pseudoObj.data.flags);\n    nativeRegExp.lastIndex = pseudoObj.data.lastIndex;\n    cycles.native.push(nativeRegExp);\n    return nativeRegExp;\n  }\n\n  if (this.isa(pseudoObj, this.DATE)) {  // Date.\n    var nativeDate = new Date(pseudoObj.data.valueOf());\n    cycles.native.push(nativeDate);\n    return nativeDate;\n  }\n\n  // Functions are not supported for security reasons.  Probably not a great\n  // idea for the JS-Interpreter to be able to create native JS functions.\n  // Still, if that floats your boat, this is where you'd add it.  Good luck.\n\n  var nativeObj = this.isa(pseudoObj, this.ARRAY) ? [] : {};\n  cycles.native.push(nativeObj);\n  var val;\n  for (var key in pseudoObj.properties) {\n    val = this.pseudoToNative(pseudoObj.properties[key], cycles);\n    // Use defineProperty to avoid side effects if setting '__proto__'.\n    Object.defineProperty(nativeObj, key,\n        {'value': val, 'writable': true, 'enumerable': true,\n         'configurable': true});\n  }\n  return nativeObj;\n};\n\n/**\n * Look up the prototype for this value.\n * @param {Interpreter.Value} value Data object.\n * @returns {Interpreter.Object} Prototype object, null if none.\n */\nInterpreter.prototype.getPrototype = function(value) {\n  switch (typeof value) {\n    case 'number':\n      return this.NUMBER.properties['prototype'];\n    case 'boolean':\n      return this.BOOLEAN.properties['prototype'];\n    case 'string':\n      return this.STRING.properties['prototype'];\n  }\n  if (value) {\n    return value.proto;\n  }\n  return null;\n};\n\n/**\n * Fetch a property value from a data object.\n * @param {Interpreter.Value} obj Data object.\n * @param {Interpreter.Value} name Name of property.\n * @returns {Interpreter.Value} Property value (may be undefined).\n */\nInterpreter.prototype.getProperty = function(obj, name) {\n  if (this.getterStep_) {\n    throw Error('Getter not supported in that context');\n  }\n  name = String(name);\n  if (obj === undefined || obj === null) {\n    this.throwException(this.TYPE_ERROR,\n                        \"Cannot read property '\" + name + \"' of \" + obj);\n  }\n  if (typeof obj === 'object' && !(obj instanceof Interpreter.Object)) {\n    throw TypeError('Expecting native value or pseudo object');\n  }\n  if (name === 'length') {\n    // Special cases for magic length property.\n    if (this.isa(obj, this.STRING)) {\n      return String(obj).length;\n    }\n  } else if (name.charCodeAt(0) < 0x40) {\n    // Might have numbers in there?\n    // Special cases for string array indexing\n    if (this.isa(obj, this.STRING)) {\n      var n = Interpreter.legalArrayIndex(name);\n      if (!isNaN(n) && n < String(obj).length) {\n        return String(obj)[n];\n      }\n    }\n  }\n  do {\n    if (obj.properties && name in obj.properties) {\n      var getter = obj.getter[name];\n      if (getter) {\n        // Flag this function as being a getter and thus needing immediate\n        // execution (rather than being the value of the property).\n        this.getterStep_ = true;\n        return getter;\n      }\n      return obj.properties[name];\n    }\n  } while ((obj = this.getPrototype(obj)));\n  return undefined;\n};\n\n/**\n * Does the named property exist on a data object.\n * @param {Interpreter.Object} obj Data object.\n * @param {Interpreter.Value} name Name of property.\n * @returns {boolean} True if property exists.\n */\nInterpreter.prototype.hasProperty = function(obj, name) {\n  if (!(obj instanceof Interpreter.Object)) {\n    throw TypeError('Primitive data type has no properties');\n  }\n  name = String(name);\n  if (name === 'length' && this.isa(obj, this.STRING)) {\n    return true;\n  }\n  if (this.isa(obj, this.STRING)) {\n    var n = Interpreter.legalArrayIndex(name);\n    if (!isNaN(n) && n < String(obj).length) {\n      return true;\n    }\n  }\n  do {\n    if (obj.properties && name in obj.properties) {\n      return true;\n    }\n  } while ((obj = this.getPrototype(obj)));\n  return false;\n};\n\n/**\n * Set a property value on a data object.\n * @param {Interpreter.Value} obj Data object.\n * @param {Interpreter.Value} name Name of property.\n * @param {Interpreter.Value} value New property value.\n *     Use Interpreter.VALUE_IN_DESCRIPTOR if value is handled by\n *     descriptor instead.\n * @param {Object=} opt_descriptor Optional descriptor object.\n * @returns {!Interpreter.Object|undefined} Returns a setter function if one\n *     needs to be called, otherwise undefined.\n */\nInterpreter.prototype.setProperty = function(obj, name, value, opt_descriptor) {\n  if (this.setterStep_) {\n    // Getter from previous call to setProperty was not handled.\n    throw Error('Setter not supported in that context');\n  }\n  name = String(name);\n  if (obj === undefined || obj === null) {\n    this.throwException(this.TYPE_ERROR,\n                        \"Cannot set property '\" + name + \"' of \" + obj);\n  }\n  if (typeof obj === 'object' && !(obj instanceof Interpreter.Object)) {\n    throw TypeError('Expecting native value or pseudo object');\n  }\n  if (opt_descriptor && ('get' in opt_descriptor || 'set' in opt_descriptor) &&\n      ('value' in opt_descriptor || 'writable' in opt_descriptor)) {\n    this.throwException(this.TYPE_ERROR, 'Invalid property descriptor. ' +\n        'Cannot both specify accessors and a value or writable attribute');\n  }\n  var strict = !this.stateStack || this.getScope().strict;\n  if (!(obj instanceof Interpreter.Object)) {\n    if (strict) {\n      this.throwException(this.TYPE_ERROR, \"Can't create property '\" + name +\n                          \"' on '\" + obj + \"'\");\n    }\n    return;\n  }\n  if (this.isa(obj, this.STRING)) {\n    var n = Interpreter.legalArrayIndex(name);\n    if (name === 'length' || (!isNaN(n) && n < String(obj).length)) {\n      // Can't set length or letters on String objects.\n      if (strict) {\n        this.throwException(this.TYPE_ERROR, \"Cannot assign to read only \" +\n            \"property '\" + name + \"' of String '\" + obj.data + \"'\");\n      }\n      return;\n    }\n  }\n  if (obj.class === 'Array') {\n    // Arrays have a magic length variable that is bound to the elements.\n    var len = obj.properties.length;\n    var i;\n    if (name === 'length') {\n      // Delete elements if length is smaller.\n      if (opt_descriptor) {\n        if (!('value' in opt_descriptor)) {\n          return;\n        }\n        value = opt_descriptor['value'];\n      }\n      value = Interpreter.legalArrayLength(value);\n      if (isNaN(value)) {\n        this.throwException(this.RANGE_ERROR, 'Invalid array length');\n      }\n      if (value < len) {\n        for (i in obj.properties) {\n          i = Interpreter.legalArrayIndex(i);\n          if (!isNaN(i) && value <= i) {\n            delete obj.properties[i];\n          }\n        }\n      }\n    } else if (!isNaN(i = Interpreter.legalArrayIndex(name))) {\n      // Increase length if this index is larger.\n      obj.properties.length = Math.max(len, i + 1);\n    }\n  }\n  if (obj.preventExtensions && !(name in obj.properties)) {\n    if (strict) {\n      this.throwException(this.TYPE_ERROR, \"Can't add property '\" + name +\n                          \"', object is not extensible\");\n    }\n    return;\n  }\n  if (opt_descriptor) {\n    // Define the property.\n    var descriptor = {};\n    if ('get' in opt_descriptor && opt_descriptor['get']) {\n      obj.getter[name] = opt_descriptor['get'];\n      descriptor['get'] = this.setProperty.placeholderGet_;\n    }\n    if ('set' in opt_descriptor && opt_descriptor['set']) {\n      obj.setter[name] = opt_descriptor['set'];\n      descriptor['set'] = this.setProperty.placeholderSet_;\n    }\n    if ('configurable' in opt_descriptor) {\n      descriptor['configurable'] = opt_descriptor['configurable'];\n    }\n    if ('enumerable' in opt_descriptor) {\n      descriptor['enumerable'] = opt_descriptor['enumerable'];\n    }\n    if ('writable' in opt_descriptor) {\n      descriptor['writable'] = opt_descriptor['writable'];\n      delete obj.getter[name];\n      delete obj.setter[name];\n    }\n    if ('value' in opt_descriptor) {\n      descriptor['value'] = opt_descriptor['value'];\n      delete obj.getter[name];\n      delete obj.setter[name];\n    } else if (value !== Interpreter.VALUE_IN_DESCRIPTOR) {\n      descriptor['value'] = value;\n      delete obj.getter[name];\n      delete obj.setter[name];\n    }\n    try {\n      Object.defineProperty(obj.properties, name, descriptor);\n    } catch (e) {\n      this.throwException(this.TYPE_ERROR, 'Cannot redefine property: ' + name);\n    }\n    // Now that the definition has suceeded, clean up any obsolete get/set funcs.\n    if ('get' in opt_descriptor && !opt_descriptor['get']) {\n      delete obj.getter[name];\n    }\n    if ('set' in opt_descriptor && !opt_descriptor['set']) {\n      delete obj.setter[name];\n    }\n  } else {\n    // Set the property.\n    if (value === Interpreter.VALUE_IN_DESCRIPTOR) {\n      throw ReferenceError('Value not specified');\n    }\n    // Determine the parent (possibly self) where the property is defined.\n    var defObj = obj;\n    while (!(name in defObj.properties)) {\n      defObj = this.getPrototype(defObj);\n      if (!defObj) {\n        // This is a new property.\n        defObj = obj;\n        break;\n      }\n    }\n    if (defObj.setter && defObj.setter[name]) {\n      this.setterStep_ = true;\n      return defObj.setter[name];\n    }\n    if (defObj.getter && defObj.getter[name]) {\n      if (strict) {\n        this.throwException(this.TYPE_ERROR, \"Cannot set property '\" + name +\n            \"' of object '\" + obj + \"' which only has a getter\");\n      }\n    } else {\n      // No setter, simple assignment.\n      try {\n        obj.properties[name] = value;\n      } catch (_e) {\n        if (strict) {\n          this.throwException(this.TYPE_ERROR, \"Cannot assign to read only \" +\n              \"property '\" + name + \"' of object '\" + obj + \"'\");\n        }\n      }\n    }\n  }\n};\n\nInterpreter.prototype.setProperty.placeholderGet_ =\n    function() {throw Error('Placeholder getter');};\nInterpreter.prototype.setProperty.placeholderSet_ =\n    function() {throw Error('Placeholder setter');};\n\n/**\n * Convenience method for adding a native function as a non-enumerable property\n * onto an object's prototype.\n * @param {!Interpreter.Object} obj Data object.\n * @param {Interpreter.Value} name Name of property.\n * @param {!Function} wrapper Function object.\n */\nInterpreter.prototype.setNativeFunctionPrototype =\n    function(obj, name, wrapper) {\n  this.setProperty(obj.properties['prototype'], name,\n      this.createNativeFunction(wrapper, false),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Convenience method for adding an async function as a non-enumerable property\n * onto an object's prototype.\n * @param {!Interpreter.Object} obj Data object.\n * @param {Interpreter.Value} name Name of property.\n * @param {!Function} wrapper Function object.\n */\nInterpreter.prototype.setAsyncFunctionPrototype =\n    function(obj, name, wrapper) {\n  this.setProperty(obj.properties['prototype'], name,\n      this.createAsyncFunction(wrapper),\n      Interpreter.NONENUMERABLE_DESCRIPTOR);\n};\n\n/**\n * Returns the current scope from the stateStack.\n * @returns {!Interpreter.Scope} Current scope.\n */\nInterpreter.prototype.getScope = function() {\n  var scope = this.stateStack[this.stateStack.length - 1].scope;\n  if (!scope) {\n    throw Error('No scope found');\n  }\n  return scope;\n};\n\n/**\n * Create a new scope dictionary.\n * @param {!Object} node AST node defining the scope container\n *     (e.g. a function).\n * @param {Interpreter.Scope} parentScope Scope to link to.\n * @returns {!Interpreter.Scope} New scope.\n */\nInterpreter.prototype.createScope = function(node, parentScope) {\n  // Determine if this scope starts with `use strict`.\n  var strict = false;\n  if (parentScope && parentScope.strict) {\n    strict = true;\n  } else {\n    var firstNode = node.body && node.body[0];\n    if (firstNode && firstNode.expression &&\n        firstNode.expression.type === 'Literal' &&\n        firstNode.expression.value === 'use strict') {\n      strict = true;\n    }\n  }\n  var object = this.createObjectProto(null);\n  var scope = new Interpreter.Scope(parentScope, strict, object);\n  if (!parentScope) {\n    this.initGlobal(scope.object);\n  }\n  this.populateScope_(node, scope);\n  return scope;\n};\n\n/**\n * Create a new special scope dictionary. Similar to createScope(), but\n * doesn't assume that the scope is for a function body.\n * This is used for 'catch' clauses, 'with' statements,\n * and named function expressions.\n * @param {!Interpreter.Scope} parentScope Scope to link to.\n * @param {Interpreter.Object=} opt_object Optional object to transform into\n *     scope.\n * @returns {!Interpreter.Scope} New scope.\n */\nInterpreter.prototype.createSpecialScope = function(parentScope, opt_object) {\n  if (!parentScope) {\n    throw Error('parentScope required');\n  }\n  var object = opt_object || this.createObjectProto(null);\n  return new Interpreter.Scope(parentScope, parentScope.strict, object);\n};\n\n/**\n * Retrieves a value from the scope chain.\n * @param {string} name Name of variable.\n * @returns {Interpreter.Value} Any value.\n *   May be flagged as being a getter and thus needing immediate execution\n *   (rather than being the value of the property).\n */\nInterpreter.prototype.getValueFromScope = function(name) {\n  var scope = this.getScope();\n  while (scope && scope !== this.globalScope) {\n    if (name in scope.object.properties) {\n      return scope.object.properties[name];\n    }\n    scope = scope.parentScope;\n  }\n  // The root scope is also an object which has inherited properties and\n  // could also have getters.\n  if (scope === this.globalScope && this.hasProperty(scope.object, name)) {\n    return this.getProperty(scope.object, name);\n  }\n  // Typeof operator is unique: it can safely look at non-defined variables.\n  var prevNode = this.stateStack[this.stateStack.length - 1].node;\n  if (prevNode.type === 'UnaryExpression' &&\n      prevNode.operator === 'typeof') {\n    return undefined;\n  }\n  this.throwException(this.REFERENCE_ERROR, name + ' is not defined');\n};\n\n/**\n * Sets a value to the current scope.\n * @param {string} name Name of variable.\n * @param {Interpreter.Value} value Value.\n * @returns {!Interpreter.Object|undefined} Returns a setter function if one\n *     needs to be called, otherwise undefined.\n */\nInterpreter.prototype.setValueToScope = function(name, value) {\n  var scope = this.getScope();\n  var strict = scope.strict;\n  while (scope && scope !== this.globalScope) {\n    if (name in scope.object.properties) {\n      try {\n        scope.object.properties[name] = value;\n      } catch (_e) {\n        if (strict) {\n          this.throwException(this.TYPE_ERROR,\n              \"Cannot assign to read only variable '\" + name + \"'\");\n        }\n      }\n      return undefined;\n    }\n    scope = scope.parentScope;\n  }\n  // The root scope is also an object which has readonly properties and\n  // could also have setters.\n  if (scope === this.globalScope &&\n      (!strict || this.hasProperty(scope.object, name))) {\n    return this.setProperty(scope.object, name, value);\n  }\n  this.throwException(this.REFERENCE_ERROR, name + ' is not defined');\n};\n\n/**\n * Create a new scope for the given node and populate it with all variables\n * and named functions.\n * @param {!Object} node AST node (usually a program or function when initally\n *   calling this function, though it recurses to scan many child nodes).\n * @param {!Interpreter.Scope} scope Scope dictionary to populate.\n * @returns {!Object} Map of all variable and function names.\n * @private\n */\nInterpreter.prototype.populateScope_ = function(node, scope) {\n  var variableCache;\n  if (!node.variableCache_) {\n    variableCache = Object.create(null);\n    switch (node.type) {\n      case 'VariableDeclaration':\n        for (var i = 0; i < node.declarations.length; i++) {\n          variableCache[node.declarations[i].id.name] = true;\n        }\n        break;\n      case 'FunctionDeclaration':\n        variableCache[node.id.name] = node;\n        break;\n      case 'BlockStatement':\n      case 'CatchClause':\n      case 'DoWhileStatement':\n      case 'ForInStatement':\n      case 'ForStatement':\n      case 'IfStatement':\n      case 'LabeledStatement':\n      case 'Program':\n      case 'SwitchCase':\n      case 'SwitchStatement':\n      case 'TryStatement':\n      case 'WithStatement':\n      case 'WhileStatement':\n        // All the structures within which a variable or function could hide.\n        var nodeClass = node.constructor;\n        for (var name in node) {\n          if (name === 'loc') continue;\n          var prop = node[name];\n          if (prop && typeof prop === 'object') {\n            var childCache;\n            if (Array.isArray(prop)) {\n              for (var i = 0; i < prop.length; i++) {\n                if (prop[i] && prop[i].constructor === nodeClass) {\n                  childCache = this.populateScope_(prop[i], scope);\n                  for (var name in childCache) {\n                    variableCache[name] = childCache[name];\n                  }\n                }\n              }\n            } else {\n              if (prop.constructor === nodeClass) {\n                childCache = this.populateScope_(prop, scope);\n                for (var name in childCache) {\n                  variableCache[name] = childCache[name];\n                }\n              }\n            }\n          }\n        }\n    }\n    node.variableCache_ = variableCache;\n  } else {\n    variableCache = node.variableCache_;\n  }\n  for (var name in variableCache) {\n    if (variableCache[name] === true) {\n      this.setProperty(scope.object, name, undefined,\n          Interpreter.VARIABLE_DESCRIPTOR);\n    } else {\n      this.setProperty(scope.object, name,\n          this.createFunction(variableCache[name], scope),\n          Interpreter.VARIABLE_DESCRIPTOR);\n    }\n  }\n  return variableCache;\n};\n\n/**\n * Is the current state directly being called with as a construction with 'new'.\n * @returns {boolean} True if 'new foo()', false if 'foo()'.\n */\nInterpreter.prototype.calledWithNew = function() {\n  return this.stateStack[this.stateStack.length - 1].isConstructor;\n};\n\n/**\n * Gets a value from the scope chain or from an object property.\n * @param {!Array} ref Name of variable or object/propname tuple.\n * @returns {Interpreter.Value} Any value.\n *   May be flagged as being a getter and thus needing immediate execution\n *   (rather than being the value of the property).\n */\nInterpreter.prototype.getValue = function(ref) {\n  if (ref[0] === Interpreter.SCOPE_REFERENCE) {\n    // A null/varname variable lookup.\n    return this.getValueFromScope(ref[1]);\n  } else {\n    // An obj/prop components tuple (foo.bar).\n    return this.getProperty(ref[0], ref[1]);\n  }\n};\n\n/**\n * Sets a value to the scope chain or to an object property.\n * @param {!Array} ref Name of variable or object/propname tuple.\n * @param {Interpreter.Value} value Value.\n * @returns {!Interpreter.Object|undefined} Returns a setter function if one\n *     needs to be called, otherwise undefined.\n */\nInterpreter.prototype.setValue = function(ref, value) {\n  if (ref[0] === Interpreter.SCOPE_REFERENCE) {\n    // A null/varname variable lookup.\n    return this.setValueToScope(ref[1], value);\n  }\n  // An obj/prop components tuple (foo.bar).\n  return this.setProperty(ref[0], ref[1], value);\n};\n\n/**\n * Throw an exception in the interpreter that can be handled by an\n * interpreter try/catch statement.  If unhandled, a real exception will\n * be thrown.  Can be called with either an error class and a message, or\n * with an actual object to be thrown.\n * @param {!Interpreter.Object|Interpreter.Value} errorClass Type of error\n *   (if message is provided) or the value to throw (if no message).\n * @param {string=} opt_message Message being thrown.\n */\nInterpreter.prototype.throwException = function(errorClass, opt_message) {\n  if (!this.globalScope) {\n    // This is an error being thrown in the initialization, throw a real error.\n    throw (opt_message === undefined) ? errorClass : opt_message;\n  }\n  if (opt_message === undefined ||\n      !(errorClass instanceof Interpreter.Object)) {\n    var error = errorClass;  // This is a value to throw, not an error class.\n  } else {\n    var error = this.createObject(errorClass);\n    this.populateError(error, opt_message);\n  }\n  this.unwind(Interpreter.Completion.THROW, error, undefined);\n  // Abort anything related to the current step.\n  throw Interpreter.STEP_ERROR;\n};\n\n/**\n * Unwind the stack to the innermost relevant enclosing TryStatement,\n * For/ForIn/WhileStatement or Call/NewExpression.  If this results in\n * the stack being completely unwound the thread will be terminated\n * and the appropriate error being thrown.\n * @param {Interpreter.Completion} type Completion type.\n * @param {Interpreter.Value} value Value computed, returned or thrown.\n * @param {string|undefined} label Target label for break or return.\n */\nInterpreter.prototype.unwind = function(type, value, label) {\n  if (type === Interpreter.Completion.NORMAL) {\n    throw TypeError('Should not unwind for NORMAL completions');\n  }\n\n  loop: for (var stack = this.stateStack; stack.length > 0; stack.pop()) {\n    var state = stack[stack.length - 1];\n    switch (state.node.type) {\n      case 'TryStatement':\n        state.cv = {type: type, value: value, label: label};\n        return;\n      case 'CallExpression':\n      case 'NewExpression':\n        if (type === Interpreter.Completion.RETURN) {\n          state.value = value;\n          return;\n        } else if (type === Interpreter.Completion.BREAK ||\n            type === Interpreter.Completion.CONTINUE) {\n          throw Error('Unsyntactic break/continue not rejected by Acorn');\n        }\n        break;\n      case 'Program':\n        if (type === Interpreter.Completion.RETURN) {\n          // While a return outside of a function call isn't normally possible,\n          // this can happen if a setTimeout/setInterval task returns.\n          return;\n        }\n        // Don't pop the stateStack.\n        // Leave the root scope on the tree in case the program is appended to.\n        state.done = true;\n        break loop;\n    }\n    if (type === Interpreter.Completion.BREAK) {\n      if (label ? (state.labels && state.labels.indexOf(label) !== -1) :\n          (state.isLoop || state.isSwitch)) {\n        stack.pop();\n        return;\n      }\n    } else if (type === Interpreter.Completion.CONTINUE) {\n      if (label ? (state.labels && state.labels.indexOf(label) !== -1) :\n          state.isLoop) {\n        return;\n      }\n    }\n  }\n\n  // Unhandled completion.  Throw a real error.\n  var realError;\n  if (this.isa(value, this.ERROR)) {\n    var errorTable = {\n      'EvalError': EvalError,\n      'RangeError': RangeError,\n      'ReferenceError': ReferenceError,\n      'SyntaxError': SyntaxError,\n      'TypeError': TypeError,\n      'URIError': URIError,\n    };\n    var name = String(this.getProperty(value, 'name'));\n    var message = this.getProperty(value, 'message').valueOf();\n    var errorConstructor = errorTable[name] || Error;\n    realError = errorConstructor(message);\n    realError.stack = String(this.getProperty(value, 'stack'));\n  } else {\n    realError = String(value);\n  }\n  // Overwrite the previous (more or less random) interpreter return value.\n  // Replace it with the error.\n  this.value = realError;\n  throw realError;\n};\n\n/**\n * AST to code.  Summarizes the expression at the given node.  Currently\n * not guaranteed to be correct or complete.  Used for error messages.\n * E.g. `escape('hello') + 42` -> 'escape(...) + 42'\n * @param {!Object} node AST node.\n * @returns {string} Code string.\n */\nInterpreter.prototype.nodeSummary = function(node) {\n  switch (node.type) {\n    case 'ArrayExpression':\n      return '[...]';\n    case 'BinaryExpression':\n    case 'LogicalExpression':\n      return this.nodeSummary(node.left) + ' ' + node.operator + ' ' +\n          this.nodeSummary(node.right);\n    case 'CallExpression':\n      return this.nodeSummary(node.callee) + '(...)';\n    case 'ConditionalExpression':\n      return this.nodeSummary(node.test) + ' ? ' +\n          this.nodeSummary(node.consequent) + ' : ' +\n          this.nodeSummary(node.alternate);\n    case 'Identifier':\n      return node.name;\n    case 'Literal':\n      return node.raw;\n    case 'MemberExpression':\n      var obj = this.nodeSummary(node.object);\n      var prop = this.nodeSummary(node.property);\n      return node.computed ? (obj + '[' + prop + ']') : (obj + '.' + prop);\n    case 'NewExpression':\n      return 'new ' + this.nodeSummary(node.callee) + '(...)';\n    case 'ObjectExpression':\n      return '{...}';\n    case 'ThisExpression':\n      return 'this';\n    case 'UnaryExpression':\n      return node.operator + ' ' + this.nodeSummary(node.argument);\n    case 'UpdateExpression':\n      var argument = this.nodeSummary(node.argument);\n      return node.prefix ? node.operator + argument : argument + node.operator;\n  }\n  return '???';\n};\n\n/**\n * Create a new queued task.\n * @param {boolean} isInterval True if setInterval, false if setTimeout.\n * @param {!Arguments} args Arguments from setInterval and setTimeout.\n *     [code, delay]\n *     [functionRef, delay, param1, param2, param3, ...]\n * @returns {number} PID of new task.\n * @private\n */\nInterpreter.prototype.createTask_ = function(isInterval, args) {\n  var parentState = this.stateStack[this.stateStack.length - 1];\n  var argsArray = Array.from(args);\n  var exec = argsArray.shift();\n  var delay = Math.max(Number(argsArray.shift() || 0), 0);\n  var node = this.newNode();\n  var scope, functionRef, ast;\n\n  if ((exec instanceof Interpreter.Object) && exec.class === 'Function') {\n    // setTimeout/setInterval with a function reference.\n    functionRef = exec;\n    node.type = 'CallExpression';\n    scope = parentState.scope;\n  } else {\n    // setTimeout/setInterval with code string.\n    try {\n      ast = this.parse_(String(exec), 'taskCode' + (this.taskCodeNumber_++));\n    } catch (e) {\n      // Acorn threw a SyntaxError.  Rethrow as a trappable error.\n      this.throwException(this.SYNTAX_ERROR, 'Invalid code: ' + e.message);\n    }\n    node.type = 'EvalProgram_';\n    node.body = ast.body;\n    // Change highlighting to encompas the string.\n    var execNode = parentState.node.arguments[0];\n    var execStart = execNode ? execNode.start : undefined;\n    var execEnd = execNode ? execNode.end : undefined;\n    Interpreter.stripLocations_(node, execStart, execEnd);\n    scope = this.globalScope;\n    argsArray.length = 0;\n  }\n\n  var task = new Interpreter.Task(functionRef, argsArray, scope, node,\n      isInterval ? delay : -1);\n  this.scheduleTask_(task, delay);\n  return task.pid;\n};\n\n/**\n * Schedule a task to execute at some time in the future.\n * @param {!Interpreter.Task} task Task to schedule.\n * @param {number} delay Number of ms before the task should execute.\n * @private\n */\nInterpreter.prototype.scheduleTask_ = function(task, delay) {\n  task.time = Date.now() + delay;\n  // For optimum efficiency we could do a binary search and inject the task\n  // at the right spot.  But 'push' & 'sort' is just two lines of code.\n  this.tasks.push(task);\n  this.tasks.sort(function(a, b) {return a.time - b.time});\n};\n\n/**\n * Delete a queued task.\n * @param {number} pid PID of task to delete.\n * @private\n */\nInterpreter.prototype.deleteTask_ = function(pid) {\n  for (var i = 0; i < this.tasks.length; i++) {\n    if (this.tasks[i].pid == pid) {\n      this.tasks.splice(i, 1);\n      break;\n    }\n  }\n};\n\n/**\n * Find the next queued task that's due to run.\n * @returns {Interpreter.State} Starting state of next task.  Null if no task.\n * @private\n */\nInterpreter.prototype.nextTask_ = function() {\n  var task = this.tasks[0];\n  if (!task || task.time > Date.now()) {\n    return null;\n  }\n  // Found a task that's due to run.\n  this.tasks.shift();\n  if (task.interval >= 0) {\n    this.scheduleTask_(task, task.interval);\n  }\n  var state = new Interpreter.State(task.node, task.scope);\n  if (task.functionRef) {\n    // setTimeout/setInterval with a function reference.\n    state.doneCallee_ = 2;\n    state.funcThis_ = this.globalObject;\n    state.func_ = task.functionRef;\n    state.doneArgs_ = true;\n    state.arguments_ = task.argsArray;\n  }\n  return state;\n};\n\n/**\n * Create a call to a getter function.\n * @param {!Interpreter.Object} func Function to execute.\n * @param {!Interpreter.Object|!Array} left\n *     Name of variable or object/propname tuple.\n * @private\n */\nInterpreter.prototype.createGetter_ = function(func, left) {\n  if (!this.getterStep_) {\n    throw Error('Unexpected call to createGetter');\n  }\n  // Clear the getter flag.\n  this.getterStep_ = false;\n  // Normally `this` will be specified as the object component (o.x).\n  // Sometimes `this` is explicitly provided (o).\n  var funcThis = Array.isArray(left) ? left[0] : left;\n  var node = this.newNode();\n  node.type = 'CallExpression';\n  var state = new Interpreter.State(node,\n      this.stateStack[this.stateStack.length - 1].scope);\n  state.doneCallee_ = 2;\n  state.funcThis_ = funcThis;\n  state.func_ = func;\n  state.doneArgs_ = true;\n  state.arguments_ = [];\n  return state;\n};\n\n/**\n * Create a call to a setter function.\n * @param {!Interpreter.Object} func Function to execute.\n * @param {!Interpreter.Object|!Array} left\n *     Name of variable or object/propname tuple.\n * @param {Interpreter.Value} value Value to set.\n * @private\n */\nInterpreter.prototype.createSetter_ = function(func, left, value) {\n  if (!this.setterStep_) {\n    throw Error('Unexpected call to createSetter');\n  }\n  // Clear the setter flag.\n  this.setterStep_ = false;\n  // Normally `this` will be specified as the object component (o.x).\n  // Sometimes `this` is implicitly the global object (x).\n  var funcThis = Array.isArray(left) ? left[0] : this.globalObject;\n  var node = this.newNode();\n  node.type = 'CallExpression';\n  var state = new Interpreter.State(node,\n      this.stateStack[this.stateStack.length - 1].scope);\n  state.doneCallee_ = 2;\n  state.funcThis_ = funcThis;\n  state.func_ = func;\n  state.doneArgs_ = true;\n  state.arguments_ = [value];\n  return state;\n};\n\n/**\n * In non-strict mode `this` must be an object.\n * Must not be called in strict mode.\n * @param {Interpreter.Value} value Proposed value for `this`.\n * @returns {!Interpreter.Object} Final value for `this`.\n * @private\n */\nInterpreter.prototype.boxThis_ = function(value) {\n  if (value === undefined || value === null) {\n    // `Undefined` and `null` are changed to the global object.\n    return this.globalObject;\n  }\n  if (!(value instanceof Interpreter.Object)) {\n    // Primitives must be boxed.\n    var box = this.createObjectProto(this.getPrototype(value));\n    box.data = value;\n    return box;\n  }\n  return value;\n};\n\n/**\n * Return the global scope object.\n * @returns {!Interpreter.Scope} Scope object.\n */\nInterpreter.prototype.getGlobalScope = function() {\n  return this.globalScope;\n};\n\n/**\n * Sets the global scope object.\n * @param {!Interpreter.Scope} newScope Scope object.\n */\nInterpreter.prototype.setGlobalScope = function(newScope) {\n  this.globalScope = newScope;\n  this.stateStack[0].scope = newScope;\n};\n\n/**\n * Return the state stack.\n * @returns {!Array<!Interpreter.State>} State stack.\n */\nInterpreter.prototype.getStateStack = function() {\n  return this.stateStack;\n};\n\n/**\n * Replace the state stack with a new one.\n * @param {!Array<!Interpreter.State>} newStack New state stack.\n */\nInterpreter.prototype.setStateStack = function(newStack) {\n  this.stateStack = newStack;\n};\n\n/**\n * Typedef for JS values.\n * @typedef {!Interpreter.Object|boolean|number|string|undefined|null}\n */\nInterpreter.Value;\n\n/**\n * Class for a state.\n * @param {!Object} node AST node for the state.\n * @param {!Interpreter.Scope} scope Scope object for the state.\n * @constructor\n */\nInterpreter.State = function(node, scope) {\n  this.node = node;\n  this.scope = scope;\n};\n\n/**\n * Class for a scope.\n * @param {Interpreter.Scope} parentScope Parent scope.\n * @param {boolean} strict True if \"use strict\".\n * @param {!Interpreter.Object} object Object containing scope's variables.\n * @struct\n * @constructor\n */\nInterpreter.Scope = function(parentScope, strict, object) {\n  this.parentScope = parentScope;\n  this.strict = strict;\n  this.object = object;\n};\n\n/**\n * Class for an object.\n * @param {Interpreter.Object} proto Prototype object or null.\n * @constructor\n */\nInterpreter.Object = function(proto) {\n  this.getter = Object.create(null);\n  this.setter = Object.create(null);\n  this.properties = Object.create(null);\n  this.proto = proto;\n};\n\n/** @type {Interpreter.Object} */\nInterpreter.Object.prototype.proto = null;\n\n/** @type {string} */\nInterpreter.Object.prototype.class = 'Object';\n\n/** @type {Date|RegExp|boolean|number|string|null} */\nInterpreter.Object.prototype.data = null;\n\n/**\n * Convert this object into a string.\n * @returns {string} String value.\n * @override\n */\nInterpreter.Object.prototype.toString = function() {\n  if (!Interpreter.currentInterpreter_) {\n    // Called from outside an interpreter.\n    return '[object Interpreter.Object]';\n  }\n  if (!(this instanceof Interpreter.Object)) {\n    // Primitive value.\n    return String(this);\n  }\n\n  if (this.class === 'Array') {\n    // Array contents must not have cycles.\n    var cycles = Interpreter.toStringCycles_;\n    cycles.push(this);\n    try {\n      var strs = [];\n      // Truncate very long strings.  This is not part of the spec,\n      // but it prevents hanging the interpreter for gigantic arrays.\n      var maxLength = this.properties.length;\n      var truncated = false;\n      if (maxLength > 1024) {\n        maxLength = 1000;\n        truncated = true;\n      }\n      for (var i = 0; i < maxLength; i++) {\n        var value = this.properties[i];\n        strs[i] = ((value instanceof Interpreter.Object) &&\n            cycles.indexOf(value) !== -1) ? '...' : value;\n      }\n      if (truncated) {\n        strs.push('...');\n      }\n    } finally {\n      cycles.pop();\n    }\n    return strs.join(',');\n  }\n\n  if (this.class === 'Error') {\n    // Error name and message properties must not have cycles.\n    var cycles = Interpreter.toStringCycles_;\n    if (cycles.indexOf(this) !== -1) {\n      return '[object Error]';\n    }\n    var name, message;\n    // Bug: Does not support getters and setters for name or message.\n    var obj = this;\n    do {\n      if ('name' in obj.properties) {\n        name = obj.properties.name;\n        break;\n      }\n    } while ((obj = obj.proto));\n    obj = this;\n    do {\n      if ('message' in obj.properties) {\n        message = obj.properties.message;\n        break;\n      }\n    } while ((obj = obj.proto));\n    cycles.push(this);\n    try {\n      name = name && String(name);\n      message = message && String(message);\n    } finally {\n      cycles.pop();\n    }\n    return message ? name + ': ' + message : String(name);\n  }\n\n  if (this.data !== null) {\n    // RegExp, Date, and boxed primitives.\n    return String(this.data);\n  }\n\n  return '[object ' + this.class + ']';\n};\n\n/**\n * Return the object's value.\n * @returns {Interpreter.Value} Value.\n * @override\n */\nInterpreter.Object.prototype.valueOf = function() {\n  if (!Interpreter.currentInterpreter_) {\n    // Called from outside an interpreter.\n    return this;\n  }\n  if (this.data === undefined || this.data === null ||\n      this.data instanceof RegExp) {\n    return this;  // An Object, RegExp, or primitive.\n  }\n  if (this.data instanceof Date) {\n    return this.data.valueOf();  // Milliseconds.\n  }\n  return /** @type {(boolean|number|string)} */ (this.data);  // Boxed primitive.\n};\n\n/**\n * Class for a task.\n * @param {!Interpreter.Object|undefined} functionRef Function to call.\n * @param {!Array<Interpreter.Value>} argsArray Array of arguments.\n * @param {!Interpreter.Scope} scope Scope for this task.\n * @param {!Object} node AST node to execute.\n * @param {number} interval Number of ms this task repeats.  -1 for no repeats.\n * @struct\n * @constructor\n */\nInterpreter.Task = function(functionRef, argsArray, scope, node, interval) {\n  this.functionRef = functionRef;\n  this.argsArray = argsArray;\n  this.scope = scope;\n  this.node = node;\n\n  this.interval = interval;\n  this.pid = ++Interpreter.Task.pid;\n  this.time = 0;\n};\n\nInterpreter.Task.pid = 0;\n\n///////////////////////////////////////////////////////////////////////////////\n// Functions to handle each node type.\n///////////////////////////////////////////////////////////////////////////////\n\nInterpreter.prototype['stepArrayExpression'] = function(stack, state, node) {\n  var elements = node.elements;\n  var n = state.n_ || 0;\n  if (!state.array_) {\n    state.array_ = this.createArray();\n    state.array_.properties.length = elements.length;\n  } else {\n    this.setProperty(state.array_, n, state.value);\n    n++;\n  }\n  while (n < elements.length) {\n    // Skip missing elements - they're not defined, not undefined.\n    if (elements[n]) {\n      state.n_ = n;\n      return new Interpreter.State(elements[n], state.scope);\n    }\n    n++;\n  }\n  stack.pop();\n  stack[stack.length - 1].value = state.array_;\n};\n\nInterpreter.prototype['stepAssignmentExpression'] =\n    function(stack, state, node) {\n  if (!state.doneLeft_) {\n    state.doneLeft_ = true;\n    var nextState = new Interpreter.State(node.left, state.scope);\n    nextState.components = true;\n    return nextState;\n  }\n  if (!state.doneRight_) {\n    if (!state.leftReference_) {\n      state.leftReference_ = state.value;\n    }\n    if (state.doneGetter_) {\n      state.leftValue_ = state.value;\n    }\n    if (!state.doneGetter_ && node.operator !== '=') {\n      var leftValue = this.getValue(state.leftReference_);\n      state.leftValue_ = leftValue;\n      if (this.getterStep_) {\n        // Call the getter function.\n        state.doneGetter_ = true;\n        var func = /** @type {!Interpreter.Object} */ (leftValue);\n        return this.createGetter_(func, state.leftReference_);\n      }\n    }\n    state.doneRight_ = true;\n    // When assigning an unnamed function to a variable, the function's name\n    // is set to the variable name.  Record the variable name in case the\n    // right side is a functionExpression.\n    // E.g. foo = function() {};\n    if (node.operator === '=' && node.left.type === 'Identifier') {\n      state.destinationName = node.left.name;\n    }\n    return new Interpreter.State(node.right, state.scope);\n  }\n  if (state.doneSetter_) {\n    // Return if setter function.\n    // Setter method on property has completed.\n    // Ignore its return value, and use the original set value instead.\n    stack.pop();\n    stack[stack.length - 1].value = state.setterValue_;\n    return;\n  }\n  var value = state.leftValue_;\n  var rightValue = state.value;\n  switch (node.operator) {\n    case '=':    value =    rightValue; break;\n    case '+=':   value +=   rightValue; break;\n    case '-=':   value -=   rightValue; break;\n    case '*=':   value *=   rightValue; break;\n    case '/=':   value /=   rightValue; break;\n    case '%=':   value %=   rightValue; break;\n    case '<<=':  value <<=  rightValue; break;\n    case '>>=':  value >>=  rightValue; break;\n    case '>>>=': value >>>= rightValue; break;\n    case '&=':   value &=   rightValue; break;\n    case '^=':   value ^=   rightValue; break;\n    case '|=':   value |=   rightValue; break;\n    default:\n      throw SyntaxError('Unknown assignment expression: ' + node.operator);\n  }\n  var setter = this.setValue(state.leftReference_, value);\n  if (setter) {\n    state.doneSetter_ = true;\n    state.setterValue_ = value;\n    return this.createSetter_(setter, state.leftReference_, value);\n  }\n  // Return if no setter function.\n  stack.pop();\n  stack[stack.length - 1].value = value;\n};\n\nInterpreter.prototype['stepBinaryExpression'] = function(stack, state, node) {\n  if (!state.doneLeft_) {\n    state.doneLeft_ = true;\n    return new Interpreter.State(node.left, state.scope);\n  }\n  if (!state.doneRight_) {\n    state.doneRight_ = true;\n    state.leftValue_ = state.value;\n    return new Interpreter.State(node.right, state.scope);\n  }\n  stack.pop();\n  var leftValue = state.leftValue_;\n  var rightValue = state.value;\n  var value;\n  switch (node.operator) {\n    case '==':  value = leftValue ==  rightValue; break;\n    case '!=':  value = leftValue !=  rightValue; break;\n    case '===': value = leftValue === rightValue; break;\n    case '!==': value = leftValue !== rightValue; break;\n    case '>':   value = leftValue >   rightValue; break;\n    case '>=':  value = leftValue >=  rightValue; break;\n    case '<':   value = leftValue <   rightValue; break;\n    case '<=':  value = leftValue <=  rightValue; break;\n    case '+':   value = leftValue +   rightValue; break;\n    case '-':   value = leftValue -   rightValue; break;\n    case '*':   value = leftValue *   rightValue; break;\n    case '/':   value = leftValue /   rightValue; break;\n    case '%':   value = leftValue %   rightValue; break;\n    case '&':   value = leftValue &   rightValue; break;\n    case '|':   value = leftValue |   rightValue; break;\n    case '^':   value = leftValue ^   rightValue; break;\n    case '<<':  value = leftValue <<  rightValue; break;\n    case '>>':  value = leftValue >>  rightValue; break;\n    case '>>>': value = leftValue >>> rightValue; break;\n    case 'in':\n      if (!(rightValue instanceof Interpreter.Object)) {\n        this.throwException(this.TYPE_ERROR,\n            \"'in' expects an object, not '\" + rightValue + \"'\");\n      }\n      value = this.hasProperty(rightValue, leftValue);\n      break;\n    case 'instanceof':\n      if (!this.isa(rightValue, this.FUNCTION)) {\n        this.throwException(this.TYPE_ERROR,\n            \"'instanceof' expects an object, not '\" + rightValue + \"'\");\n      }\n      value = (leftValue instanceof Interpreter.Object) ?\n          this.isa(leftValue, rightValue) : false;\n      break;\n    default:\n      throw SyntaxError('Unknown binary operator: ' + node.operator);\n  }\n  stack[stack.length - 1].value = value;\n};\n\nInterpreter.prototype['stepBlockStatement'] = function(stack, state, node) {\n  var n = state.n_ || 0;\n  var expression = node.body[n];\n  if (expression) {\n    state.n_ = n + 1;\n    return new Interpreter.State(expression, state.scope);\n  }\n  stack.pop();\n};\n\nInterpreter.prototype['stepBreakStatement'] = function(stack, state, node) {\n  var label = node.label && node.label.name;\n  this.unwind(Interpreter.Completion.BREAK, undefined, label);\n};\n\n/**\n * Number of evals called by the interpreter.\n * @private\n */\nInterpreter.prototype.evalCodeNumber_ = 0;\n\nInterpreter.prototype['stepCallExpression'] = function(stack, state, node) {\n  // Handles both CallExpression and NewExpression.\n  if (!state.doneCallee_) {\n    state.doneCallee_ = 1;\n    // Components needed to determine value of `this`.\n    var nextState = new Interpreter.State(node.callee, state.scope);\n    nextState.components = true;\n    return nextState;\n  }\n  if (state.doneCallee_ === 1) {\n    // Determine value of the function.\n    state.doneCallee_ = 2;\n    var func = state.value;\n    if (Array.isArray(func)) {\n      state.func_ = this.getValue(func);\n      if (func[0] === Interpreter.SCOPE_REFERENCE) {\n        // (Globally or locally) named function.  Is it named 'eval'?\n        state.directEval_ = (func[1] === 'eval');\n      } else {\n        // Method function, `this` is object (ignored if invoked as `new`).\n        state.funcThis_ = func[0];\n      }\n      func = state.func_;\n      if (this.getterStep_) {\n        // Call the getter function.\n        state.doneCallee_ = 1;\n        return this.createGetter_(/** @type {!Interpreter.Object} */ (func),\n            state.value);\n      }\n    } else {\n      // Already evaluated function: (function(){...})();\n      state.func_ = func;\n    }\n    state.arguments_ = [];\n    state.n_ = 0;\n  }\n  var func = state.func_;\n  if (!state.doneArgs_) {\n    if (state.n_ !== 0) {\n      state.arguments_.push(state.value);\n    }\n    if (node.arguments[state.n_]) {\n      return new Interpreter.State(node.arguments[state.n_++], state.scope);\n    }\n    // Determine value of `this` in function.\n    if (node.type === 'NewExpression') {\n      if (!(func instanceof Interpreter.Object) || func.illegalConstructor) {\n        // Illegal: new escape();\n        this.throwException(this.TYPE_ERROR,\n            this.nodeSummary(node.callee) + ' is not a constructor');\n      }\n      // Constructor, `this` is new object.\n      if (func === this.ARRAY) {\n        state.funcThis_ = this.createArray();\n      } else {\n        var proto = func.properties['prototype'];\n        if (typeof proto !== 'object' || proto === null) {\n          // Non-object prototypes default to `Object.prototype`.\n          proto = this.OBJECT_PROTO;\n        }\n        state.funcThis_ = this.createObjectProto(proto);\n      }\n      state.isConstructor = true;\n    }\n    state.doneArgs_ = true;\n  }\n  if (!state.doneExec_) {\n    state.doneExec_ = true;\n    if (!(func instanceof Interpreter.Object)) {\n      this.throwException(this.TYPE_ERROR,\n          this.nodeSummary(node.callee) + ' is not a function');\n    }\n    var funcNode = func.node;\n    if (funcNode) {\n      var scope = this.createScope(funcNode.body, func.parentScope);\n      // Build arguments variable.\n      var argsList = this.createArray();\n      for (var i = 0; i < state.arguments_.length; i++) {\n        this.setProperty(argsList, i, state.arguments_[i]);\n      }\n      this.setProperty(scope.object, 'arguments', argsList);\n      // Add all arguments (may clobber 'arguments' if a param is named such).\n      for (var i = 0; i < funcNode.params.length; i++) {\n        var paramName = funcNode.params[i].name;\n        var paramValue = state.arguments_.length > i ? state.arguments_[i] :\n            undefined;\n        this.setProperty(scope.object, paramName, paramValue);\n      }\n      if (!scope.strict) {\n        state.funcThis_ = this.boxThis_(state.funcThis_);\n      }\n      this.setProperty(scope.object, 'this', state.funcThis_,\n                       Interpreter.READONLY_DESCRIPTOR);\n      state.value = undefined;  // Default value if no explicit return.\n      return new Interpreter.State(funcNode.body, scope);\n    } else if (func.eval) {\n      var code = state.arguments_[0];\n      if (typeof code !== 'string') {\n        // JS does not parse String objects:\n        // eval(new String('1 + 1')) -> '1 + 1'\n        state.value = code;\n      } else {\n        try {\n          var ast = this.parse_(String(code),\n             'eval' + (this.evalCodeNumber_++));\n        } catch (e) {\n          // Acorn threw a SyntaxError.  Rethrow as a trappable error.\n          this.throwException(this.SYNTAX_ERROR, 'Invalid code: ' + e.message);\n        }\n        var evalNode = this.newNode();\n        evalNode.type = 'EvalProgram_';\n        evalNode.body = ast.body;\n        Interpreter.stripLocations_(evalNode, node.start, node.end);\n        // Create new scope and update it with definitions in eval().\n        var scope = state.directEval_ ? state.scope : this.globalScope;\n        if (scope.strict) {\n          // Strict mode get its own scope in eval.\n          scope = this.createScope(ast, scope);\n        } else {\n          // Non-strict mode pollutes the current scope.\n          this.populateScope_(ast, scope);\n        }\n        this.value = undefined;  // Default value if no code.\n        return new Interpreter.State(evalNode, scope);\n      }\n    } else if (func.nativeFunc) {\n      if (!state.scope.strict) {\n        state.funcThis_ = this.boxThis_(state.funcThis_);\n      }\n      state.value = func.nativeFunc.apply(state.funcThis_, state.arguments_);\n    } else if (func.asyncFunc) {\n      var thisInterpreter = this;\n      var callback = function(value) {\n        state.value = value;\n        thisInterpreter.paused_ = false;\n      };\n      // Force the argument lengths to match, then append the callback.\n      var argLength = func.asyncFunc.length - 1;\n      var argsWithCallback = state.arguments_.concat(\n          new Array(argLength)).slice(0, argLength);\n      argsWithCallback.push(callback);\n      this.paused_ = true;\n      if (!state.scope.strict) {\n        state.funcThis_ = this.boxThis_(state.funcThis_);\n      }\n      func.asyncFunc.apply(state.funcThis_, argsWithCallback);\n      return;\n    } else {\n      /* A child of a function is a function but is not callable.  For example:\n      var F = function() {};\n      F.prototype = escape;\n      var f = new F();\n      f();\n      */\n      this.throwException(this.TYPE_ERROR,\n          this.nodeSummary(node.callee) + ' is not callable');\n    }\n  } else {\n    // Execution complete.  Put the return value on the stack.\n    stack.pop();\n    if (state.isConstructor && typeof state.value !== 'object') {\n      // Normal case for a constructor is to use the `this` value.\n      stack[stack.length - 1].value = state.funcThis_;\n    } else {\n      // Non-constructors or constructions explicitly returning objects use\n      // the return value.\n      stack[stack.length - 1].value = state.value;\n    }\n  }\n};\n\nInterpreter.prototype['stepConditionalExpression'] =\n    function(stack, state, node) {\n  // Handles both ConditionalExpression and IfStatement.\n  var mode = state.mode_ || 0;\n  if (mode === 0) {\n    state.mode_ = 1;\n    return new Interpreter.State(node.test, state.scope);\n  }\n  if (mode === 1) {\n    state.mode_ = 2;\n    var value = Boolean(state.value);\n    if (value && node.consequent) {\n      // Execute `if` block.\n      return new Interpreter.State(node.consequent, state.scope);\n    } else if (!value && node.alternate) {\n      // Execute `else` block.\n      return new Interpreter.State(node.alternate, state.scope);\n    }\n    // eval('1;if(false){2}') -> undefined\n    this.value = undefined;\n  }\n  stack.pop();\n  if (node.type === 'ConditionalExpression') {\n    stack[stack.length - 1].value = state.value;\n  }\n};\n\nInterpreter.prototype['stepContinueStatement'] = function(stack, state, node) {\n  var label = node.label && node.label.name;\n  this.unwind(Interpreter.Completion.CONTINUE, undefined, label);\n};\n\nInterpreter.prototype['stepDebuggerStatement'] = function(stack, state, node) {\n  // Do nothing.  May be overridden by developers.\n  stack.pop();\n};\n\nInterpreter.prototype['stepDoWhileStatement'] = function(stack, state, node) {\n  // Handles both DoWhileStatement and WhileStatement.\n  if (node.type === 'DoWhileStatement' && state.test_ === undefined) {\n    // First iteration of do/while executes without checking test.\n    state.value = true;\n    state.test_ = true;\n  }\n  if (!state.test_) {\n    state.test_ = true;\n    return new Interpreter.State(node.test, state.scope);\n  }\n  if (!state.value) {  // Done, exit loop.\n    stack.pop();\n  } else if (node.body) {  // Execute the body.\n    state.test_ = false;\n    state.isLoop = true;\n    return new Interpreter.State(node.body, state.scope);\n  }\n};\n\nInterpreter.prototype['stepEmptyStatement'] = function(stack, state, node) {\n  stack.pop();\n};\n\nInterpreter.prototype['stepEvalProgram_'] = function(stack, state, node) {\n  var n = state.n_ || 0;\n  var expression = node.body[n];\n  if (expression) {\n    state.n_ = n + 1;\n    return new Interpreter.State(expression, state.scope);\n  }\n  stack.pop();\n  stack[stack.length - 1].value = this.value;\n};\n\nInterpreter.prototype['stepExpressionStatement'] = function(stack, state, node) {\n  if (!state.done_) {\n    this.value = undefined;\n    state.done_ = true;\n    return new Interpreter.State(node.expression, state.scope);\n  }\n  stack.pop();\n  // Save this value to interpreter.value for use as a return value if\n  // this code is inside an eval function.\n  this.value = state.value;\n};\n\nInterpreter.prototype['stepForInStatement'] = function(stack, state, node) {\n  // First, initialize a variable if exists.  Only do so once, ever.\n  if (!state.doneInit_) {\n    state.doneInit_ = true;\n    if (node.left.declarations &&\n        node.left.declarations[0].init) {\n      if (state.scope.strict) {\n        this.throwException(this.SYNTAX_ERROR,\n            'for-in loop variable declaration may not have an initializer');\n      }\n      // Variable initialization: for (var x = 4 in y)\n      return new Interpreter.State(node.left, state.scope);\n    }\n  }\n  // Second, look up the object.  Only do so once, ever.\n  if (!state.doneObject_) {\n    state.doneObject_ = true;\n    if (!state.variable_) {\n      state.variable_ = state.value;\n    }\n    return new Interpreter.State(node.right, state.scope);\n  }\n  if (!state.isLoop) {\n    // First iteration.\n    state.isLoop = true;\n    state.object_ = state.value;\n    state.visited_ = Object.create(null);\n  }\n  // Third, find the property name for this iteration.\n  if (state.name_ === undefined) {\n    gotPropName: while (true) {\n      if (state.object_ instanceof Interpreter.Object) {\n        if (!state.props_) {\n          state.props_ = Object.getOwnPropertyNames(state.object_.properties);\n        }\n        while (true) {\n          var prop = state.props_.shift();\n          if (prop === undefined) {\n            break;  // Reached end of this object's properties.\n          }\n          if (!Object.prototype.hasOwnProperty.call(state.object_.properties,\n                prop)) {\n            continue;  // Property has been deleted in the loop.\n          }\n          if (state.visited_[prop]) {\n            continue;  // Already seen this property on a child.\n          }\n          state.visited_[prop] = true;\n          if (!Object.prototype.propertyIsEnumerable.call(\n                state.object_.properties, prop)) {\n            continue;  // Skip non-enumerable property.\n          }\n          state.name_ = prop;\n          break gotPropName;\n        }\n      } else if (state.object_ !== null && state.object_ !== undefined) {\n        // Primitive value (other than null or undefined).\n        if (!state.props_) {\n          state.props_ = Object.getOwnPropertyNames(state.object_);\n        }\n        while (true) {\n          var prop = state.props_.shift();\n          if (prop === undefined) {\n            break;  // Reached end of this value's properties.\n          }\n          state.visited_[prop] = true;\n          if (!Object.prototype.propertyIsEnumerable.call(\n                state.object_, prop)) {\n            continue;  // Skip non-enumerable property.\n          }\n          state.name_ = prop;\n          break gotPropName;\n        }\n      }\n      state.object_ = this.getPrototype(state.object_);\n      state.props_ = null;\n      if (state.object_ === null) {\n        // Done, exit loop.\n        stack.pop();\n        return;\n      }\n    }\n  }\n  // Fourth, find the variable\n  if (!state.doneVariable_) {\n    state.doneVariable_ = true;\n    var left = node.left;\n    if (left.type === 'VariableDeclaration') {\n      // Inline variable declaration: for (var x in y)\n      state.variable_ =\n          [Interpreter.SCOPE_REFERENCE, left.declarations[0].id.name];\n    } else {\n      // Arbitrary left side: for (foo().bar in y)\n      state.variable_ = null;\n      var nextState = new Interpreter.State(left, state.scope);\n      nextState.components = true;\n      return nextState;\n    }\n  }\n  if (!state.variable_) {\n    state.variable_ = state.value;\n  }\n  // Fifth, set the variable.\n  if (!state.doneSetter_) {\n    state.doneSetter_ = true;\n    var value = state.name_;\n    var setter = this.setValue(state.variable_, value);\n    if (setter) {\n      return this.createSetter_(setter, state.variable_, value);\n    }\n  }\n  // Next step will be step three.\n  state.name_ = undefined;\n  // Reevaluate the variable since it could be a setter on the global object.\n  state.doneVariable_ = false;\n  state.doneSetter_ = false;\n  // Sixth and finally, execute the body if there was one.\n  if (node.body) {\n    return new Interpreter.State(node.body, state.scope);\n  }\n};\n\nInterpreter.prototype['stepForStatement'] = function(stack, state, node) {\n  switch (state.mode_) {\n    default:\n      state.mode_ = 1;\n      if (node.init) {\n        return new Interpreter.State(node.init, state.scope);\n      }\n      break;\n    case 1:\n      state.mode_ = 2;\n      if (node.test) {\n        return new Interpreter.State(node.test, state.scope);\n      }\n      break;\n    case 2:\n      state.mode_ = 3;\n      if (node.test && !state.value) {\n        // Done, exit loop.\n        stack.pop();\n      } else {  // Execute the body.\n        state.isLoop = true;\n        return new Interpreter.State(node.body, state.scope);\n      }\n      break;\n    case 3:\n      state.mode_ = 1;\n      if (node.update) {\n        return new Interpreter.State(node.update, state.scope);\n      }\n      break;\n  }\n};\n\nInterpreter.prototype['stepFunctionDeclaration'] =\n    function(stack, state, node) {\n  // This was found and handled when the scope was populated.\n  stack.pop();\n};\n\nInterpreter.prototype['stepFunctionExpression'] = function(stack, state, node) {\n  stack.pop();\n  state = stack[stack.length - 1];\n  var parentScope = state.scope;\n  if (node.id) {\n    // Create a tiny scope to store the function name.\n    // E.g. var x = function foo(){};\n    parentScope = this.createSpecialScope(parentScope);\n  }\n  state.value = this.createFunction(node, parentScope, state.destinationName);\n  if (node.id) {\n    // Record the function name, read-only.\n    this.setProperty(parentScope.object, node.id.name, state.value,\n        Interpreter.READONLY_DESCRIPTOR);\n  }\n};\n\nInterpreter.prototype['stepIdentifier'] = function(stack, state, node) {\n  stack.pop();\n  if (state.components) {\n    stack[stack.length - 1].value = [Interpreter.SCOPE_REFERENCE, node.name];\n    return;\n  }\n  var value = this.getValueFromScope(node.name);\n  // An identifier could be a getter if it's a property on the global object.\n  if (this.getterStep_) {\n    // Call the getter function.\n    var func = /** @type {!Interpreter.Object} */ (value);\n    return this.createGetter_(func, this.globalObject);\n  }\n  stack[stack.length - 1].value = value;\n};\n\nInterpreter.prototype['stepIfStatement'] =\n    Interpreter.prototype['stepConditionalExpression'];\n\nInterpreter.prototype['stepLabeledStatement'] = function(stack, state, node) {\n  // No need to hit this node again on the way back up the stack.\n  stack.pop();\n  // Note that a statement might have multiple labels.\n  var labels = state.labels || [];\n  labels.push(node.label.name);\n  var nextState = new Interpreter.State(node.body, state.scope);\n  nextState.labels = labels;\n  return nextState;\n};\n\nInterpreter.prototype['stepLiteral'] = function(stack, state, node) {\n  stack.pop();\n  var value = node.value;\n  if (value instanceof RegExp) {\n    var pseudoRegexp = this.createObjectProto(this.REGEXP_PROTO);\n    this.populateRegExp(pseudoRegexp, value);\n    value = pseudoRegexp;\n  }\n  stack[stack.length - 1].value = value;\n};\n\nInterpreter.prototype['stepLogicalExpression'] = function(stack, state, node) {\n  if (node.operator !== '&&' && node.operator !== '||') {\n    throw SyntaxError('Unknown logical operator: ' + node.operator);\n  }\n  if (!state.doneLeft_) {\n    state.doneLeft_ = true;\n    return new Interpreter.State(node.left, state.scope);\n  }\n  if (!state.doneRight_) {\n    if ((node.operator === '&&' && !state.value) ||\n        (node.operator === '||' && state.value)) {\n      // Shortcut evaluation.\n      stack.pop();\n      stack[stack.length - 1].value = state.value;\n    } else {\n      state.doneRight_ = true;\n      return new Interpreter.State(node.right, state.scope);\n    }\n  } else {\n    stack.pop();\n    stack[stack.length - 1].value = state.value;\n  }\n};\n\nInterpreter.prototype['stepMemberExpression'] = function(stack, state, node) {\n  if (!state.doneObject_) {\n    state.doneObject_ = true;\n    return new Interpreter.State(node.object, state.scope);\n  }\n  var propName;\n  if (!node.computed) {\n    state.object_ = state.value;\n    // obj.foo -- Just access `foo` directly.\n    propName = node.property.name;\n  } else if (!state.doneProperty_) {\n    state.object_ = state.value;\n    // obj[foo] -- Compute value of `foo`.\n    state.doneProperty_ = true;\n    return new Interpreter.State(node.property, state.scope);\n  } else {\n    propName = state.value;\n  }\n  stack.pop();\n  if (state.components) {\n    stack[stack.length - 1].value = [state.object_, propName];\n  } else {\n    var value = this.getProperty(state.object_, propName);\n    if (this.getterStep_) {\n      // Call the getter function.\n      var func = /** @type {!Interpreter.Object} */ (value);\n      return this.createGetter_(func, state.object_);\n    }\n    stack[stack.length - 1].value = value;\n  }\n};\n\nInterpreter.prototype['stepNewExpression'] =\n    Interpreter.prototype['stepCallExpression'];\n\nInterpreter.prototype['stepObjectExpression'] = function(stack, state, node) {\n  var n = state.n_ || 0;\n  var property = node.properties[n];\n  if (!state.object_) {\n    // First execution.\n    state.object_ = this.createObjectProto(this.OBJECT_PROTO);\n    state.properties_ = Object.create(null);\n  } else {\n    // Set the property computed in the previous execution.\n    var propName = state.destinationName;\n    if (!state.properties_[propName]) {\n      // Create temp object to collect value, getter, and/or setter.\n      state.properties_[propName] = {};\n    }\n    state.properties_[propName][property.kind] = state.value;\n    state.n_ = ++n;\n    property = node.properties[n];\n  }\n  if (property) {\n    // Determine property name.\n    var key = property.key;\n    if (key.type === 'Identifier') {\n      var propName = key.name;\n    } else if (key.type === 'Literal') {\n      var propName = key.value;\n    } else {\n      throw SyntaxError('Unknown object structure: ' + key.type);\n    }\n    // When assigning an unnamed function to a property, the function's name\n    // is set to the property name.  Record the property name in case the\n    // value is a functionExpression.\n    // E.g. {foo: function() {}}\n    state.destinationName = propName;\n    return new Interpreter.State(property.value, state.scope);\n  }\n  for (var key in state.properties_) {\n    var kinds = state.properties_[key];\n    if ('get' in kinds || 'set' in kinds) {\n      // Set a property with a getter or setter.\n      var descriptor = {\n        'configurable': true,\n        'enumerable': true,\n        'get': kinds['get'],\n        'set': kinds['set'],\n      };\n      this.setProperty(state.object_, key, Interpreter.VALUE_IN_DESCRIPTOR,\n                       descriptor);\n    } else {\n      // Set a normal property with a value.\n      this.setProperty(state.object_, key, kinds['init']);\n    }\n  }\n  stack.pop();\n  stack[stack.length - 1].value = state.object_;\n};\n\nInterpreter.prototype['stepProgram'] = function(stack, state, node) {\n  var expression = node.body.shift();\n  if (expression) {\n    state.done = false;\n    return new Interpreter.State(expression, state.scope);\n  }\n  state.done = true;\n  // Don't pop the stateStack.\n  // Leave the root scope on the tree in case the program is appended to.\n};\n\nInterpreter.prototype['stepReturnStatement'] = function(stack, state, node) {\n  if (node.argument && !state.done_) {\n    state.done_ = true;\n    return new Interpreter.State(node.argument, state.scope);\n  }\n  this.unwind(Interpreter.Completion.RETURN, state.value, undefined);\n};\n\nInterpreter.prototype['stepSequenceExpression'] = function(stack, state, node) {\n  var n = state.n_ || 0;\n  var expression = node.expressions[n];\n  if (expression) {\n    state.n_ = n + 1;\n    return new Interpreter.State(expression, state.scope);\n  }\n  stack.pop();\n  stack[stack.length - 1].value = state.value;\n};\n\nInterpreter.prototype['stepSwitchStatement'] = function(stack, state, node) {\n  if (!state.test_) {\n    state.test_ = 1;\n    return new Interpreter.State(node.discriminant, state.scope);\n  }\n  if (state.test_ === 1) {\n    state.test_ = 2;\n    // Preserve switch value between case tests.\n    state.switchValue_ = state.value;\n    state.defaultCase_ = -1;\n  }\n\n  while (true) {\n    var index = state.index_ || 0;\n    var switchCase = node.cases[index];\n    if (!state.matched_ && switchCase && !switchCase.test) {\n      // Test on the default case is null.\n      // Bypass (but store) the default case, and get back to it later.\n      state.defaultCase_ = index;\n      state.index_ = index + 1;\n      continue;\n    }\n    if (!switchCase && !state.matched_ && state.defaultCase_ !== -1) {\n      // Ran through all cases, no match.  Jump to the default.\n      state.matched_ = true;\n      state.index_ = state.defaultCase_;\n      continue;\n    }\n    if (switchCase) {\n      if (!state.matched_ && !state.tested_ && switchCase.test) {\n        state.tested_ = true;\n        return new Interpreter.State(switchCase.test, state.scope);\n      }\n      if (state.matched_ || state.value === state.switchValue_) {\n        state.matched_ = true;\n        var n = state.n_ || 0;\n        if (switchCase.consequent[n]) {\n          state.isSwitch = true;\n          state.n_ = n + 1;\n          return new Interpreter.State(switchCase.consequent[n], state.scope);\n        }\n      }\n      // Move on to next case.\n      state.tested_ = false;\n      state.n_ = 0;\n      state.index_ = index + 1;\n    } else {\n      stack.pop();\n      return;\n    }\n  }\n};\n\nInterpreter.prototype['stepThisExpression'] = function(stack, state, node) {\n  stack.pop();\n  stack[stack.length - 1].value = this.getValueFromScope('this');\n};\n\nInterpreter.prototype['stepThrowStatement'] = function(stack, state, node) {\n  if (!state.done_) {\n    state.done_ = true;\n    return new Interpreter.State(node.argument, state.scope);\n  } else {\n    this.throwException(state.value);\n  }\n};\n\nInterpreter.prototype['stepTryStatement'] = function(stack, state, node) {\n  // This step also handles all CatchClause nodes, since these nodes can\n  // only appear inside the `handler` property of a TryStatement node.\n  if (!state.doneBlock_) {\n    state.doneBlock_ = true;\n    return new Interpreter.State(node.block, state.scope);\n  }\n  if (state.cv && state.cv.type === Interpreter.Completion.THROW &&\n      !state.doneHandler_ && node.handler) {\n    state.doneHandler_ = true;\n    // Create an new scope and add the error variable.\n    var scope = this.createSpecialScope(state.scope);\n    this.setProperty(scope.object, node.handler.param.name, state.cv.value);\n    state.cv = undefined;  // This error has been handled, don't rethrow.\n    // Execute catch clause.\n    return new Interpreter.State(node.handler.body, scope);\n  }\n  if (!state.doneFinalizer_ && node.finalizer) {\n    state.doneFinalizer_ = true;\n    return new Interpreter.State(node.finalizer, state.scope);\n  }\n  stack.pop();\n  if (state.cv) {\n    // There was no catch handler, or the catch/finally threw an error.\n    // Throw the error up to a higher try.\n    this.unwind(state.cv.type, state.cv.value, state.cv.label);\n  }\n};\n\nInterpreter.prototype['stepUnaryExpression'] = function(stack, state, node) {\n  if (!state.done_) {\n    state.done_ = true;\n    var nextState = new Interpreter.State(node.argument, state.scope);\n    nextState.components = node.operator === 'delete';\n    return nextState;\n  }\n  stack.pop();\n  var value = state.value;\n  switch (node.operator) {\n    case '-':\n      value = -value;\n      break;\n    case '+':\n      value = +value;\n      break;\n    case '!':\n      value = !value;\n      break;\n    case '~':\n      value = ~value;\n      break;\n    case 'delete':\n      var result = true;\n      // If value is not an array, then it is a primitive, or some other value.\n      // If so, skip the delete and return true.\n      if (Array.isArray(value)) {\n        var obj = value[0];\n        if (obj === Interpreter.SCOPE_REFERENCE) {\n          // `delete foo;` is the same as `delete window.foo;`.\n          obj = state.scope;\n        }\n        var name = String(value[1]);\n        try {\n          delete obj.properties[name];\n        } catch (_e) {\n          if (state.scope.strict) {\n            this.throwException(this.TYPE_ERROR, \"Cannot delete property '\" +\n                                name + \"' of '\" + obj + \"'\");\n          } else {\n            result = false;\n          }\n        }\n      }\n      value = result;\n      break;\n    case 'typeof':\n      value = (value && value.class === 'Function') ? 'function' : typeof value;\n      break;\n    case 'void':\n      value = undefined;\n      break;\n    default:\n      throw SyntaxError('Unknown unary operator: ' + node.operator);\n  }\n  stack[stack.length - 1].value = value;\n};\n\nInterpreter.prototype['stepUpdateExpression'] = function(stack, state, node) {\n  if (!state.doneLeft_) {\n    state.doneLeft_ = true;\n    var nextState = new Interpreter.State(node.argument, state.scope);\n    nextState.components = true;\n    return nextState;\n  }\n  if (!state.leftSide_) {\n    state.leftSide_ = state.value;\n  }\n  if (state.doneGetter_) {\n    state.leftValue_ = state.value;\n  }\n  if (!state.doneGetter_) {\n    var leftValue = this.getValue(state.leftSide_);\n    state.leftValue_ = leftValue;\n    if (this.getterStep_) {\n      // Call the getter function.\n      state.doneGetter_ = true;\n      var func = /** @type {!Interpreter.Object} */ (leftValue);\n      return this.createGetter_(func, state.leftSide_);\n    }\n  }\n  if (state.doneSetter_) {\n    // Return if setter function.\n    // Setter method on property has completed.\n    // Ignore its return value, and use the original set value instead.\n    stack.pop();\n    stack[stack.length - 1].value = state.setterValue_;\n    return;\n  }\n  var leftValue = Number(state.leftValue_);\n  var changeValue;\n  if (node.operator === '++') {\n    changeValue = leftValue + 1;\n  } else if (node.operator === '--') {\n    changeValue = leftValue - 1;\n  } else {\n    throw SyntaxError('Unknown update expression: ' + node.operator);\n  }\n  var returnValue = node.prefix ? changeValue : leftValue;\n  var setter = this.setValue(state.leftSide_, changeValue);\n  if (setter) {\n    state.doneSetter_ = true;\n    state.setterValue_ = returnValue;\n    return this.createSetter_(setter, state.leftSide_, changeValue);\n  }\n  // Return if no setter function.\n  stack.pop();\n  stack[stack.length - 1].value = returnValue;\n};\n\nInterpreter.prototype['stepVariableDeclaration'] = function(stack, state, node) {\n  // This step also handles all VariableDeclarator nodes, since these nodes can\n  // only appear inside the `declarations` array of a VariableDeclaration node.\n  var declarations = node.declarations;\n  var n = state.n_ || 0;\n  var declarationNode = declarations[n];\n  if (state.init_ && declarationNode) {\n    // This setValue call never needs to deal with calling a setter function.\n    // Note that this is setting the init value, not defining the variable.\n    // Variable definition is done when scope is populated.\n    this.setValueToScope(declarationNode.id.name, state.value);\n    state.init_ = false;\n    declarationNode = declarations[++n];\n  }\n  while (declarationNode) {\n    // Skip any declarations that are not initialized.  They have already\n    // been defined as undefined in populateScope_.\n    if (declarationNode.init) {\n      state.n_ = n;\n      state.init_ = true;\n      // When assigning an unnamed function to a variable, the function's name\n      // is set to the variable name.  Record the variable name in case the\n      // right side is a functionExpression.\n      // E.g. var foo = function() {};\n      state.destinationName = declarationNode.id.name;\n      return new Interpreter.State(declarationNode.init, state.scope);\n    }\n    declarationNode = declarations[++n];\n  }\n  stack.pop();\n};\n\nInterpreter.prototype['stepWithStatement'] = function(stack, state, node) {\n  if (!state.doneObject_) {\n    state.doneObject_ = true;\n    return new Interpreter.State(node.object, state.scope);\n  }\n  stack.pop();\n  var scope = this.createSpecialScope(state.scope, state.value);\n  return new Interpreter.State(node.body, scope);\n};\n\nInterpreter.prototype['stepWhileStatement'] =\n    Interpreter.prototype['stepDoWhileStatement'];\n\n// Preserve top-level API functions from being pruned/renamed by JS compilers.\n// Add others as needed.\nInterpreter.nativeGlobal['Interpreter'] = Interpreter;\nInterpreter.prototype['step'] = Interpreter.prototype.step;\nInterpreter.prototype['run'] = Interpreter.prototype.run;\nInterpreter.prototype['appendCode'] = Interpreter.prototype.appendCode;\nInterpreter.prototype['createObject'] = Interpreter.prototype.createObject;\nInterpreter.prototype['createObjectProto'] =\n    Interpreter.prototype.createObjectProto;\nInterpreter.prototype['createAsyncFunction'] =\n    Interpreter.prototype.createAsyncFunction;\nInterpreter.prototype['createNativeFunction'] =\n    Interpreter.prototype.createNativeFunction;\nInterpreter.prototype['getProperty'] = Interpreter.prototype.getProperty;\nInterpreter.prototype['setProperty'] = Interpreter.prototype.setProperty;\nInterpreter.prototype['getStatus'] = Interpreter.prototype.getStatus;\nInterpreter.prototype['nativeToPseudo'] = Interpreter.prototype.nativeToPseudo;\nInterpreter.prototype['pseudoToNative'] = Interpreter.prototype.pseudoToNative;\nInterpreter.prototype['getGlobalScope'] = Interpreter.prototype.getGlobalScope;\nInterpreter.prototype['setGlobalScope'] = Interpreter.prototype.setGlobalScope;\nInterpreter.prototype['getStateStack'] = Interpreter.prototype.getStateStack;\nInterpreter.prototype['setStateStack'] = Interpreter.prototype.setStateStack;\nInterpreter['VALUE_IN_DESCRIPTOR'] = Interpreter.VALUE_IN_DESCRIPTOR;\nInterpreter['Status'] = Interpreter.Status;\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = {\n  Interpreter\n};\n\n\n/***/ }),\n\n/***/ \"./original-repo/acorn.js\":\n/*!********************************!*\\\n  !*** ./original-repo/acorn.js ***!\n  \\********************************/\n/***/ (function(module, exports) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * @license\n * Copyright 2012 Marijn Haverbeke\n * SPDX-License-Identifier: MIT\n */\n\n// Acorn is a tiny, fast JavaScript parser written in JavaScript.\n//\n// Acorn was written by Marijn Haverbeke and released under an MIT\n// license. The Unicode regexps (for identifiers and whitespace) were\n// taken from [Esprima](http://esprima.org) by Ariya Hidayat.\n//\n// Git repositories for Acorn are available at\n//\n//     http://marijnhaverbeke.nl/git/acorn\n//     https://github.com/marijnh/acorn.git\n//\n// Please use the [github bug tracker][ghbt] to report issues.\n//\n// [ghbt]: https://github.com/marijnh/acorn/issues\n//\n// This file defines the main parser interface. The library also comes\n// with a [error-tolerant parser][dammit] and an\n// [abstract syntax tree walker][walk], defined in other files.\n//\n// [dammit]: acorn_loose.js\n// [walk]: util/walk.js\n\n(function(root, mod) {\n  if (true) return mod(exports); // CommonJS\n  if (true) return !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (mod),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); // AMD\n  mod(root.acorn || (root.acorn = {})); // Plain browser env\n})((typeof globalThis === 'undefined') ? this || window : globalThis, function(exports) {\n  \"use strict\";\n\n  exports.version = \"0.5.0\";\n  // Plus additional edits marked with 'JS-Interpreter change' comments.\n\n  // JS-Interpreter change:\n  // For global object, use 'globalThis' if it exists,\n  // fall back to 'this' or 'window'.  Same logic as in JS-Interpreter.\n  // -- Neil Fraser, March 2024.\n\n  // JS-Interpreter change:\n  // Added JSDoc type definitions.\n  // -- Neil Fraser, July 2023.\n\n  // JS-Interpreter change:\n  // No longer exporting defaultOptions, getLineInfo, tokenize, tokTypes,\n  // isIdentifierStart, and isIdentifierChar.  Not used by JS-Interpreter.\n  // -- Neil Fraser, February 2023.\n\n  // The main exported interface (under `self.acorn` when in the\n  // browser) is a `parse` function that takes a code string and\n  // returns an abstract syntax tree as specified by [Mozilla parser\n  // API][api], with the caveat that the SpiderMonkey-specific syntax\n  // (`let`, `yield`, inline XML, etc) is not recognized.\n  //\n  // [api]: https://developer.mozilla.org/en-US/docs/SpiderMonkey/Parser_API\n\n  /** @type {!Object|undefined} */\n  var options;\n\n  /** @type {string} */\n  var input = '';\n  /** @type {number|undefined} */\n  var inputLen;\n  /** @type {*} */\n  var sourceFile;\n\n  /**\n   * @param {string} inpt\n   * @param {Object=} opts\n   * @returns\n   */\n  exports.parse = function(inpt, opts) {\n    input = String(inpt);\n    inputLen = input.length;\n    setOptions(opts);\n    initTokenState();\n    return parseTopLevel(options.program);\n  };\n\n  // A second optional argument can be given to further configure\n  // the parser process. These options are recognized:\n\n  var defaultOptions = {\n    // JS-Interpreter change:\n    // `ecmaVersion` option has been removed along with all cases where\n    // it is checked.  In this version of Acorn it was limited to 3 or 5,\n    // and there's no use case for 3 with JS-Interpreter.\n    // -- Neil Fraser, December 2022.\n\n    // Turn on `strictSemicolons` to prevent the parser from doing\n    // automatic semicolon insertion.\n    strictSemicolons: false,\n    // When `allowTrailingCommas` is false, the parser will not allow\n    // trailing commas in array and object literals.\n    allowTrailingCommas: true,\n    // By default, reserved words are not enforced. Enable\n    // `forbidReserved` to enforce them. When this option has the\n    // value \"everywhere\", reserved words and keywords can also not be\n    // used as property names.\n    forbidReserved: false,\n    // When enabled, a return at the top level is not considered an\n    // error.\n    allowReturnOutsideFunction: false,\n    // When `locations` is on, `loc` properties holding objects with\n    // `start` and `end` properties in `{line, column}` form (with\n    // line being 1-based and column 0-based) will be attached to the\n    // nodes.\n    locations: false,\n    // A function can be passed as `onComment` option, which will\n    // cause Acorn to call that function with `(block, text, start,\n    // end)` parameters whenever a comment is skipped. `block` is a\n    // boolean indicating whether this is a block (`/* */`) comment,\n    // `text` is the content of the comment, and `start` and `end` are\n    // character offsets that denote the start and end of the comment.\n    // When the `locations` option is on, two more parameters are\n    // passed, the full `{line, column}` locations of the start and\n    // end of the comments. Note that you are not allowed to call the\n    // parser from the callback—that will corrupt its internal state.\n    onComment: null,\n    // Nodes have their start and end characters offsets recorded in\n    // `start` and `end` properties (directly on the node, rather than\n    // the `loc` object, which holds line/column data. To also add a\n    // [semi-standardized][range] `range` property holding a `[start,\n    // end]` array with the same numbers, set the `ranges` option to\n    // `true`.\n    //\n    // [range]: https://bugzilla.mozilla.org/show_bug.cgi?id=745678\n    ranges: false,\n    // It is possible to parse multiple files into a single AST by\n    // passing the tree produced by parsing the first file as\n    // `program` option in subsequent parses. This will add the\n    // toplevel forms of the parsed file to the `Program` (top) node\n    // of an existing parse tree.\n    program: null,\n    // When `locations` is on, you can pass this to record the source\n    // file in every node's `loc` object.\n    sourceFile: null,\n    // This value, if given, is stored in every node, whether\n    // `locations` is on or off.\n    directSourceFile: null,\n  };\n\n  /**\n   * @param {Object|undefined} opts\n   */\n  function setOptions(opts) {\n    options = opts || {};\n    for (var opt in defaultOptions) {\n      if (!Object.prototype.hasOwnProperty.call(options, opt)) {\n        options[opt] = defaultOptions[opt];\n      }\n    }\n    sourceFile = options.sourceFile;\n  }\n\n  /**\n   * The `getLineInfo` function is mostly useful when the\n   * `locations` option is off (for performance reasons) and you\n   * want to find the line/column position for a given character\n   * offset. `input` should be the code string that the offset refers\n   * into.\n   *\n   * @param {string} input\n   * @param {number} offset\n   * @returns {!Object}\n   */\n  var getLineInfo = function(input, offset) {\n    for (var line = 1, cur = 0;;) {\n      lineBreak.lastIndex = cur;\n      var match = lineBreak.exec(input);\n      if (match && match.index < offset) {\n        ++line;\n        cur = match.index + match[0].length;\n      } else {\n        break;\n      }\n    }\n    return {line: line, column: offset - cur};\n  };\n\n  // JS-Interpreter change:\n  // tokenize function never used.  Removed.\n  // -- Neil Fraser, February 2023.\n\n  // State is kept in (closure-)global variables. We already saw the\n  // `options`, `input`, and `inputLen` variables above.\n\n  /**\n   * The current position of the tokenizer in the input.\n   * @type {number}\n   */\n  var tokPos = 0;\n\n  /**\n   * The start offset of the current token.\n   * @type {number}\n   */\n  var tokStart = 0;\n\n  /**\n   * The end offset of the current token.\n   * @type {number}\n   */\n  var tokEnd = 0;\n\n  /**\n   * When `options.locations` is true, holds object\n   * containing the token's start line/column pairs.\n   * @type {!line_loc_t|undefined}\n   */\n  var tokStartLoc;\n\n  /**\n   * When `options.locations` is true, holds object\n   * containing the token's end line/column pairs.\n   * @type {!line_loc_t|undefined}\n   */\n  var tokEndLoc;\n\n  /**\n   * The type of the current token. Token types are objects,\n   * named by variables against which they can be compared, and\n   * holding properties that describe them (indicating, for example,\n   * the precedence of an infix operator, and the original name of a\n   * keyword token).\n   * @type {!Object|undefined}\n   */\n  var tokType;\n\n  /**\n   * The value of the current token. The kind of value that's held in\n   * `tokVal` depends on the type of the token. For literals, it is the\n   * literal value, for operators, the operator name, and so on.\n   * @type {*}\n   */\n  var tokVal;\n\n  /**\n   * Interal state for the tokenizer. To distinguish between division\n   * operators and regular expressions, it remembers whether the last\n   * token was one that is allowed to be followed by an expression.\n   * (If it is, a slash is probably a regexp, if it isn't it's a\n   * division operator. See the `parseStatement` function for a caveat.)\n   * @type {boolean|undefined}\n   */\n  var tokRegexpAllowed;\n\n  /**\n   * When `options.locations` is true, `tokCurLine` is used to keep\n   * track of the current line.\n   * @type {number|undefined}\n   */\n  var tokCurLine;\n\n  /**\n   * When `options.locations` is true, `tokLineStart` is used to know\n   * when a new line has been entered.\n   * @type {number|undefined}\n   */\n  var tokLineStart;\n\n  /**\n   * The start of the position of the previous token, which is useful\n   * when finishing a node and assigning its `end` position.\n   * @type {number}\n   */\n  var lastStart = 0;\n\n  /**\n   * The end oy the position of the previous token, which is useful\n   * when finishing a node and assigning its `end` position.\n   * @type {number}\n   */\n  var lastEnd = 0;\n\n  /**\n   * Stores the position of the previous token, which is useful\n   * when finishing a node and assigning its `end` position.\n   * @type {!line_loc_t|undefined}\n   */\n  var lastEndLoc;\n\n  /**\n   * `inFunction` is used to reject `return` statements outside of functions.\n   * @type {boolean|undefined}\n   */\n  var inFunction;\n\n  /**\n   * `labels` is used to verify that `break` and `continue` have somewhere\n   * to jump to.\n   * @type {!Array<!Object>|undefined}\n   */\n  var labels;\n\n  /**\n   * `strict` indicates whether strict mode is on.\n   * @type {boolean|undefined}\n   */\n  var strict;\n\n  /**\n   * This function is used to raise exceptions on parse errors. It\n   * takes an offset integer (into the current `input`) to indicate\n   * the location of the error, attaches the position to the end\n   * of the error message, and then raises a `SyntaxError` with that\n   * message.\n   *\n   * @param {number} pos\n   * @param {string} message\n   * @throws {SyntaxError}\n   */\n  function raise(pos, message) {\n    var loc = getLineInfo(input, pos);\n    message += \" (\" + loc.line + \":\" + loc.column + \")\";\n    var err = new SyntaxError(message);\n    err.pos = pos;\n    err.loc = loc;\n    err.raisedAt = tokPos;\n    throw err;\n  }\n\n  // Reused empty array added for node fields that are always empty.\n\n  var empty = [];\n\n  // ## Token types\n\n  // The assignment of fine-grained, information-carrying type objects\n  // allows the tokenizer to store the information it has about a\n  // token in a way that is very cheap for the parser to look up.\n\n  // All token type variables start with an underscore, to make them\n  // easy to recognize.\n\n  // These are the general types. The `type` property is only used to\n  // make them recognizeable when debugging.\n\n  var _num = {type: \"num\"};\n  var _regexp = {type: \"regexp\"};\n  var _string = {type: \"string\"};\n  var _name = {type: \"name\"};\n  var _eof = {type: \"eof\"};\n\n  // Keyword tokens. The `keyword` property (also used in keyword-like\n  // operators) indicates that the token originated from an\n  // identifier-like word, which is used when parsing property names.\n  //\n  // The `beforeExpr` property is used to disambiguate between regular\n  // expressions and divisions. It is set on all token types that can\n  // be followed by an expression (thus, a slash after them would be a\n  // regular expression).\n  //\n  // `isLoop` marks a keyword as starting a loop, which is important\n  // to know when parsing a label, in order to allow or disallow\n  // continue jumps to that label.\n\n  var _break = {keyword: \"break\"};\n  var _case = {keyword: \"case\", beforeExpr: true};\n  var _catch = {keyword: \"catch\"};\n  var _continue = {keyword: \"continue\"};\n  var _debugger = {keyword: \"debugger\"};\n  var _default = {keyword: \"default\"};\n  var _do = {keyword: \"do\", isLoop: true};\n  var _else = {keyword: \"else\", beforeExpr: true};\n  var _finally = {keyword: \"finally\"};\n  var _for = {keyword: \"for\", isLoop: true};\n  var _function = {keyword: \"function\"};\n  var _if = {keyword: \"if\"};\n  var _return = {keyword: \"return\", beforeExpr: true};\n  var _switch = {keyword: \"switch\"};\n  var _throw = {keyword: \"throw\", beforeExpr: true};\n  var _try = {keyword: \"try\"};\n  var _var = {keyword: \"var\"};\n  var _while = {keyword: \"while\", isLoop: true};\n  var _with = {keyword: \"with\"};\n  var _new = {keyword: \"new\", beforeExpr: true};\n  var _this = {keyword: \"this\"};\n\n  // The keywords that denote values.\n\n  var _null = {keyword: \"null\", atomValue: null};\n  var _true = {keyword: \"true\", atomValue: true};\n  var _false = {keyword: \"false\", atomValue: false};\n\n  // Some keywords are treated as regular operators. `in` sometimes\n  // (when parsing `for`) needs to be tested against specifically, so\n  // we assign a variable name to it for quick comparing.\n\n  var _in = {keyword: \"in\", binop: 7, beforeExpr: true};\n\n  // Map keyword names to token types.\n\n  var keywordTypes = {\n    \"break\": _break,\n    \"case\": _case,\n    \"catch\": _catch,\n    \"continue\": _continue,\n    \"debugger\": _debugger,\n    \"default\": _default,\n    \"do\": _do,\n    \"else\": _else,\n    \"finally\": _finally,\n    \"for\": _for,\n    \"function\": _function,\n    \"if\": _if,\n    \"return\": _return,\n    \"switch\": _switch,\n    \"throw\": _throw,\n    \"try\": _try,\n    \"var\": _var,\n    \"while\": _while,\n    \"with\": _with,\n    \"null\": _null,\n    \"true\": _true,\n    \"false\": _false,\n    \"new\": _new,\n    \"in\": _in,\n    \"instanceof\": {keyword: \"instanceof\", binop: 7, beforeExpr: true},\n    \"this\": _this,\n    \"typeof\": {keyword: \"typeof\", prefix: true, beforeExpr: true},\n    \"void\": {keyword: \"void\", prefix: true, beforeExpr: true},\n    \"delete\": {keyword: \"delete\", prefix: true, beforeExpr: true},\n  };\n\n  // Punctuation token types. Again, the `type` property is purely for debugging.\n\n  var _bracketL = {type: \"[\", beforeExpr: true};\n  var _bracketR = {type: \"]\"};\n  var _braceL = {type: \"{\", beforeExpr: true};\n  var _braceR = {type: \"}\"};\n  var _parenL = {type: \"(\", beforeExpr: true};\n  var _parenR = {type: \")\"};\n  var _comma = {type: \",\", beforeExpr: true};\n  var _semi = {type: \";\", beforeExpr: true};\n  var _colon = {type: \":\", beforeExpr: true};\n  var _dot = {type: \".\"};\n  var _question = {type: \"?\", beforeExpr: true};\n\n  // Operators. These carry several kinds of properties to help the\n  // parser use them properly (the presence of these properties is\n  // what categorizes them as operators).\n  //\n  // `binop`, when present, specifies that this operator is a binary\n  // operator, and will refer to its precedence.\n  //\n  // `prefix` and `postfix` mark the operator as a prefix or postfix\n  // unary operator. `isUpdate` specifies that the node produced by\n  // the operator should be of type UpdateExpression rather than\n  // simply UnaryExpression (`++` and `--`).\n  //\n  // `isAssign` marks all of `=`, `+=`, `-=` etcetera, which act as\n  // binary operators with a very low precedence, that should result\n  // in AssignmentExpression nodes.\n\n  var _slash = {binop: 10, beforeExpr: true};\n  var _eq = {isAssign: true, beforeExpr: true};\n  var _assign = {isAssign: true, beforeExpr: true};\n  var _incDec = {postfix: true, prefix: true, isUpdate: true};\n  var _prefix = {prefix: true, beforeExpr: true};\n  var _logicalOR = {binop: 1, beforeExpr: true};\n  var _logicalAND = {binop: 2, beforeExpr: true};\n  var _bitwiseOR = {binop: 3, beforeExpr: true};\n  var _bitwiseXOR = {binop: 4, beforeExpr: true};\n  var _bitwiseAND = {binop: 5, beforeExpr: true};\n  var _equality = {binop: 6, beforeExpr: true};\n  var _relational = {binop: 7, beforeExpr: true};\n  var _bitShift = {binop: 8, beforeExpr: true};\n  var _plusMin = {binop: 9, prefix: true, beforeExpr: true};\n  var _multiplyModulo = {binop: 10, beforeExpr: true};\n\n  // JS-Interpreter change:\n  // tokTypes map never used.  Removed.\n  // -- Neil Fraser, February 2023.\n\n  // JS-Interpreter change:\n  // Acorn's original code built up functions using strings for maximum efficiency.\n  // However, this triggered a CSP unsafe-eval requirement.  Here's a slower, but\n  // simpler approach.  -- Neil Fraser, January 2022.\n  // https://github.com/NeilFraser/JS-Interpreter/issues/228\n\n  /**\n   * @param {string} words\n   * @returns {function(*): boolean}\n   */\n  function makePredicate(words) {\n    var wordList = words.split(\" \");\n    var set = Object.create(null);\n    for (var i = 0; i < wordList.length; i++) {\n      set[wordList[i]] = true;\n    }\n    return function(str) {\n      return set[str] || false;\n    };\n  }\n\n  // ECMAScript 5 reserved words.\n\n  var isReservedWord5 = makePredicate(\"class enum extends super const export import\");\n\n  // The additional reserved words in strict mode.\n\n  var isStrictReservedWord = makePredicate(\"implements interface let package private protected public static yield\");\n\n  // The forbidden variable names in strict mode.\n\n  var isStrictBadIdWord = makePredicate(\"eval arguments\");\n\n  // And the keywords.\n\n  var isKeyword = makePredicate(\"break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this\");\n\n  // ## Character categories\n\n  // Big ugly regular expressions that match characters in the\n  // whitespace, identifier, and identifier-start categories. These\n  // are only applied when a character is found to actually have a\n  // code point above 128.\n\n  var nonASCIIwhitespace = /[\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]/;\n  var nonASCIIidentifierStartChars = \"\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\";\n  var nonASCIIidentifierChars = \"\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f\";\n  var nonASCIIidentifierStart = new RegExp(\"[\" + nonASCIIidentifierStartChars + \"]\");\n  var nonASCIIidentifier = new RegExp(\"[\" + nonASCIIidentifierStartChars + nonASCIIidentifierChars + \"]\");\n\n  // Whether a single character denotes a newline.\n\n  var newline = /[\\n\\r\\u2028\\u2029]/;\n\n  // Matches a whole line break (where CRLF is considered a single\n  // line break). Used to count lines.\n\n  var lineBreak = /\\r\\n|[\\n\\r\\u2028\\u2029]/g;\n\n  /**\n   * Test whether a given character code starts an identifier.\n   *\n   * @param {number} code\n   * @returns {boolean}\n   */\n  var isIdentifierStart = function(code) {\n    if (code < 65) return code === 36;\n    if (code < 91) return true;\n    if (code < 97) return code === 95;\n    if (code < 123) return true;\n    return code >= 0xaa && nonASCIIidentifierStart.test(String.fromCharCode(code));\n  };\n\n  /**\n   * Test whether a given character is part of an identifier.\n   *\n   * @param {number} code\n   * @returns {boolean}\n   */\n  var isIdentifierChar = function(code) {\n    if (code < 48) return code === 36;\n    if (code < 58) return true;\n    if (code < 65) return false;\n    if (code < 91) return true;\n    if (code < 97) return code === 95;\n    if (code < 123) return true;\n    return code >= 0xaa && nonASCIIidentifier.test(String.fromCharCode(code));\n  };\n\n  // ## Tokenizer\n\n  /**\n   * These are used when `options.locations` is on, for the\n   * `tokStartLoc` and `tokEndLoc` properties.\n   * @constructor\n   */\n  function line_loc_t() {\n    this.line = tokCurLine;\n    this.column = tokPos - tokLineStart;\n  }\n\n  /**\n   * Reset the token state. Used at the start of a parse.\n   */\n  function initTokenState() {\n    tokCurLine = 1;\n    tokPos = tokLineStart = 0;\n    tokRegexpAllowed = true;\n    skipSpace();\n  }\n\n  /**\n   * Called at the end of every token. Sets `tokEnd`, `tokVal`, and\n   * `tokRegexpAllowed`, and skips the space after the token, so that\n   * the next one's `tokStart` will point at the right position.\n   *\n   * @param {!Object} type\n   * @param {*=} val\n   */\n  function finishToken(type, val) {\n    tokEnd = tokPos;\n    if (options.locations) {\n      tokEndLoc = new line_loc_t();\n    }\n    tokType = type;\n    skipSpace();\n    tokVal = val;\n    tokRegexpAllowed = type.beforeExpr;\n  }\n\n  function skipBlockComment() {\n    var startLoc = options.onComment && options.locations && new line_loc_t();\n    var start = tokPos;\n    var end = input.indexOf(\"*/\", tokPos += 2);\n    if (end === -1) {\n      raise(tokPos - 2, \"Unterminated comment\");\n    }\n    tokPos = end + 2;\n    if (options.locations) {\n      lineBreak.lastIndex = start;\n      var match;\n      while ((match = lineBreak.exec(input)) && match.index < tokPos) {\n        ++tokCurLine;\n        tokLineStart = match.index + match[0].length;\n      }\n    }\n    if (options.onComment) {\n      options.onComment(true, input.slice(start + 2, end), start, tokPos,\n                        startLoc, options.locations && new line_loc_t());\n    }\n  }\n\n  function skipLineComment() {\n    var start = tokPos;\n    var startLoc = options.onComment && options.locations && new line_loc_t();\n    var ch = input.charCodeAt(tokPos += 2);\n    while (tokPos < inputLen && ch !== 10 && ch !== 13 && ch !== 8232 && ch !== 8233) {\n      ++tokPos;\n      ch = input.charCodeAt(tokPos);\n    }\n    if (options.onComment) {\n      options.onComment(false, input.slice(start + 2, tokPos), start, tokPos,\n                        startLoc, options.locations && new line_loc_t());\n    }\n  }\n\n  // Called at the start of the parse and after every token. Skips\n  // whitespace and comments, and.\n\n  function skipSpace() {\n    while (tokPos < inputLen) {\n      var ch = input.charCodeAt(tokPos);\n      if (ch === 32) { // ' '\n        ++tokPos;\n      } else if (ch === 13) {\n        ++tokPos;\n        var next = input.charCodeAt(tokPos);\n        if (next === 10) {\n          ++tokPos;\n        }\n        if (options.locations) {\n          ++tokCurLine;\n          tokLineStart = tokPos;\n        }\n      } else if (ch === 10 || ch === 8232 || ch === 8233) {\n        ++tokPos;\n        if (options.locations) {\n          ++tokCurLine;\n          tokLineStart = tokPos;\n        }\n      } else if (ch > 8 && ch < 14) {\n        ++tokPos;\n      } else if (ch === 47) { // '/'\n        var next = input.charCodeAt(tokPos + 1);\n        if (next === 42) { // '*'\n          skipBlockComment();\n        } else if (next === 47) { // '/'\n          skipLineComment();\n        } else break;\n      } else if (ch === 160) { // '\\xa0'\n        ++tokPos;\n      } else if (ch >= 5760 && nonASCIIwhitespace.test(String.fromCharCode(ch))) {\n        ++tokPos;\n      } else {\n        break;\n      }\n    }\n  }\n\n  // ### Token reading\n\n  // This is the function that is called to fetch the next token. It\n  // is somewhat obscure, because it works in character codes rather\n  // than characters, and because operator parsing has been inlined\n  // into it.\n  //\n  // All in the name of speed.\n  //\n  // The `forceRegexp` parameter is used in the one case where the\n  // `tokRegexpAllowed` trick does not work. See `parseStatement`.\n\n  function readToken_dot() {\n    var next = input.charCodeAt(tokPos + 1);\n    if (next >= 48 && next <= 57) {\n      readNumber(true);\n    } else {\n      ++tokPos;\n      finishToken(_dot);\n    }\n  }\n\n  function readToken_slash() {  // '/'\n    var next = input.charCodeAt(tokPos + 1);\n    if (tokRegexpAllowed) {\n      ++tokPos;\n      readRegexp();\n    } else if (next === 61) {\n      finishOp(_assign, 2);\n    } else {\n      finishOp(_slash, 1);\n    }\n  }\n\n  function readToken_mult_modulo() {  // '%*'\n    var next = input.charCodeAt(tokPos + 1);\n    if (next === 61) {\n      finishOp(_assign, 2);\n    } else {\n      finishOp(_multiplyModulo, 1);\n    }\n  }\n\n  /**\n   * @param {number} code\n   */\n  function readToken_pipe_amp(code) {  // '|&'\n    var next = input.charCodeAt(tokPos + 1);\n    if (next === code) {\n      finishOp(code === 124 ? _logicalOR : _logicalAND, 2);\n    } else if (next === 61) {\n      finishOp(_assign, 2);\n    } else {\n      finishOp(code === 124 ? _bitwiseOR : _bitwiseAND, 1);\n    }\n  }\n\n  function readToken_caret() {  // '^'\n    var next = input.charCodeAt(tokPos + 1);\n    if (next === 61) {\n      finishOp(_assign, 2);\n    } else {\n      finishOp(_bitwiseXOR, 1);\n    }\n  }\n\n  /**\n   * @param {number} code\n   */\n  function readToken_plus_min(code) {  // '+-'\n    var next = input.charCodeAt(tokPos + 1);\n    if (next === code) {\n      if (next === 45 && input.charCodeAt(tokPos + 2) === 62 &&\n          newline.test(input.slice(lastEnd, tokPos))) {\n        // A `-->` line comment\n        tokPos += 3;\n        skipLineComment();\n        skipSpace();\n        readToken();\n        return;\n      }\n      finishOp(_incDec, 2);\n    } else if (next === 61) {\n      finishOp(_assign, 2);\n    } else {\n      finishOp(_plusMin, 1);\n    }\n  }\n\n  /**\n   * @param {number} code\n   */\n  function readToken_lt_gt(code) {  // '<>'\n    var next = input.charCodeAt(tokPos + 1);\n    var size = 1;\n    if (next === code) {\n      size = (code === 62 && input.charCodeAt(tokPos + 2) === 62) ? 3 : 2;\n      if (input.charCodeAt(tokPos + size) === 61) {\n        finishOp(_assign, size + 1);\n      } else {\n        finishOp(_bitShift, size);\n      }\n      return;\n    }\n    if (next === 33 && code === 60 && input.charCodeAt(tokPos + 2) === 45 &&\n        input.charCodeAt(tokPos + 3) === 45) {\n      // `<!--`, an XML-style comment that should be interpreted as a line comment\n      tokPos += 4;\n      skipLineComment();\n      skipSpace();\n      readToken();\n      return;\n    }\n    if (next === 61) {\n      size = input.charCodeAt(tokPos + 2) === 61 ? 3 : 2;\n    }\n    finishOp(_relational, size);\n  }\n\n  /**\n   * @param {number} code\n   */\n  function readToken_eq_excl(code) {  // '=!'\n    var next = input.charCodeAt(tokPos + 1);\n    if (next === 61) {\n      finishOp(_equality, input.charCodeAt(tokPos + 2) === 61 ? 3 : 2);\n    } else {\n      finishOp(code === 61 ? _eq : _prefix, 1);\n    }\n  }\n\n  /**\n   * @param {number} code\n   * @returns {boolean|undefined}\n   */\n  function getTokenFromCode(code) {\n    switch(code) {\n      // The interpretation of a dot depends on whether it is followed\n      // by a digit.\n      case 46: // '.'\n        return readToken_dot();\n\n        // Punctuation tokens.\n      case 40:  ++tokPos; return finishToken(_parenL);\n      case 41:  ++tokPos; return finishToken(_parenR);\n      case 59:  ++tokPos; return finishToken(_semi);\n      case 44:  ++tokPos; return finishToken(_comma);\n      case 91:  ++tokPos; return finishToken(_bracketL);\n      case 93:  ++tokPos; return finishToken(_bracketR);\n      case 123: ++tokPos; return finishToken(_braceL);\n      case 125: ++tokPos; return finishToken(_braceR);\n      case 58:  ++tokPos; return finishToken(_colon);\n      case 63:  ++tokPos; return finishToken(_question);\n\n        // '0x' is a hexadecimal number.\n      case 48: // '0'\n        var next = input.charCodeAt(tokPos + 1);\n        if (next === 120 || next === 88) return readHexNumber();\n        // Anything else beginning with a digit is an integer, octal\n        // number, or float.\n      case 49: case 50: case 51: case 52: case 53: case 54: case 55: case 56: case 57: // 1-9\n        return readNumber(false);\n\n        // Quotes produce strings.\n      case 34: case 39: // '\"', \"'\"\n        return readString(code);\n\n      // Operators are parsed inline in tiny state machines. '=' (61) is\n      // often referred to. `finishOp` simply skips the amount of\n      // characters it is given as second argument, and returns a token\n      // of the type given by its first argument.\n\n      case 47: // '/'\n        return readToken_slash();\n\n      case 37: case 42: // '%*'\n        return readToken_mult_modulo();\n\n      case 124: case 38: // '|&'\n        return readToken_pipe_amp(code);\n\n      case 94: // '^'\n        return readToken_caret();\n\n      case 43: case 45: // '+-'\n        return readToken_plus_min(code);\n\n      case 60: case 62: // '<>'\n        return readToken_lt_gt(code);\n\n      case 61: case 33: // '=!'\n        return readToken_eq_excl(code);\n\n      case 126: // '~'\n        return finishOp(_prefix, 1);\n    }\n\n    return false;\n  }\n\n  /**\n   * @param {boolean=} forceRegexp\n   */\n  function readToken(forceRegexp) {\n    if (!forceRegexp) {\n      tokStart = tokPos;\n    } else {\n      tokPos = tokStart + 1;\n    }\n    if (options.locations) {\n      tokStartLoc = new line_loc_t();\n    }\n    if (forceRegexp) return readRegexp();\n    if (tokPos >= inputLen) return finishToken(_eof);\n\n    var code = input.charCodeAt(tokPos);\n    // Identifier or keyword. '\\uXXXX' sequences are allowed in\n    // identifiers, so '\\' also dispatches to that.\n    if (isIdentifierStart(code) || code === 92) {  // '\\'\n      return readWord();\n    }\n\n    var tok = getTokenFromCode(code);\n\n    if (tok === false) {\n      // If we are here, we either found a non-ASCII identifier\n      // character, or something that's entirely disallowed.\n      var ch = String.fromCharCode(code);\n      if (ch === \"\\\\\" || nonASCIIidentifierStart.test(ch)) {\n        return readWord();\n      }\n      raise(tokPos, \"Unexpected character '\" + ch + \"'\");\n    }\n  }\n\n  /**\n   * @param {!Object} type\n   * @param {number} size\n   */\n  function finishOp(type, size) {\n    var str = input.slice(tokPos, tokPos + size);\n    tokPos += size;\n    finishToken(type, str);\n  }\n\n  /**\n   * Parse a regular expression. Some context-awareness is necessary,\n   * since a '/' inside a '[]' set does not end the expression.\n   */\n  function readRegexp() {\n    // JS-Interpreter change:\n    // Removed redundant declaration of 'content' here.  Caused lint errors.\n    // -- Neil Fraser, June 2022.\n    var escaped;\n    var inClass;\n    var start = tokPos;\n    for (;;) {\n      if (tokPos >= inputLen) raise(start, \"Unterminated regexp\");\n      var ch = input.charAt(tokPos);\n      if (newline.test(ch)) raise(start, \"Unterminated regexp\");\n      if (!escaped) {\n        if (ch === \"[\") {\n          inClass = true;\n        } else if (ch === \"]\" && inClass) {\n          inClass = false;\n        } else if (ch === \"/\" && !inClass) {\n          break;\n        }\n        escaped = ch === \"\\\\\";\n      } else escaped = false;\n      ++tokPos;\n    }\n    var content = input.slice(start, tokPos);\n    ++tokPos;\n    // Need to use `readWord1` because '\\uXXXX' sequences are allowed\n    // here (don't ask).\n    var mods = readWord1();\n    // JS-Interpreter change:\n    // Acorn used to use 'gmsiy' to check for flags.  But 's' and 'y' are ES6.\n    // -- Neil Fraser, December 2022.\n    // https://github.com/acornjs/acorn/issues/1163\n    if (mods && !/^[gmi]*$/.test(mods)) {\n      raise(start, \"Invalid regexp flag\");\n    }\n    try {\n      var value = new RegExp(content, mods);\n    } catch (e) {\n      if (e instanceof SyntaxError) raise(start, e.message);\n      // JS-Interpreter change:\n      // Acorn used to use raise(e) here which is incorrect.\n      // -- Neil Fraser, July 2023.\n      throw(e);\n    }\n    finishToken(_regexp, value);\n  }\n\n  /**\n   * Read an integer in the given radix. Return null if zero digits\n   * were read, the integer value otherwise. When `len` is given, this\n   * will return `null` unless the integer has exactly `len` digits.\n   * @param {number} radix\n   * @param {number=} len\n   * @returns {?number}\n   */\n  function readInt(radix, len) {\n    var start = tokPos;\n    var total = 0;\n    var e = (len === undefined) ? Infinity : len;\n    for (var i = 0; i < e; ++i) {\n      var code = input.charCodeAt(tokPos), val;\n      if (code >= 97) {\n        val = code - 97 + 10; // a\n      } else if (code >= 65) {\n        val = code - 65 + 10; // A\n      } else if (code >= 48 && code <= 57) {\n        val = code - 48; // 0-9\n      } else {\n        val = Infinity;\n      }\n      if (val >= radix) break;\n      ++tokPos;\n      total = total * radix + val;\n    }\n    if (tokPos === start || len !== undefined && tokPos - start !== len) {\n      return null;\n    }\n    return total;\n  }\n\n  function readHexNumber() {\n    tokPos += 2; // 0x\n    var val = readInt(16);\n    if (val === null) {\n      raise(tokStart + 2, \"Expected hexadecimal number\");\n    }\n    if (isIdentifierStart(input.charCodeAt(tokPos))) {\n      raise(tokPos, \"Identifier directly after number\");\n    }\n    finishToken(_num, val);\n  }\n\n  /**\n   * Read an integer, octal integer, or floating-point number.\n   *\n   * @param {boolean} startsWithDot\n   */\n  function readNumber(startsWithDot) {\n    var start = tokPos;\n    var isFloat = false;\n    var octal = input.charCodeAt(tokPos) === 48;\n    if (!startsWithDot && readInt(10) === null) {\n      raise(start, \"Invalid number\");\n    }\n    if (input.charCodeAt(tokPos) === 46) {\n      ++tokPos;\n      readInt(10);\n      isFloat = true;\n    }\n    var next = input.charCodeAt(tokPos);\n    if (next === 69 || next === 101) { // 'eE'\n      next = input.charCodeAt(++tokPos);\n      if (next === 43 || next === 45) {\n        ++tokPos; // '+-'\n      }\n      if (readInt(10) === null) {\n        raise(start, \"Invalid number\");\n      }\n      isFloat = true;\n    }\n    if (isIdentifierStart(input.charCodeAt(tokPos))) {\n      raise(tokPos, \"Identifier directly after number\");\n    }\n\n    var str = input.slice(start, tokPos);\n    var val;\n    if (isFloat) {\n      val = parseFloat(str);\n    } else if (!octal || str.length === 1) {\n      val = parseInt(str, 10);\n    } else if (/[89]/.test(str) || strict) {\n      raise(start, \"Invalid number\");\n    } else {\n      val = parseInt(str, 8);\n    }\n    finishToken(_num, val);\n  }\n\n  /**\n   * Read a string value, interpreting backslash-escapes.\n   *\n   * @param {number} quote\n   */\n  function readString(quote) {\n    tokPos++;\n    var out = \"\";\n    for (;;) {\n      if (tokPos >= inputLen) raise(tokStart, \"Unterminated string constant\");\n      var ch = input.charCodeAt(tokPos);\n      if (ch === quote) {\n        ++tokPos;\n        finishToken(_string, out);\n        return;\n      }\n      if (ch === 92) { // '\\'\n        ch = input.charCodeAt(++tokPos);\n        var octal = /^[0-7]+/.exec(input.slice(tokPos, tokPos + 3));\n        if (octal) {\n          octal = octal[0];\n        }\n        while (octal && parseInt(octal, 8) > 255) {\n          octal = octal.slice(0, -1);\n        }\n        if (octal === \"0\") {\n          octal = null;\n        }\n        ++tokPos;\n        if (octal) {\n          if (strict) raise(tokPos - 2, \"Octal literal in strict mode\");\n          out += String.fromCharCode(parseInt(octal, 8));\n          tokPos += octal.length - 1;\n        } else {\n          switch (ch) {\n            case 110: out += \"\\n\"; break; // 'n' -> '\\n'\n            case 114: out += \"\\r\"; break; // 'r' -> '\\r'\n            case 120: out += String.fromCharCode(readHexChar(2)); break; // 'x'\n            case 117: out += String.fromCharCode(readHexChar(4)); break; // 'u'\n            case 85: out += String.fromCharCode(readHexChar(8)); break; // 'U'\n            case 116: out += \"\\t\"; break; // 't' -> '\\t'\n            case 98: out += \"\\b\"; break; // 'b' -> '\\b'\n            case 118: out += \"\\u000b\"; break; // 'v' -> '\\u000b'\n            case 102: out += \"\\f\"; break; // 'f' -> '\\f'\n            case 48: out += \"\\0\"; break; // 0 -> '\\0'\n            case 13:  // '\\r'\n              if (input.charCodeAt(tokPos) === 10) {\n                ++tokPos; // '\\r\\n'\n              }\n            case 10: // ' \\n'\n              if (options.locations) {\n                tokLineStart = tokPos;\n                ++tokCurLine;\n              }\n              break;\n            default: out += String.fromCharCode(ch); break;\n          }\n        }\n      } else {\n        if (ch === 13 || ch === 10 || ch === 8232 || ch === 8233) {\n          raise(tokStart, \"Unterminated string constant\");\n        }\n        out += String.fromCharCode(ch); // '\\'\n        ++tokPos;\n      }\n    }\n  }\n\n  /**\n   * Used to read character escape sequences ('\\x', '\\u', '\\U').\n   *\n   * @param {number} len\n   * @returns {number}\n   */\n  function readHexChar(len) {\n    var n = readInt(16, len);\n    if (n === null) raise(tokStart, \"Bad character escape sequence\");\n    return /** @type {number} */(n);\n  }\n\n  // Used to signal to callers of `readWord1` whether the word\n  // contained any escape sequences. This is needed because words with\n  // escape sequences must not be interpreted as keywords.\n\n  /** @type {boolean|undefined} */\n  var containsEsc;\n\n  /**\n   * Read an identifier, and return it as a string. Sets `containsEsc`\n   * to whether the word contained a '\\u' escape.\n   *\n   * Only builds up the word character-by-character when it actually\n   * containeds an escape, as a micro-optimization.\n   *\n   * @returns {string|undefined}\n   */\n  function readWord1() {\n    containsEsc = false;\n    var word;\n    var first = true;\n    var start = tokPos;\n    for (;;) {\n      var ch = input.charCodeAt(tokPos);\n      if (isIdentifierChar(ch)) {\n        if (containsEsc) {\n          word += input.charAt(tokPos);\n        }\n        ++tokPos;\n      } else if (ch === 92) { // \"\\\"\n        if (!containsEsc) {\n          word = input.slice(start, tokPos);\n        }\n        containsEsc = true;\n        if (input.charCodeAt(++tokPos) !== 117) { // \"u\"\n          raise(tokPos, \"Expecting Unicode escape sequence \\\\uXXXX\");\n        }\n        ++tokPos;\n        var esc = readHexChar(4);\n        var escStr = String.fromCharCode(esc);\n        if (!escStr) raise(tokPos - 1, \"Invalid Unicode escape\");\n        if (!(first ? isIdentifierStart(esc) : isIdentifierChar(esc))) {\n          raise(tokPos - 4, \"Invalid Unicode escape\");\n        }\n        word += escStr;\n      } else {\n        break;\n      }\n      first = false;\n    }\n    return containsEsc ? word : input.slice(start, tokPos);\n  }\n\n  /**\n   * Read an identifier or keyword token. Will check for reserved\n   * words when necessary.\n   */\n  function readWord() {\n    var word = readWord1();\n    var type = _name;\n    if (!containsEsc && isKeyword(word)) {\n      type = keywordTypes[word];\n    }\n    finishToken(type, word);\n  }\n\n  // ## Parser\n\n  // A recursive descent parser operates by defining functions for all\n  // syntactic elements, and recursively calling those, each function\n  // advancing the input stream and returning an AST node. Precedence\n  // of constructs (for example, the fact that `!x[1]` means `!(x[1])`\n  // instead of `(!x)[1]` is handled by the fact that the parser\n  // function that parses unary prefix operators is called first, and\n  // in turn calls the function that parses `[]` subscripts — that\n  // way, it'll receive the node for `x[1]` already parsed, and wraps\n  // *that* in the unary operator node.\n  //\n  // Acorn uses an [operator precedence parser][opp] to handle binary\n  // operator precedence, because it is much more compact than using\n  // the technique outlined above, which uses different, nesting\n  // functions to specify precedence, for all of the ten binary\n  // precedence levels that JavaScript defines.\n  //\n  // [opp]: http://en.wikipedia.org/wiki/Operator-precedence_parser\n\n  // ### Parser utilities\n\n  /**\n   * Continue to the next token.\n   */\n  function next() {\n    lastStart = tokStart;\n    lastEnd = tokEnd;\n    lastEndLoc = tokEndLoc;\n    readToken();\n  }\n\n  /**\n   * Enter strict mode. Re-reads the next token to please pedantic\n   * tests (\"use strict\"; 010; -- should fail).\n   *\n   * @param {boolean} strct\n   */\n  function setStrict(strct) {\n    strict = strct;\n    tokPos = tokStart;\n    if (options.locations) {\n      while (tokPos < tokLineStart) {\n        tokLineStart = input.lastIndexOf(\"\\n\", tokLineStart - 2) + 1;\n        --tokCurLine;\n      }\n    }\n    skipSpace();\n    readToken();\n  }\n\n  // Start an AST node, attaching a start offset.\n\n  /**\n   * @constructor\n   */\n  function node_t() {\n    this.type = null;\n    this.start = tokStart;\n    this.end = null;\n  }\n\n  /**\n   * @constructor\n   */\n  function node_loc_t() {\n    this.start = tokStartLoc;\n    this.end = null;\n    if (sourceFile) {\n      this.source = sourceFile;\n    }\n  }\n\n  /**\n   * @returns {!node_t}\n   */\n  function startNode() {\n    var node = new node_t();\n    if (options.locations) {\n      node.loc = new node_loc_t();\n    }\n    if (options.directSourceFile) {\n      node.sourceFile = options.directSourceFile;\n    }\n    if (options.ranges) {\n      node.range = [tokStart, 0];\n    }\n    return node;\n  }\n\n  /**\n   * Start a node whose start offset information should be based on\n   * the start of another node. For example, a binary operator node is\n   * only started after its left-hand side has already been parsed.\n   *\n   * @param {!node_t} other\n   * @returns {!node_t}\n   */\n  function startNodeFrom(other) {\n    var node = new node_t();\n    node.start = other.start;\n    if (options.locations) {\n      node.loc = new node_loc_t();\n      node.loc.start = other.loc.start;\n    }\n    if (options.ranges) {\n      node.range = [other.range[0], 0];\n    }\n    return node;\n  }\n\n  /**\n   * Finish an AST node, adding `type` and `end` properties.\n   *\n   * @param {!node_t} node\n   * @param {string} type\n   * @returns {!node_t}\n   */\n  function finishNode(node, type) {\n    node.type = type;\n    node.end = lastEnd;\n    if (options.locations) {\n      node.loc.end = lastEndLoc;\n    }\n    if (options.ranges) {\n      node.range[1] = lastEnd;\n    }\n    return node;\n  }\n\n  /**\n   * Test whether a statement node is the string literal `\"use strict\"`.\n   *\n   * @param {!node_t} stmt\n   * @returns {boolean}\n   */\n  function isUseStrict(stmt) {\n    return stmt.type === \"ExpressionStatement\" &&\n        stmt.expression.type === \"Literal\" &&\n        stmt.expression.value === \"use strict\";\n  }\n\n  /**\n   * Predicate that tests whether the next token is of the given\n   * type, and if yes, consumes it as a side effect.\n   * @param {!Object} type\n   * @returns {boolean}\n   */\n  function eat(type) {\n    if (tokType === type) {\n      next();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Test whether a semicolon can be inserted at the current position.\n   *\n   * @returns {boolean}\n   */\n  function canInsertSemicolon() {\n    return !options.strictSemicolons &&\n        (tokType === _eof || tokType === _braceR ||\n         newline.test(input.slice(lastEnd, tokStart)));\n  }\n\n  /**\n   * Consume a semicolon, or, failing that, see if we are allowed to\n   * pretend that there is a semicolon at this position.\n   */\n  function semicolon() {\n    if (!eat(_semi) && !canInsertSemicolon()) {\n      unexpected();\n    }\n  }\n\n  /**\n   * Expect a token of a given type.  If found, consume it, otherwise,\n   * raise an unexpected token error.\n   *\n   * @param {!Object} type\n   */\n  function expect(type) {\n    if (tokType === type) {\n      next();\n    } else {\n      unexpected();\n    }\n  }\n\n  /**\n   * Raise an unexpected token error.\n   * @throws {SyntaxError}\n   */\n  function unexpected() {\n    raise(tokStart, \"Unexpected token\");\n  }\n\n  /**\n   * Verify that a node is an lval — something that can be assigned to.\n   *\n   * @param {!node_t} expr\n   */\n  function checkLVal(expr) {\n    if (expr.type !== \"Identifier\" && expr.type !== \"MemberExpression\") {\n      raise(expr.start, \"Assigning to rvalue\");\n    }\n    if (strict && expr.type === \"Identifier\" && isStrictBadIdWord(expr.name)) {\n      raise(expr.start, \"Assigning to \" + expr.name + \" in strict mode\");\n    }\n  }\n\n  // ### Statement parsing\n\n  /**\n   * Parse a program. Initializes the parser, reads any number of\n   * statements, and wraps them in a Program node.  Optionally takes a\n   * `program` argument.  If present, the statements will be appended\n   * to its body instead of creating a new node.\n   *\n   * @param {node_t} program\n   * @returns {!node_t}\n   */\n  function parseTopLevel(program) {\n    lastStart = lastEnd = tokPos;\n    if (options.locations) {\n      lastEndLoc = new line_loc_t();\n    }\n    inFunction = strict = false;\n    labels = [];\n    readToken();\n\n    var node = program || startNode();\n    var first = true;\n    if (!program) {\n      node.body = [];\n    }\n    while (tokType !== _eof) {\n      var stmt = parseStatement();\n      node.body.push(stmt);\n      if (first && isUseStrict(stmt)) {\n        setStrict(true);\n      }\n      first = false;\n    }\n    return finishNode(node, \"Program\");\n  }\n\n  var loopLabel = {kind: \"loop\"};\n  var switchLabel = {kind: \"switch\"};\n\n  /**\n   * Parse a single statement.\n   *\n   * If expecting a statement and finding a slash operator, parse a\n   * regular expression literal. This is to handle cases like\n   * `if (foo) /blah/.exec(foo);`, where looking at the previous token\n   * does not help.\n   *\n   * @returns {!node_t}\n   */\n  function parseStatement() {\n    if (tokType === _slash || tokType === _assign && tokVal === \"/=\") {\n      readToken(true);\n    }\n\n    var starttype = tokType;\n    var node = startNode();\n\n    // Most types of statements are recognized by the keyword they\n    // start with. Many are trivial to parse, some require a bit of\n    // complexity.\n\n    switch (starttype) {\n      case _break: case _continue:\n        next();\n        var isBreak = starttype === _break;\n        if (eat(_semi) || canInsertSemicolon()) {\n          node.label = null;\n        } else if (tokType !== _name) {\n          unexpected();\n        } else {\n          node.label = parseIdent();\n          semicolon();\n        }\n\n        // Verify that there is an actual destination to break or\n        // continue to.\n        for (var i = 0; i < labels.length; ++i) {\n          var lab = labels[i];\n          if (node.label === null || lab.name === node.label.name) {\n            if (lab.kind !== null && (isBreak || lab.kind === \"loop\")) break;\n            if (node.label && isBreak) break;\n          }\n        }\n        if (i === labels.length) {\n          raise(node.start, \"Unsyntactic \" + starttype.keyword);\n        }\n        return finishNode(node, isBreak ? \"BreakStatement\" : \"ContinueStatement\");\n\n      case _debugger:\n        next();\n        semicolon();\n        return finishNode(node, \"DebuggerStatement\");\n\n      case _do:\n        next();\n        labels.push(loopLabel);\n        node.body = parseStatement();\n        labels.pop();\n        expect(_while);\n        node.test = parseParenExpression();\n        semicolon();\n        return finishNode(node, \"DoWhileStatement\");\n\n        // Disambiguating between a `for` and a `for`/`in` loop is\n        // non-trivial. Basically, we have to parse the init `var`\n        // statement or expression, disallowing the `in` operator (see\n        // the second parameter to `parseExpression`), and then check\n        // whether the next token is `in`. When there is no init part\n        // (semicolon immediately after the opening parenthesis), it is\n        // a regular `for` loop.\n\n      case _for:\n        next();\n        labels.push(loopLabel);\n        expect(_parenL);\n        if (tokType === _semi) return parseFor(node, null);\n        if (tokType === _var) {\n          var init = startNode();\n          next();\n          parseVar(init, true);\n          finishNode(init, \"VariableDeclaration\");\n          if (init.declarations.length === 1 && eat(_in))\n            return parseForIn(node, init);\n          return parseFor(node, init);\n        }\n        var init = parseExpression(false, true);\n        if (eat(_in)) {\n          checkLVal(init);\n          return parseForIn(node, init);\n        }\n        return parseFor(node, init);\n\n      case _function:\n        next();\n        return parseFunction(node, true);\n\n      case _if:\n        next();\n        node.test = parseParenExpression();\n        node.consequent = parseStatement();\n        node.alternate = eat(_else) ? parseStatement() : null;\n        return finishNode(node, \"IfStatement\");\n\n      case _return:\n        if (!inFunction && !options.allowReturnOutsideFunction) {\n          raise(tokStart, \"'return' outside of function\");\n        }\n        next();\n\n        // In `return` (and `break`/`continue`), the keywords with\n        // optional arguments, we eagerly look for a semicolon or the\n        // possibility to insert one.\n\n        if (eat(_semi) || canInsertSemicolon()) {\n          node.argument = null;\n        } else {\n          node.argument = parseExpression();\n          semicolon();\n        }\n        return finishNode(node, \"ReturnStatement\");\n\n      case _switch:\n        next();\n        node.discriminant = parseParenExpression();\n        node.cases = [];\n        expect(_braceL);\n        labels.push(switchLabel);\n\n        // Statements under must be grouped (by label) in SwitchCase\n        // nodes. `cur` is used to keep the node that we are currently\n        // adding statements to.\n\n        for (var cur, sawDefault; tokType !== _braceR;) {\n          if (tokType === _case || tokType === _default) {\n            var isCase = tokType === _case;\n            if (cur) {\n              finishNode(cur, \"SwitchCase\");\n            }\n            node.cases.push(cur = startNode());\n            cur.consequent = [];\n            next();\n            if (isCase) {\n              cur.test = parseExpression();\n            } else {\n              if (sawDefault) {\n                raise(lastStart, \"Multiple default clauses\");\n              }\n              sawDefault = true;\n              cur.test = null;\n            }\n            expect(_colon);\n          } else {\n            if (!cur) unexpected();\n            cur.consequent.push(parseStatement());\n          }\n        }\n        if (cur) finishNode(cur, \"SwitchCase\");\n        next(); // Closing brace\n        labels.pop();\n        return finishNode(node, \"SwitchStatement\");\n\n      case _throw:\n        next();\n        if (newline.test(input.slice(lastEnd, tokStart)))\n          raise(lastEnd, \"Illegal newline after throw\");\n        node.argument = parseExpression();\n        semicolon();\n        return finishNode(node, \"ThrowStatement\");\n\n      case _try:\n        next();\n        node.block = parseBlock();\n        node.handler = null;\n        if (tokType === _catch) {\n          var clause = startNode();\n          next();\n          expect(_parenL);\n          clause.param = parseIdent();\n          if (strict && isStrictBadIdWord(clause.param.name))\n            raise(clause.param.start, \"Binding \" + clause.param.name + \" in strict mode\");\n          expect(_parenR);\n          // JS-Interpreter change:\n          // Obsolete unused property; commenting out.\n          // -- Neil Fraser, January 2023.\n          // clause.guard = null;\n          clause.body = parseBlock();\n          node.handler = finishNode(clause, \"CatchClause\");\n        }\n        // JS-Interpreter change:\n        // Obsolete unused property; commenting out.\n        // -- Neil Fraser, January 2023.\n        // node.guardedHandlers = empty;\n        node.finalizer = eat(_finally) ? parseBlock() : null;\n        if (!node.handler && !node.finalizer)\n          raise(node.start, \"Missing catch or finally clause\");\n        return finishNode(node, \"TryStatement\");\n\n      case _var:\n        next();\n        parseVar(node);\n        semicolon();\n        return finishNode(node, \"VariableDeclaration\");\n\n      case _while:\n        next();\n        node.test = parseParenExpression();\n        labels.push(loopLabel);\n        node.body = parseStatement();\n        labels.pop();\n        return finishNode(node, \"WhileStatement\");\n\n      case _with:\n        if (strict) raise(tokStart, \"'with' in strict mode\");\n        next();\n        node.object = parseParenExpression();\n        node.body = parseStatement();\n        return finishNode(node, \"WithStatement\");\n\n      case _braceL:\n        return parseBlock();\n\n      case _semi:\n        next();\n        return finishNode(node, \"EmptyStatement\");\n\n      // If the statement does not start with a statement keyword or a\n      // brace, it's an ExpressionStatement or LabeledStatement. We\n      // simply start parsing an expression, and afterwards, if the\n      // next token is a colon and the expression was a simple\n      // Identifier node, we switch to interpreting it as a label.\n      default:\n        var maybeName = tokVal;\n        var expr = parseExpression();\n        if (starttype === _name && expr.type === \"Identifier\" && eat(_colon)) {\n          for (var i = 0; i < labels.length; ++i) {\n            if (labels[i].name === maybeName) {\n              raise(expr.start, \"Label '\" + maybeName + \"' is already declared\");\n            }\n          }\n          var kind = tokType.isLoop ? \"loop\" :\n              (tokType === _switch ? \"switch\" : null);\n          labels.push({name: maybeName, kind: kind});\n          node.body = parseStatement();\n          labels.pop();\n          node.label = expr;\n          return finishNode(node, \"LabeledStatement\");\n        } else {\n          node.expression = expr;\n          semicolon();\n          return finishNode(node, \"ExpressionStatement\");\n        }\n    }\n  }\n\n  /**\n   * Used for constructs like `switch` and `if` that insist on\n   * parentheses around their expression.\n   *\n   * @returns {!node_t}\n   */\n  function parseParenExpression() {\n    expect(_parenL);\n    var val = parseExpression();\n    expect(_parenR);\n    return val;\n  }\n\n  /**\n   * Parse a semicolon-enclosed block of statements, handling `\"use\n   * strict\"` declarations when `allowStrict` is true (used for\n   * function bodies).\n   *\n   * @param {boolean=} allowStrict\n   * @returns {!node_t}\n   */\n  function parseBlock(allowStrict) {\n    var node = startNode();\n    var first = true;\n    var strict = false;\n    var oldStrict;\n    node.body = [];\n    expect(_braceL);\n    while (!eat(_braceR)) {\n      var stmt = parseStatement();\n      node.body.push(stmt);\n      if (first && allowStrict && isUseStrict(stmt)) {\n        oldStrict = strict;\n        setStrict(strict = true);\n      }\n      first = false;\n    }\n    if (strict && !oldStrict) setStrict(false);\n    return finishNode(node, \"BlockStatement\");\n  }\n\n  /**\n   * Parse a regular `for` loop. The disambiguation code in `parseStatement`\n   * will already have parsed the init statement or expression.\n   *\n   * @param {!node_t} node\n   * @param {node_t} init\n   * @returns {!node_t}\n   */\n  function parseFor(node, init) {\n    node.init = init;\n    expect(_semi);\n    node.test = tokType === _semi ? null : parseExpression();\n    expect(_semi);\n    node.update = tokType === _parenR ? null : parseExpression();\n    expect(_parenR);\n    node.body = parseStatement();\n    labels.pop();\n    return finishNode(node, \"ForStatement\");\n  }\n\n  /**\n   * Parse a `for`/`in` loop.\n   *\n   * @param {!node_t} node\n   * @param {!node_t} init\n   * @returns {!node_t}\n   */\n  function parseForIn(node, init) {\n    node.left = init;\n    node.right = parseExpression();\n    expect(_parenR);\n    node.body = parseStatement();\n    labels.pop();\n    return finishNode(node, \"ForInStatement\");\n  }\n\n  /**\n   * Parse a list of variable declarations.\n   *\n   * @param {!node_t} node\n   * @param {boolean=} noIn\n   */\n  function parseVar(node, noIn) {\n    node.declarations = [];\n    node.kind = \"var\";\n    for (;;) {\n      var decl = startNode();\n      decl.id = parseIdent();\n      if (strict && isStrictBadIdWord(decl.id.name))\n        raise(decl.id.start, \"Binding \" + decl.id.name + \" in strict mode\");\n      decl.init = eat(_eq) ? parseExpression(true, noIn) : null;\n      node.declarations.push(finishNode(decl, \"VariableDeclarator\"));\n      if (!eat(_comma)) break;\n    }\n  }\n\n  // ### Expression parsing\n\n  // These nest, from the most general expression type at the top to\n  // 'atomic', nondivisible expression types at the bottom. Most of\n  // the functions will simply let the function(s) below them parse,\n  // and, *if* the syntactic construct they handle is present, wrap\n  // the AST node that the inner parser gave them in another node.\n\n  /**\n   * Parse a full expression. The arguments are used to forbid comma\n   * sequences (in argument lists, array literals, or object literals)\n   * or the `in` operator (in for loops initalization expressions).\n   *\n   * @param {boolean=} noComma\n   * @param {boolean=} noIn\n   * @returns {!node_t}\n   */\n  function parseExpression(noComma, noIn) {\n    var expr = parseMaybeAssign(noIn);\n    if (!noComma && tokType === _comma) {\n      var node = startNodeFrom(expr);\n      node.expressions = [expr];\n      while (eat(_comma)) node.expressions.push(parseMaybeAssign(noIn));\n      return finishNode(node, \"SequenceExpression\");\n    }\n    return expr;\n  }\n\n  /**\n   * Parse an assignment expression. This includes applications of\n   * operators like `+=`.\n   *\n   * @param {boolean|undefined} noIn\n   * @returns {!node_t}\n   */\n  function parseMaybeAssign(noIn) {\n    var left = parseMaybeConditional(noIn);\n    if (tokType.isAssign) {\n      var node = startNodeFrom(left);\n      node.operator = tokVal;\n      node.left = left;\n      next();\n      node.right = parseMaybeAssign(noIn);\n      checkLVal(left);\n      return finishNode(node, \"AssignmentExpression\");\n    }\n    return left;\n  }\n\n  /**\n   * Parse a ternary conditional (`?:`) operator.\n   *\n   * @param {boolean|undefined} noIn\n   * @returns {!node_t}\n   */\n  function parseMaybeConditional(noIn) {\n    var expr = parseExprOps(noIn);\n    if (eat(_question)) {\n      var node = startNodeFrom(expr);\n      node.test = expr;\n      node.consequent = parseExpression(true);\n      expect(_colon);\n      node.alternate = parseExpression(true, noIn);\n      return finishNode(node, \"ConditionalExpression\");\n    }\n    return expr;\n  }\n\n  /**\n   * Start the precedence parser.\n   *\n   * @param {boolean|undefined} noIn\n   * @returns {!node_t}\n   */\n  function parseExprOps(noIn) {\n    return parseExprOp(parseMaybeUnary(), -1, noIn);\n  }\n\n  /**\n   * Parse binary operators with the operator precedence parsing\n   * algorithm. `left` is the left-hand side of the operator.\n   * `minPrec` provides context that allows the function to stop and\n   * defer further parser to one of its callers when it encounters an\n   * operator that has a lower precedence than the set it is parsing.\n   *\n   * @param {!node_t} left\n   * @param {number} minPrec\n   * @param {boolean|undefined} noIn\n   * @returns {!node_t}\n   */\n  function parseExprOp(left, minPrec, noIn) {\n    var prec = tokType.binop;\n    if (prec !== null && (!noIn || tokType !== _in)) {\n      if (prec > minPrec) {\n        var node = startNodeFrom(left);\n        node.left = left;\n        node.operator = tokVal;\n        var op = tokType;\n        next();\n        node.right = parseExprOp(parseMaybeUnary(), prec, noIn);\n        var exprNode = finishNode(node, (op === _logicalOR || op === _logicalAND) ? \"LogicalExpression\" : \"BinaryExpression\");\n        return parseExprOp(exprNode, minPrec, noIn);\n      }\n    }\n    return left;\n  }\n\n  /**\n   * Parse unary operators, both prefix and postfix.\n   *\n   * @returns {!node_t}\n   */\n  function parseMaybeUnary() {\n    if (tokType.prefix) {\n      var node = startNode();\n      var update = tokType.isUpdate;\n      node.operator = tokVal;\n      node.prefix = true;\n      tokRegexpAllowed = true;\n      next();\n      node.argument = parseMaybeUnary();\n      if (update) checkLVal(node.argument);\n      else if (strict && node.operator === \"delete\" &&\n               node.argument.type === \"Identifier\")\n        raise(node.start, \"Deleting local variable in strict mode\");\n      return finishNode(node, update ? \"UpdateExpression\" : \"UnaryExpression\");\n    }\n    var expr = parseExprSubscripts();\n    while (tokType.postfix && !canInsertSemicolon()) {\n      var node = startNodeFrom(expr);\n      node.operator = tokVal;\n      node.prefix = false;\n      node.argument = expr;\n      checkLVal(expr);\n      next();\n      expr = finishNode(node, \"UpdateExpression\");\n    }\n    return expr;\n  }\n\n  /**\n   * Parse call, dot, and `[]`-subscript expressions.\n   *\n   * @returns {!node_t}\n   */\n  function parseExprSubscripts() {\n    return parseSubscripts(parseExprAtom());\n  }\n\n  /**\n   * @param {!node_t} base\n   * @param {boolean=} noCalls\n   * @returns {!node_t}\n   */\n  function parseSubscripts(base, noCalls) {\n    var node;\n    if (eat(_dot)) {\n      node = startNodeFrom(base);\n      node.object = base;\n      node.property = parseIdent(true);\n      node.computed = false;\n      return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n    }\n    if (eat(_bracketL)) {\n      node = startNodeFrom(base);\n      node.object = base;\n      node.property = parseExpression();\n      node.computed = true;\n      expect(_bracketR);\n      return parseSubscripts(finishNode(node, \"MemberExpression\"), noCalls);\n    }\n    if (!noCalls && eat(_parenL)) {\n      node = startNodeFrom(base);\n      node.callee = base;\n      node.arguments = parseExprList(_parenR, false);\n      return parseSubscripts(finishNode(node, \"CallExpression\"), noCalls);\n    }\n    return base;\n  }\n\n  /**\n   * Parse an atomic expression — either a single token that is an expression,\n   * an expression started by a keyword like `function` or `new`,\n   * or an expression wrapped in punctuation like `()`, `[]`, or `{}`.\n   *\n   * @returns {!node_t}\n   * @suppress {missingReturn}\n   */\n  function parseExprAtom() {\n    var node;\n    switch (tokType) {\n      case _this:\n        node = startNode();\n        next();\n        return finishNode(node, \"ThisExpression\");\n      case _name:\n        return parseIdent();\n      case _num: case _string: case _regexp:\n        node = startNode();\n        node.value = tokVal;\n        node.raw = input.slice(tokStart, tokEnd);\n        next();\n        return finishNode(node, \"Literal\");\n\n      case _null: case _true: case _false:\n        node = startNode();\n        node.value = tokType.atomValue;\n        node.raw = tokType.keyword;\n        next();\n        return finishNode(node, \"Literal\");\n\n      case _parenL:\n        var tokStartLoc1 = tokStartLoc;\n        var tokStart1 = tokStart;\n        next();\n        var val = parseExpression();\n        val.start = tokStart1;\n        val.end = tokEnd;\n        if (options.locations) {\n          val.loc.start = tokStartLoc1;\n          val.loc.end = tokEndLoc;\n        }\n        if (options.ranges) {\n          val.range = [tokStart1, tokEnd];\n        }\n        expect(_parenR);\n        return val;\n\n      case _bracketL:\n        node = startNode();\n        next();\n        node.elements = parseExprList(_bracketR, true, true);\n        return finishNode(node, \"ArrayExpression\");\n\n      case _braceL:\n        return parseObj();\n\n      case _function:\n        node = startNode();\n        next();\n        return parseFunction(node, false);\n\n      case _new:\n        return parseNew();\n    }\n    unexpected();\n  }\n\n  /**\n   * New's precedence is slightly tricky. It must allow its argument to be\n   * a `[]` or dot subscript expression, but not a call — at least, not\n   * without wrapping it in parentheses. Thus, it uses the noCalls argument\n   * to parseSubscripts to prevent it from consuming the argument list.\n   *\n   * @returns {!node_t}\n   */\n  function parseNew() {\n    var node = startNode();\n    next();\n    node.callee = parseSubscripts(parseExprAtom(), true);\n    node.arguments = eat(_parenL) ? parseExprList(_parenR, false) : empty;\n    return finishNode(node, \"NewExpression\");\n  }\n\n  /**\n   * Parse an object literal.\n   *\n   * @returns {!node_t}\n   */\n  function parseObj() {\n    var node = startNode();\n    var first = true;\n    var sawGetSet = false;\n    node.properties = [];\n    next();\n    while (!eat(_braceR)) {\n      if (!first) {\n        expect(_comma);\n        if (options.allowTrailingCommas && eat(_braceR)) {\n          break;\n        }\n      } else {\n        first = false;\n      }\n\n      var prop = {key: parsePropertyName()};\n      var isGetSet = false;\n      var kind;\n      if (eat(_colon)) {\n        prop.value = parseExpression(true);\n        kind = prop.kind = \"init\";\n      } else if (prop.key.type === \"Identifier\" &&\n                 (prop.key.name === \"get\" || prop.key.name === \"set\")) {\n        isGetSet = sawGetSet = true;\n        kind = prop.kind = prop.key.name;\n        prop.key = parsePropertyName();\n        if (tokType !== _parenL) unexpected();\n        prop.value = parseFunction(startNode(), false);\n      } else {\n        unexpected();\n      }\n\n      // getters and setters are not allowed to clash — either with\n      // each other or with an init property — and in strict mode,\n      // init properties are also not allowed to be repeated.\n\n      if (prop.key.type === \"Identifier\" && (strict || sawGetSet)) {\n        for (var i = 0; i < node.properties.length; ++i) {\n          var other = node.properties[i];\n          if (other.key.name === prop.key.name) {\n            var conflict = kind === other.kind || isGetSet && other.kind === \"init\" ||\n                kind === \"init\" && (other.kind === \"get\" || other.kind === \"set\");\n            if (conflict && !strict && kind === \"init\" && other.kind === \"init\") {\n              conflict = false;\n            }\n            if (conflict) {\n              raise(prop.key.start, \"Redefinition of property\");\n            }\n          }\n        }\n      }\n      node.properties.push(prop);\n    }\n    return finishNode(node, \"ObjectExpression\");\n  }\n\n  /**\n   * @returns {!node_t}\n   */\n  function parsePropertyName() {\n    if (tokType === _num || tokType === _string) {\n      return parseExprAtom();\n    }\n    return parseIdent(true);\n  }\n\n  /**\n   * Parse a function declaration or literal (depending on the\n   * `isStatement` parameter).\n   *\n   * @param {!node_t} node\n   * @param {boolean} isStatement\n   * @returns {!node_t}\n   */\n  function parseFunction(node, isStatement) {\n    if (tokType === _name) {\n      node.id = parseIdent();\n    } else if (isStatement) {\n      unexpected();\n    } else {\n      node.id = null;\n    }\n    node.params = [];\n    var first = true;\n    expect(_parenL);\n    while (!eat(_parenR)) {\n      if (!first) {\n        expect(_comma);\n      } else {\n        first = false;\n      }\n      node.params.push(parseIdent());\n    }\n\n    // Start a new scope with regard to labels and the `inFunction`\n    // flag (restore them to their old value afterwards).\n    var oldInFunc = inFunction;\n    var oldLabels = labels;\n    inFunction = true;\n    labels = [];\n    node.body = parseBlock(true);\n    inFunction = oldInFunc;\n    labels = oldLabels;\n\n    // If this is a strict mode function, verify that argument names\n    // are not repeated, and it does not try to bind the words `eval`\n    // or `arguments`.\n    if (strict || node.body.body.length && isUseStrict(node.body.body[0])) {\n      for (var i = node.id ? -1 : 0; i < node.params.length; ++i) {\n        var id = i < 0 ? node.id : node.params[i];\n        if (isStrictReservedWord(id.name) || isStrictBadIdWord(id.name)) {\n          raise(id.start, \"Defining '\" + id.name + \"' in strict mode\");\n        }\n        if (i >= 0) {\n          for (var j = 0; j < i; ++j) {\n            if (id.name === node.params[j].name) {\n              raise(id.start, \"Argument name clash in strict mode\");\n            }\n          }\n        }\n      }\n    }\n\n    return finishNode(node, isStatement ? \"FunctionDeclaration\" : \"FunctionExpression\");\n  }\n\n  /**\n   * Parses a comma-separated list of expressions, and returns them as\n   * an array. `close` is the token type that ends the list, and\n   * `allowEmpty` can be turned on to allow subsequent commas with\n   * nothing in between them to be parsed as `null` (which is needed\n   * for array literals).\n   *\n   * @param {!Object} close\n   * @param {boolean} allowTrailingComma\n   * @param {boolean=} allowEmpty\n   * @returns {!Array<!node_t>}\n   */\n  function parseExprList(close, allowTrailingComma, allowEmpty) {\n    var elts = [];\n    var first = true;\n    while (!eat(close)) {\n      if (!first) {\n        expect(_comma);\n        if (allowTrailingComma && options.allowTrailingCommas && eat(close)) {\n          break;\n        }\n      } else {\n        first = false;\n      }\n\n      elts.push((allowEmpty && tokType === _comma) ?\n          null : parseExpression(true));\n    }\n    return elts;\n  }\n\n  /**\n   * Parse the next token as an identifier. If `liberal` is true (used\n   * when parsing properties), it will also convert keywords into\n   * identifiers.\n   *\n   * @param {boolean=} liberal\n   * @returns {!node_t}\n   */\n  function parseIdent(liberal) {\n    var node = startNode();\n    if (liberal && options.forbidReserved === \"everywhere\") {\n      liberal = false;\n    }\n    if (tokType === _name) {\n      if (!liberal &&\n          (options.forbidReserved && isReservedWord5(tokVal) ||\n           strict && isStrictReservedWord(tokVal)) &&\n          input.slice(tokStart, tokEnd).indexOf(\"\\\\\") === -1) {\n        raise(tokStart, \"The keyword '\" + tokVal + \"' is reserved\");\n      }\n      node.name = tokVal;\n    } else if (liberal && tokType.keyword) {\n      node.name = tokType.keyword;\n    } else {\n      unexpected();\n    }\n    tokRegexpAllowed = false;\n    next();\n    return finishNode(node, \"Identifier\");\n  }\n\n});\n\n\n/***/ }),\n\n/***/ \"vm\":\n/*!*********************!*\\\n  !*** external \"vm\" ***!\n  \\*********************/\n/***/ ((module) => {\n\n\"use strict\";\nmodule.exports = require(\"vm\");\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\t// no module.id needed\n/******/ \t\t\t// no module.loaded needed\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/define property getters */\n/******/ \t(() => {\n/******/ \t\t// define getter functions for harmony exports\n/******/ \t\t__webpack_require__.d = (exports, definition) => {\n/******/ \t\t\tfor(var key in definition) {\n/******/ \t\t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t\t}\n/******/ \t\t\t}\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/hasOwnProperty shorthand */\n/******/ \t(() => {\n/******/ \t\t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ \t})();\n/******/ \t\n/******/ \t/* webpack/runtime/make namespace object */\n/******/ \t(() => {\n/******/ \t\t// define __esModule on exports\n/******/ \t\t__webpack_require__.r = (exports) => {\n/******/ \t\t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t\t}\n/******/ \t\t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t\t};\n/******/ \t})();\n/******/ \t\n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be in strict mode.\n(() => {\n\"use strict\";\n/*!*******************************!*\\\n  !*** ./src/js-interpreter.js ***!\n  \\*******************************/\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst acorn = __webpack_require__(/*! ../original-repo/acorn */ \"./original-repo/acorn.js\");\nglobalThis.acorn = acorn;\nconst { Interpreter } = __webpack_require__(/*! ../original-repo/interpreter */ \"./original-repo/interpreter.js\");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Interpreter);\n\n})();\n\n__webpack_exports__ = __webpack_exports__[\"default\"];\n/******/ \treturn __webpack_exports__;\n/******/ })()\n;\n});","import { Segment, Vector2d, Degrees, Radians, deg2rad } from \"./geometry\";\n\nexport type Ratio = number;\n\ntype SceneInfo = {\n  readonly painter?: PainterInfo;\n  readonly drawing?: Stroke[];\n};\nexport class SceneState implements SceneInfo {\n  constructor(\n    readonly painter: PainterState,\n    readonly drawing: Stroke[] = []) { }\n\n  update(scene: SceneInfo): SceneState {\n    return new SceneState(\n      scene.painter ? this.painter.update(scene.painter) : this.painter,\n      scene.drawing ? this.drawing.concat(scene.drawing) : this.drawing);\n  }\n}\n\nexport class Stroke {\n  readonly segment: Segment;\n  constructor(\n    private from: Vector2d,\n    private to: Vector2d,\n    readonly color = \"\") {\n\n    this.segment = new Segment(from, to);\n  }\n\n  defaultColor(color: string): Stroke {\n    if (this.color) {\n      return this;\n    } else {\n      return new Stroke(this.from, this.to, color);\n    }\n  }\n\n  draw(ctx: CanvasRenderingContext2D, scale = 1) {\n    ctx.save();\n    if (this.color) {\n      ctx.strokeStyle = this.color;\n    }\n    this.segment.scaled(scale).draw(ctx);\n    ctx.restore();\n  }\n}\n\ntype PainterInfo = {\n  readonly position?: Vector2d;\n  readonly facing?: Degrees;\n  readonly height?: Ratio;\n  readonly opacity?: Ratio;\n};\nexport class PainterState implements PainterInfo {\n  readonly position: Vector2d;\n  readonly facing: Degrees;\n  readonly height: Ratio;\n  readonly opacity: Ratio;\n\n  constructor(\n    base: PainterInfo,\n    {\n      position = base.position,\n      facing = base.facing,\n      height = base.height,\n      opacity = base.opacity\n    } = {} as PainterInfo) {\n\n    this.position = position;\n    this.facing = facing;\n    this.height = height;\n    this.opacity = opacity;\n  }\n\n  get facingRadians(): Radians {\n    return deg2rad(this.facing);\n  }\n\n  update(info: PainterInfo): PainterState {\n    return new PainterState(this, info);\n  }\n}\n","const txtOut = document.getElementById(\"out\");\n\nexport function info(message: string) {\n  txtOut.innerHTML += `<span style=color:#0060df>${message}</span>\\n`;\n}\n\nexport function error(message: string) {\n  txtOut.innerHTML += `<span style=color:red>${message}</span>\\n`;\n}\n\nexport function clear() {\n  txtOut.textContent = \"\";\n}\n","import JSInterpreter from \"js-interpreter\";\nimport { Node } from \"acorn\";\nimport { Degrees, Vector2d } from \"./geometry\";\n\nimport { Animation, Frame } from \"./frames\";\nimport { Stroke } from \"./scene\";\nimport * as output from \"./output\";\n\nimport MainLoop from \"mainloop.js\" // FIXME: we don't want you here!\n\nexport type State = {\n  node: Node;\n  value?: any;\n  mode_?: any;\n  isLoop?: boolean;\n  n_?: number;\n  doneVariable_: true;\n\n  // Call\n  doneCallee_?: boolean;\n  doneArgs_?: boolean;\n  doneExec_?: boolean;\n  arguments_?: Node[];\n\n  // Switch\n  test_?: boolean;\n  index_?: number;\n  checked_?: boolean[];\n  switchValue_?: any;\n  isSwitch?: boolean;\n\n  // Try\n  doneBlock_?: boolean;\n  doneHandler_?: boolean;\n  doneFinalizer_?: boolean;\n  throwValue?: any;\n}\n\ntype NativeInterpreter = {\n  ast: Node;\n  appendCode: (code: any) => void;\n  step: () => boolean;\n  run: () => boolean;\n  stateStack: State[];\n  value: any;\n  parentScope: any;\n  setProperty(scope: any, name: string, value: any, desc?: PropertyDescriptor);\n  createNativeFunction(fn: Function): any;\n  createPrimitive(value: any): any;\n  createObject(value: any): any;\n  getScope(): any;\n};\ninterface InitFunc {\n  (interpreter: NativeInterpreter, scope: any): any;\n}\n\nexport interface Environment {\n  forward(distance: number): void;\n  back(distance: number): void;\n  left(angle: Degrees): void;\n  right(angle: Degrees): void;\n  up(): void;\n  down(): void;\n  hide(): void;\n  show(): void;\n}\n\nexport class Instruction {\n  constructor(\n    readonly currentState: State,\n    readonly animation: Animation) { }\n\n  get node() {\n    let state = this.currentState, node = state.node;\n    if (node.type === \"ForStatement\") {\n      if (state.mode_ === 1) {\n        node = (<any>node).test;\n      } else if (state.mode_ === 3) {\n        node = (<any>node).update;\n      }\n    } else if (node.type === \"ForInStatement\") {\n      if (state.isLoop) {\n        node = {\n          type: \"ForInUpdate\",\n          start: (<any>node).left.start,\n          end: (<any>node).right.end,\n        };\n      }\n    } else if (/(Do|While)Statement/.test(node.type) && state.isLoop) {\n      node = (<any>node).test\n    } else if (node.type === \"IfStatement\") {\n      if (state.mode_ === 1) {\n        node = (<any>node).test;\n      }\n    } else if (node.type === \"SwitchStatement\") {\n      if (state.switchValue_ && +state.value === +state.switchValue_) {\n        node = (<any>node).cases[state.index_];\n      } else if (state.test_) {\n        node = (<any>node).discriminant;\n      }\n    } else if (node.type === \"TryStatement\") {\n      if (state.throwValue) {\n        node = (<any>node).handler.param;\n      }\n    } else if (node.type === \"ConditionalExpression\") {\n      if (state.mode_ === 1) {\n        node = (<any>node).test;\n      } else if (state.mode_ === 2) {\n        if ((<any>node).test_) {\n          node = (<any>node).consequent;\n        } else {\n          node = (<any>node).alternate;\n        }\n      }\n    } else if (node.type === \"SequenceExpression\") {\n      if (state.n_) {\n        node = (<any>node).expressions[state.n_ - 1];\n      }\n    } else if (node.type === \"CallExpression\") {\n      if (state.n_ && !state.doneArgs_) {\n        node = (<any>node).arguments[state.n_ - 1];\n      }\n    }\n\n    return node;\n  }\n}\n\ninterface Stack<T> {\n  push(item: T): number;\n  pop(): T;\n  peek(): T;\n  map<R>(fn: (t: T) => R): R;\n}\n\nconst MOVE_DURATION = 50;\nconst ROTATE_DURATION = 25;\nconst RISE_DURATION = 25;\nconst FALL_DURATION = 25;\nconst FADE_DURATION = 25;\n//const WAIT_DURATION = 10;\n\nexport class Interpreter {\n  private interpreter: NativeInterpreter;\n\n  private instructionStack: Stack<Node> = (() => {\n    let instructionStack = [] as any;\n    instructionStack.peek = function (): Node {\n      return this[this.length - 1];\n    };\n    return instructionStack as Stack<Node>;\n  })();\n\n  constructor(readonly code: string) {\n    this.interpreter = new JSInterpreter(code, this.init);\n    this.interpreter.getScope().strict = true\n  }\n\n  private readonly init: InitFunc = (interpreter, scope) => {\n    setFn(\"forward\", (distance: number, color?: string) => {\n      this.animation = new Animation(MOVE_DURATION * distance / 10, (delta: number, keyFrame: Frame) => {\n        let from = keyFrame.position, angle = keyFrame.facingRadians;\n        let to = from.plus(Vector2d.polar(angle, distance * delta));\n\n        if (keyFrame.height === 0) {\n          return keyFrame.with({ position: to, newStrokes: [new Stroke(from, to, color)] });\n        }\n        return keyFrame.with({ position: to });\n      });\n    });\n    setFn(\"back\", (distance: number, color?: string) => {\n      this.animation = new Animation(MOVE_DURATION * distance / 10, (delta: number, keyFrame: Frame) => {\n        let from = keyFrame.position, angle = keyFrame.facingRadians;\n        let to = from.plus(Vector2d.polar(angle, -distance * delta));\n\n        if (keyFrame.height === 0) {\n          return keyFrame.with({ position: to, newStrokes: [new Stroke(from, to, color)] });\n        }\n        return keyFrame.with({ position: to });\n      });\n    });\n    setFn(\"right\", (angle: Degrees) => {\n      this.animation = new Animation(ROTATE_DURATION * angle / 30, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ facing: keyFrame.facing - angle * delta });\n      });\n    });\n    setFn(\"left\", (angle: Degrees) => {\n      this.animation = new Animation(ROTATE_DURATION * angle / 30, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ facing: keyFrame.facing + angle * delta });\n      });\n    });\n    setFn(\"up\", () => {\n      this.animation = new Animation(RISE_DURATION, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ height: delta });\n      });\n    });\n    setFn(\"down\", () => {\n      this.animation = new Animation(FALL_DURATION, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ height: 1 - delta });\n      });\n    });\n    setFn(\"hide\", () => {\n      this.animation = new Animation(FADE_DURATION, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ opacity: 1 - delta });\n      });\n    });\n    setFn(\"show\", () => {\n      this.animation = new Animation(FADE_DURATION, (delta: number, keyFrame: Frame) => {\n        return keyFrame.with({ opacity: delta });\n      });\n    });\n\n    let foreground = \"black\";\n    prop(\"foreground\", {\n      get: fn(() => foreground),\n      set: fn((fg: any) => {\n        foreground = String(fg);\n        this.animation = new Animation(0, (_, keyFrame: Frame) => {\n          return keyFrame.with({ foreground });\n        });\n      }),\n    });\n\n    let background = \"none\";\n    prop(\"background\", {\n      get: fn(() => background),\n      set: fn((bg: any) => {\n        background = String(bg);\n        this.animation = new Animation(0, (_, keyFrame: Frame) => {\n          return keyFrame.with({ background });\n        });\n      }),\n    });\n\n    setFn(\"ask\", (question: any) => {\n      MainLoop.stop(); // FIXME: find another way to make this sync, please!\n      let input = prompt(String(question)); // FIXME: rework into asynchronous style!\n      MainLoop.start(); // FIXME:\n\n      return input;\n    });\n\n    // FIXME: no document.getElementById here!\n    setFn(\"print\", (...words: any[]) => {\n      output.info(words.join(\" \"));\n    });\n    setFn(\"println\", (...lines: any[]) => {\n      output.info(lines.join(\"\\n\") + \"\\n\");\n    });\n\n    setFn(\"wait\", (seconds: number) => {\n      this.animation = new Animation(seconds * 80, (_, keyFrame: Frame) => keyFrame); // FIXME: Magic Number!\n    });\n\n    setFn(\"random\", (min?: number, max?: number) => {\n      if (typeof min === \"undefined\") {\n        return Math.random();\n      }\n      if (typeof max === \"undefined\") {\n        max = min;\n        min = 0;\n      }\n      let delta = max - min;\n      return min + Math.random() * delta | 0;\n    });\n\n    setFn(\"rgb\", (r: number, g: number, b: number, a?: number) => {\n      checkRange(\"red\", r, 0, 255);\n      checkRange(\"green\", g, 0, 255);\n      checkRange(\"blue\", b, 0, 255);\n      checkRange(\"alpha\", a, 0, 1);\n\n      return `rgb(${r | 0} ${g | 0} ${b | 0} / ${a})`;\n    });\n    setFn(\"hsl\", (h: number, s: number, l: number, a?: number) => {\n      checkRange(\"saturation\", s, 0, 1);\n      checkRange(\"lightness\", l, 0, 1);\n      checkRange(\"alpha\", a, 0, 1);\n\n      return `hsl(${h | 0} ${s} ${l} / ${a})`;\n    });\n    function checkRange(name: string, value: number, min: number, max: number) {\n      if (value < min) throw new Error(`${name} should be >= ${min} (was ${value})`);\n      if (value > max) throw new Error(`${name} should be <= ${max} (was ${value})`);\n    }\n\n    function setFn(name: string, fnWrapper: Function) {\n      interpreter.setProperty(scope, name, fn(fnWrapper));\n    }\n    function fn(wrapper: Function) {\n      return interpreter.createNativeFunction(wrapper);\n    }\n    function prop(name: string, desc: PropertyDescriptor) {\n      interpreter.setProperty(scope, name, JSInterpreter.VALUE_IN_DESCRIPTOR, desc);\n    }\n  };\n\n  reset() {\n    this.interpreter = new JSInterpreter(this.interpreter.ast, this.init);\n  }\n\n  private step(): State {\n    let recoverState = this.currentState;\n    try {\n      if (this.interpreter.step()) {\n        return this.currentState;\n      }\n    } catch (e) {\n      e.state = recoverState;\n      throw e;\n    }\n    return null;\n  }\n  private get currentState(): State {\n    return this.interpreter.stateStack[this.interpreter.stateStack.length - 1];\n  }\n  private get currentNode(): Node {\n    return this.instructionStack.peek();\n  }\n\n  private state: State;\n  private animation: Animation;\n  private currentInstruction(): Instruction {\n    let instruction = new Instruction(this.state, this.animation);\n    this.animation = null;\n    return instruction;\n  }\n\n  stepToNextInstruction(): Instruction {\n    seek: {\n      while (this.state = this.step()) {\n        let node = this.state.node;\n\n        if (node.type === \"ForStatement\") {\n          if (node !== this.currentNode) {\n            this.instructionStack.push(node);\n            break seek;\n          } else if (this.state.mode_ === 1) {\n            break seek; // return For.TestInstruction\n          } else if (this.state.mode_ === 3) {\n            break seek; // return For.UpdateInstruction\n          } else if (this.state.mode_ === 2) {\n            if (!this.state.value || !this.state.value.data) {\n              this.instructionStack.pop();\n            }\n            break seek;\n          }\n        } else if (node.type === \"ForInStatement\") {\n          if (!this.state.doneVariable_) {\n            break seek;\n          } else if (this.state.isLoop) {\n            break seek; // return ForIn.Update\n          }\n        } else if (/(Do|While)Statement/.test(node.type)) {\n          if (node !== this.currentNode) {\n            this.instructionStack.push(node);\n            break seek;\n          } else if (this.state.isLoop) {\n            if (!this.state.value || !this.state.value.data) {\n              this.instructionStack.pop();\n            }\n            break seek; // return While.TestInstruction\n          }\n        } else if (node.type === \"BlockStatement\") {\n          if (!this.state.n_) {\n            break seek;\n          }\n        } else if (node.type === \"IfStatement\") {\n          if (!this.state.mode_) {\n            this.instructionStack.push(node);\n            break seek;\n          } else if (this.state.mode_ === 1) {\n            if (!this.state.value.data) {\n              this.instructionStack.pop();\n            }\n            break seek; // return If.TestInstruction\n          } else if (this.state.mode_ === 2) {\n            this.instructionStack.pop();\n          }\n        } else if (node.type === \"SwitchStatement\") {\n          if (this.state.switchValue_) {\n            if (!this.state.isSwitch && +this.state.value === +this.state.switchValue_) {\n              break seek; // return Switch.Found\n            }\n          } else if (this.state.test_) {\n            break seek; // return Switch.TestInstruction\n          } else {\n            break seek;\n          }\n        } else if (node.type === \"TryStatement\") {\n          if (this.state.throwValue) {\n            break seek; // return Try.CatchBlock\n          } else if (!this.state.doneBlock_) {\n            break seek; // return Try.TryBlock\n          }\n        } else if (node.type === \"ConditionalExpression\") {\n          if (!this.state.mode_) {\n            break seek;\n          } else if (this.state.mode_ === 1) {\n            (<any>node).test_ = this.state.value.data;\n            this.instructionStack.push(node);\n            break seek; // return Elvis.TestInstruction\n          } else if (this.state.mode_ === 2) {\n            if ((<any>this.instructionStack.pop()).test_) {\n              break seek; // return Elvis.Consequent\n            } else {\n              break seek; // return Elvis.Alternate\n            }\n          }\n        } else if (node.type === \"SequenceExpression\") {\n          if (!this.state.n_) {\n            break seek;\n          } else {\n            break seek; // return Sequence.Element(this.state.n_)\n          }\n        } else if (node.type === \"CallExpression\") {\n          if (this.state.doneExec_) {\n            this.instructionStack.pop();\n          } else if (this.state.n_) {\n            break seek; // return Call.Args(this.state.n_)\n          } else if (this.state.doneCallee_) {\n            // break seek; // return Call.Fn(String(this.state.value))\n          } else {\n            this.instructionStack.push(node);\n          }\n        } else if (/(Break|Continue)Statement/.test(node.type)) {\n          break seek;\n        } else if (/^(?!Function).*(Statement|Declaration)/.test(node.type)) {\n          if (node === this.currentNode) {\n            this.instructionStack.pop();\n            break seek;\n          } else {\n            this.instructionStack.push(node);\n            //break seek;\n          }\n        } else {\n          //console.log(\"???\", node.type)\n        }\n      }\n      return null;\n    }\n\n    return this.currentInstruction();\n  }\n};","import { Vector2d, Degrees, deg2rad } from \"./geometry\";\nimport { Frame } from \"./frames\";\n\nexport const ZOOM_DOWN = 1;\nexport const ZOOM_UP = 1.5;\n\nexport class Painter {\n  position: Vector2d = Vector2d.ORIGIN;\n  facing: Degrees = 0;\n  z = ZOOM_DOWN;\n  zoom = 0.5;\n  scale = 3.2;\n  opacity = 1;\n  brushColor = \"black\";\n\n  update(frame: Frame) {\n    this.position = frame.position.scale(this.scale);\n    this.facing = frame.facing;\n    this.z = ZOOM_DOWN + frame.height * (ZOOM_UP - ZOOM_DOWN);\n    this.opacity = frame.opacity;\n    this.brushColor = frame.foreground;\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    let cx = this.position.x;\n    let cy = this.position.y;\n\n    let _5 = 5 * this.scale * this.zoom * this.z;\n    let _3 = 3 * this.scale * this.zoom * this.z;\n\n    ctx.save();\n\n    ctx.translate(cx, cy);\n    ctx.rotate(deg2rad(this.facing));\n\n    let zRatio = (this.z - ZOOM_DOWN) / (ZOOM_UP - ZOOM_DOWN);\n\n    // dot\n    ctx.save();\n\n    ctx.strokeStyle = this.brushColor;\n    ctx.globalAlpha = 1 - zRatio;\n\n    ctx.beginPath();\n    ctx.moveTo(0, 0);\n    ctx.lineTo(0, 0);\n    ctx.stroke();\n\n    ctx.restore();\n\n    // triangle\n    let red = 160 + 95 * (1 - zRatio) | 0;\n    let green = 160 * zRatio | 0;\n    let blue = 160 + 95 * (1 - zRatio) | 0;\n    ctx.strokeStyle = `rgba(${red},${green},${blue},${this.opacity})`;\n\n    ctx.beginPath();\n    ctx.moveTo(_5, -_3);\n    ctx.lineTo(-_5, -_3);\n    ctx.lineTo(0, _3);\n    ctx.lineTo(_5, -_3);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","import CodeMirror from \"codemirror\";\nimport * as output from \"./output\";\nimport EventEmitter from \"events\";\n\nfunction debounce(func: Function, wait: number, immediate?: boolean) {\n  let timeout: any;\n  return function () {\n    var context = this, args = arguments;\n    var later = function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n};\n\ntype DiskState = { name?: string, code: string };\n\nclass RAM {\n  #currentState: DiskState;\n  get currentState() {\n    return { ...this.#currentState };\n  }\n\n  constructor(private editor: CodeMirror.Editor) {\n    const ramValue = localStorage.getItem(\"ram\");\n    this.#currentState = ramValue ? JSON.parse(ramValue) : { code: \"\" };\n    editor.setValue(this.#currentState.code);\n\n    editor.on(\"change\", debounce(() => this.writeCode(editor.getValue()), 400));\n  }\n\n  private writeCode(code: string) {\n    this.#currentState.code = code;\n    this.persist();\n  }\n\n  private persist() {\n    localStorage.setItem(\"ram\", JSON.stringify(this.#currentState));\n  }\n\n  load(state: DiskState) {\n    this.#currentState = state;\n    this.persist();\n\n    this.editor.setValue(state.code);\n  }\n\n  attach(name: string) {\n    this.#currentState.name = name;\n    this.persist();\n  }\n\n  detach() {\n    this.#currentState.name = undefined;\n    this.persist();\n  }\n}\n\nclass Disk {\n  private readonly savedStates: Array<DiskState>;\n\n  get saves() {\n    return this.savedStates.map(s => ({ ...s }));\n  }\n\n  constructor() {\n    const savesValue = localStorage.getItem(\"saves\");\n    this.savedStates = savesValue ? JSON.parse(savesValue) : [];\n  }\n\n  write(name: string, code: string): [number, DiskState?] {\n    if (this.savedStates.length === 0) {\n      const state = { name, code };\n      this.savedStates.push(state);\n      this.persist();\n      return [0, state];\n    }\n\n    const [i, existing] = this.#get(name);\n    if (existing) {\n      existing.code = code;\n      this.persist();\n      return [i, undefined];\n    }\n\n    let idx = this.savedStates.findIndex(s => s.name > name);\n    const state = { name, code };\n    if (~idx) {\n      this.savedStates.splice(idx, 0, state);\n    } else {\n      idx = this.savedStates.push(state) - 1;\n    }\n    this.persist();\n    return [idx, state];\n  }\n\n  #get(name: string): [number, DiskState?] {\n    const idx = this.savedStates.findIndex(s => s.name === name)\n    return [idx, this.savedStates[idx]];\n  }\n\n  get(name: string): [number, DiskState?] {\n    const [i, existing] = this.#get(name);\n    return existing ? [i, { ...existing }] : [-1, undefined];\n  }\n\n  delete(name: string) {\n    const idx = this.savedStates.findIndex(s => s.name === name);\n    if (~idx) {\n      this.savedStates.splice(idx, 1);\n      this.persist();\n      return true;\n    }\n    return false;\n  }\n\n  private persist() {\n    localStorage.setItem(\"saves\", JSON.stringify(this.savedStates));\n  }\n}\n\nclass SavesList extends EventEmitter {\n  private el: HTMLUListElement;\n  private itemTpl: HTMLLIElement;\n\n  constructor(\n    private readonly ram: RAM,\n    private readonly disk: Disk,\n  ) {\n    super();\n\n    this.el = document.getElementById(\"saves\") as HTMLUListElement;\n\n    this.itemTpl = this.el.querySelector(\"li\") as HTMLLIElement;\n    this.itemTpl.remove();\n\n    this.render();\n  }\n\n  get isEmpty() {\n    return this.disk.saves.length === 0;\n  }\n\n  get selected() {\n    return this.ram.currentState.name;\n  }\n\n  render() {\n    const items = this.disk.saves.map(this.renderItem, this);\n    this.el.append(...items);\n  }\n\n  renderItem({ name }: DiskState) {\n    const { name: currentName } = this.ram.currentState;\n\n    const item = this.itemTpl.cloneNode(true) as HTMLLIElement;\n    if (name === currentName) {\n      item.classList.add(\"currently-loaded\");\n    }\n    item.addEventListener(\"click\", () => this.restoreSave(name));\n\n    const itemName = item.querySelector(\".name\");\n    itemName.textContent = name;\n\n    const btnSave = item.querySelector(\".save\");\n    btnSave.addEventListener(\"click\", e => {\n      e.stopPropagation();\n      this.saveState(name);\n    })\n\n    const btnDelete = item.querySelector(\".delete\");\n    btnDelete.addEventListener(\"click\", e => {\n      e.stopPropagation();\n      this.deleteSave(name, item);\n    });\n\n    return item;\n  }\n\n  restoreSave(name: string) {\n    const [i, state] = this.disk.get(name);\n    if (!state) throw new Error(\"bad save name: \" + name);\n\n    this.ram.load(state)\n    this.selectItem(i);\n\n    output.clear();\n    output.info(`Save restored: \"${name}\"`);\n\n    this.emit(\"restored\", state);\n  }\n\n  private selectItem(idx: number) {\n    const currEl = this.el.querySelector(\".currently-loaded\");\n    if (currEl) currEl.classList.remove(\"currently-loaded\");\n    this.el.children[idx].classList.add(\"currently-loaded\");\n  }\n\n  saveState(name: string) {\n    const { name: currentName, code } = this.ram.currentState;\n    const [idx, newState] = this.disk.write(name, code)\n\n    if (newState) {\n      const item = this.renderItem(newState)\n      const nextItem = this.el.children[idx];\n      if (nextItem) {\n        nextItem.insertAdjacentElement(\"beforebegin\", item)\n      } else {\n        this.el.append(item);\n      }\n    }\n\n    if (name !== currentName) {\n      this.ram.attach(name);\n      this.selectItem(idx);\n    }\n\n    output.clear();\n    output.info(`Saved: \"${name}\"`);\n\n    this.emit(\"saved\", name);\n  }\n\n  deleteSave(name: string, item: HTMLElement) {\n    if (!this.disk.delete(name)) {\n      throw new Error(\"bad save name: \" + name);\n    }\n    if (this.ram.currentState.name === name) {\n      this.ram.detach();\n    }\n    item.remove();\n    output.clear();\n    output.info(`Save deleted: \"${name}\"`);\n\n    this.emit(\"deleted\", name);\n  }\n}\n\nclass UI {\n  private readonly editor: HTMLElement;\n  private readonly dialog: HTMLDivElement;\n  private readonly button: HTMLButtonElement;\n  private readonly saveButton: HTMLElement;\n  private visible = false;\n\n\n  constructor(\n    editor: CodeMirror.Editor,\n    private readonly saves: SavesList,\n  ) {\n    this.editor = editor.getWrapperElement();\n    this.dialog = document.getElementById(\"disk\") as HTMLDivElement;\n\n    this.button = document.getElementById(\"load\") as HTMLButtonElement;\n    this.button.addEventListener(\"click\", () => {\n      if (this.visible) {\n        this.hideDialog()\n      } else {\n        this.showDialog()\n      }\n    });\n    \n    this.saveButton = document.getElementById(\"save\") as HTMLLIElement;\n    this.saveButton.addEventListener(\"click\", this.saveNew.bind(this));\n    this.nameSaveButton();\n    saves.on(\"saved\", this.nameSaveButton.bind(this));\n    saves.on(\"deleted\", this.nameSaveButton.bind(this));\n    \n    saves.on(\"restored\", this.hideDialog.bind(this));\n  }\n\n  private nameSaveButton() {\n    if (this.saves.isEmpty) {\n      this.saveButton.textContent = \"Save... (Ctrl+S)\"\n    } else {\n      this.saveButton.textContent = \"Save As... (Ctrl+Shift+S)\"\n    }\n  }\n\n  saveCurrent() {\n    const currentName = this.saves.selected;\n    if (!currentName) return this.saveNew();\n    else this.saveAs(currentName);\n  }\n\n  saveNew() {\n    let name: string;\n    while (!name) {\n      name = prompt(\"Enter new name:\", \"\").trim();\n    }\n    this.saveAs(name);\n  }\n\n  saveAs(name: string) {\n    this.saves.saveState(name);\n  }\n\n  showDialog() {\n    this.editor.style.display = \"none\";\n    this.dialog.style.display = \"block\";\n    this.button.className = \"red\";\n    this.visible = true;\n  }\n\n  hideDialog() {\n    this.editor.style.display = \"\";\n    this.dialog.style.display = \"\";\n    this.button.className = \"blue\";\n    this.visible = false;\n  }\n}\n\nlet uis = new Map<CodeMirror.Editor, UI>();\n\nexport function initialize(editor: CodeMirror.Editor) {\n  let ui = uis.get(editor);\n  if (ui) return ui;\n\n  const ram = new RAM(editor);\n  const disk = new Disk();\n  const saves = new SavesList(ram, disk);\n\n  ui = new UI(editor, saves);\n  uis.set(editor, ui);\n  return ui;\n}\n","import MainLoop from \"mainloop.js\"\n\nimport CodeMirror from \"codemirror\";\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport { Animation, Frame } from \"./frames\";\nimport { Interpreter, Instruction } from \"./interpreter\";\nimport { Painter } from \"./gui\";\nimport * as disk from \"./disk\";\nimport * as output from \"./output\";\nimport \"./style.css\";\n\nclass PainterStudio {\n  private animation: Animation;\n  private frame: Frame;\n  private painter: Painter;\n\n  private isFreezing = false;\n\n  constructor(private ctx: CanvasRenderingContext2D) {\n    MainLoop.setDraw(() => this.draw());\n    this.reset();\n  }\n\n  reset() {\n    if (MainLoop.isRunning()) {\n      MainLoop.stop();\n    }\n\n    this.animation = null;\n    this.frame = Frame.new();\n    this.painter = new Painter;\n\n    this.draw();\n  }\n\n  animate() {\n    this.isFreezing = false;\n\n    if (!MainLoop.isRunning()) {\n      MainLoop.start();\n    }\n  }\n  freeze() {\n    this.isFreezing = true;\n  }\n\n  stepAnimate() {\n    this.animate()\n    if (this.animation || getNextAnimation()) {\n      this.frame = this.animation.lastFrame;\n      this.animation = null;\n    }\n  }\n\n  setAnimation(animation: Animation): Animation {\n    return animation === null ? null : this.animation = animation.withKeyFrame(this.frame);\n  }\n\n  update(delta: number): boolean {\n    if (this.isFreezing) {\n      MainLoop.stop();\n\n    } else {\n      if (!this.animation && !getNextAnimation()) {\n        return false;\n      }\n\n      while (this.animation) {\n        this.animation.elapsed += delta / 1000 * speed;\n        if (this.animation.elapsed < this.animation.duration) {\n          this.frame = this.animation.currentFrame;\n          break;\n        }\n\n        this.frame = this.animation.lastFrame;\n        delta = (this.animation.elapsed - this.animation.duration) * 1000 / speed;\n        this.animation.elapsed = this.animation.duration;\n\n        if (!getNextAnimation()) {\n          return false;\n        }\n      }\n    }\n\n    this.painter.update(this.frame);\n\n    return true;\n  }\n\n  draw() {\n    this.drawPaper(this.ctx);\n    this.frame.strokes.forEach(stroke => stroke.defaultColor(this.frame.foreground).draw(ctx, 3.2));\n    this.painter.draw(this.ctx);\n  }\n\n  private drawPaper(ctx: CanvasRenderingContext2D, scale = 3.2) {\n    const WIDTH = ctx.canvas.width;\n    const HEIGHT = ctx.canvas.height;\n    const X = WIDTH / 2;\n    const Y = HEIGHT / 2;\n\n    ctx.save();\n\n    if (!this.frame.background || this.frame.background === \"none\" || this.frame.background === \"transparent\") {\n      ctx.fillStyle = \"#DAEAFF\";\n      ctx.fillRect(-X, -Y, WIDTH, HEIGHT);\n      ctx.strokeStyle = \"white\";\n      ctx.beginPath();\n      ctx.moveTo(0, -Y);\n      ctx.lineTo(0, Y);\n      ctx.moveTo(-X, 0);\n      ctx.lineTo(X, 0);\n      ctx.stroke();\n\n      const STEP = 5 * scale;\n\n      ctx.lineWidth = 0.5;\n      ctx.beginPath();\n      for (let x = STEP; x <= X; x += STEP) {\n        ctx.moveTo(x, -Y);\n        ctx.lineTo(x, Y);\n      }\n      for (let x = -STEP; x >= -X; x -= STEP) {\n        ctx.moveTo(x, -Y);\n        ctx.lineTo(x, Y);\n      }\n      for (let y = STEP; y <= Y; y += STEP) {\n        ctx.moveTo(-X, y);\n        ctx.lineTo(X, y);\n      }\n      for (let y = -STEP; y >= -Y; y -= STEP) {\n        ctx.moveTo(-X, y);\n        ctx.lineTo(X, y);\n      }\n      ctx.stroke();\n\n    } else {\n      ctx.fillStyle = this.frame.background;\n      ctx.fillRect(-X, -Y, WIDTH, HEIGHT);\n    }\n\n    ctx.restore();\n  }\n}\n\nconst canvasHolder = document.getElementById(\"canvas_holder\");\nconst canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\nconst ctx: CanvasRenderingContext2D = canvas.getContext(\"2d\");\n\nconst studio = new PainterStudio(ctx);\n\nwindow.addEventListener(\"resize\", setCanvasSize);\nsetCanvasSize();\nfunction setCanvasSize() {\n  canvas.width = canvasHolder.offsetWidth;\n  canvas.height = canvasHolder.offsetHeight;\n\n  ctx.restore();\n  ctx.save();\n  ctx.scale(1, -1);\n  ctx.translate(canvas.width / 2, -canvas.height / 2);\n  ctx.lineWidth = 2;\n  ctx.lineCap = \"round\";\n  ctx.lineJoin = \"round\";\n\n  studio.draw();\n}\n\nconst txtCode = document.getElementById(\"code\") as HTMLTextAreaElement;\nconst editor = CodeMirror.fromTextArea(txtCode, {\n  lineNumbers: true,\n  mode: \"javascript\",\n  tabSize: 2,\n});\n\nconst diskUI = disk.initialize(editor);\n\nconst btnPause = document.getElementById(\"pause\") as HTMLButtonElement;\nconst btnSfwd = document.getElementById(\"sfwd\") as HTMLButtonElement;\nconst btnPlay = document.getElementById(\"play\") as HTMLButtonElement;\nconst btnFfwd = document.getElementById(\"ffwd\") as HTMLButtonElement;\nconst btnStop = document.getElementById(\"stop\") as HTMLButtonElement;\n\nconst btnHelp = document.getElementById(\"help\") as HTMLButtonElement;\nconst dlgHelp = document.getElementById(\"help_dialog\") as HTMLDialogElement;\nbtnHelp.addEventListener(\"click\", () => dlgHelp.showModal());\nif (!localStorage.getItem(\"hide_splash\")) dlgHelp.showModal();\n\nconst btnCloseDialog = dlgHelp.querySelector(\".close\") as HTMLButtonElement;\nbtnCloseDialog.addEventListener(\"click\", () => {\n  localStorage.setItem(\"hide_splash\", \"1\");\n  dlgHelp.close();\n});\n\n\nconst chkTrace = document.getElementById(\"trace\") as HTMLInputElement;\nchkTrace.addEventListener(\"change\", () => clearEditorMarks());\n\ndocument.addEventListener(\"keydown\", e => {\n  if (e.ctrlKey) {\n    if (e.key === \"Enter\") {\n      if (e.altKey && !e.shiftKey) {\n        setState(\"step-fwd\");\n      } else if (e.shiftKey && !e.altKey) {\n        setState(\"fast-fwd\");\n      } else if (!e.altKey && !e.shiftKey) {\n        if (state === \"playing\") {\n          setState(\"paused\");\n        } else {\n          setState(\"playing\");\n        }\n      }\n      return;\n    }\n    if (e.key === \"Escape\" && !e.shiftKey && !e.altKey) {\n      if (state !== \"ready\") {\n        setState(\"ready\");\n      }\n      return\n    }\n    if (e.key === \"s\" && !e.shiftKey && !e.altKey) {\n      e.preventDefault();\n      diskUI.saveCurrent();\n      return\n    }\n    if (e.key === \"S\" && e.shiftKey && !e.altKey) {\n      e.preventDefault();\n      diskUI.saveNew();\n      return\n    }\n    if (e.key === \"o\" && !e.shiftKey && !e.altKey) {\n      e.preventDefault();\n      diskUI.showDialog();\n      return\n    }\n    return;\n  }\n  if (e.shiftKey && e.altKey && e.key === \"T\") {\n    chkTrace.checked = !chkTrace.checked;\n    return;\n  }\n});\n\ntype TransportState = \"ready\" | \"playing\" | \"paused\" | \"step-fwd\" | \"fast-fwd\" | \"done\";\nlet state: TransportState;\nsetState(\"ready\");\n\nbtnPause.addEventListener(\"click\", () => {\n  setState(\"paused\");\n});\nbtnSfwd.addEventListener(\"click\", () => {\n  setState(\"step-fwd\");\n});\nbtnPlay.addEventListener(\"click\", () => {\n  setState(\"playing\");\n});\nbtnFfwd.addEventListener(\"click\", () => {\n  setState(\"fast-fwd\");\n});\nbtnStop.addEventListener(\"click\", () => {\n  setState(\"ready\");\n});\n\nconst MAX_LOOP_COUNT = 10000;\n\nlet interpreter: Interpreter;\nfunction getNextAnimation(infiniteLoopDetector = 0): Animation {\n  try {\n    const instruction: Instruction = interpreter.stepToNextInstruction();\n\n    if (instruction) {\n      if (chkTrace.checked) {\n        clearEditorMarks();\n        const start = editor.findPosH(CodeMirror.Pos(0, 0), instruction.node.start, \"char\", true);\n        const end = editor.findPosH(CodeMirror.Pos(0, 0), instruction.node.end, \"char\", true);\n        editor.getDoc().markText(start, end, { css: \"background: rgba(128,255,128,0.4)\" })\n\n        return studio.setAnimation(instruction.animation || new Animation(10, (_, keyFrame) => keyFrame)); // FIXME:\n\n      } else {\n        if (instruction.animation) {\n          return studio.setAnimation(instruction.animation);\n        } else {\n          if (infiniteLoopDetector < MAX_LOOP_COUNT) {\n            return getNextAnimation(infiniteLoopDetector + 1);\n          } else {\n            clearEditorMarks();\n            markError(instruction.node.start, instruction.node.end);\n            output.clear();\n            output.error(\"WARNING: Possible infinite loop!\");\n            return studio.setAnimation(new Animation(state === \"fast-fwd\" ? 20000 : 20, (_, keyFrame) => keyFrame));\n          }\n        }\n      }\n    }\n  } catch (err) {\n    if (infiniteLoopDetector == 0) {\n      setState(\"done\");\n      markError(err.state.node.start, err.state.node.end, err.message);\n    }\n    throw err;\n  }\n\n  return studio.setAnimation(null);\n}\n\nfunction clearEditorMarks() {\n  editor.getDoc().getAllMarks().forEach(mark => mark.clear());\n}\nfunction markError(start: number, end: number, message?: string) {\n  const startPos = editor.findPosH(CodeMirror.Pos(0, 0), start, \"char\", true);\n  const endPos = editor.findPosH(CodeMirror.Pos(0, 0), end, \"char\", true);\n  editor.getDoc().markText(startPos, endPos, { css: \"background: rgba(255,128,128,0.4)\" })\n\n  if (message) {\n    output.error(message);\n  }\n}\n\nsetupMainLoop();\n\nfunction setState(nextState: TransportState) {\n  switch (nextState) {\n    case \"ready\":\n      hide(btnPause, btnStop);\n      show(btnSfwd, btnFfwd, btnPlay);\n\n      clearEditorMarks();\n      output.clear();\n      studio.reset();\n      break;\n\n    case \"playing\":\n      hide(btnPlay);\n      show(btnSfwd, btnPause, btnFfwd, btnStop);\n      disable(btnSfwd);\n\n      ensureRunning();\n\n      studio.animate();\n      break;\n\n    case \"step-fwd\":\n      hide(btnSfwd, btnPause, btnPlay, btnFfwd, btnStop);\n\n      ensureRunning();\n\n      studio.stepAnimate();\n\n      if (getNextAnimation()) {\n        setState(\"paused\");\n      } else {\n        setState(\"done\");\n      }\n\n      return;\n\n    case \"paused\":\n      hide(btnPause);\n      show(btnSfwd, btnPlay, btnFfwd, btnStop);\n\n      studio.freeze();\n      break;\n\n    case \"fast-fwd\":\n      hide(btnFfwd);\n      show(btnSfwd, btnPlay, btnPause, btnStop);\n      disable(btnSfwd);\n\n      ensureRunning();\n\n      studio.animate();\n      break;\n\n    case \"done\":\n      hide(btnPause);\n      show(btnSfwd, btnPlay, btnFfwd, btnStop);\n      disable()\n\n      clearEditorMarks();\n      studio.freeze();\n      break;\n  }\n\n  state = nextState;\n}\n\nfunction ensureRunning() {\n  if (state === \"ready\" || state === \"done\") {\n    editor.save();\n    try {\n      interpreter = new Interpreter(txtCode.value);\n    } catch (err) {\n      console.error(err)\n      setState(\"done\");\n\n      const message = /(.*)\\((\\d+):(\\d+)\\)\\s*$/.exec(err.message);\n      const startPos = CodeMirror.Pos(+message[2], +message[3]);\n      const token = editor.getTokenAt(startPos);\n      markError(token.start, token.end, message[1] + `'${token.string}'`);\n\n      throw err;\n    }\n\n    output.clear();\n    studio.reset();\n  }\n}\n\nfunction disable(...elements: HTMLButtonElement[]) {\n  elements.forEach(element => {\n    element.disabled = true;\n    element.classList.add(\"disabled\");\n  });\n}\nfunction enable(...elements: HTMLButtonElement[]) {\n  elements.forEach(element => {\n    element.disabled = false;\n    element.classList.remove(\"disabled\");\n  });\n}\nfunction hide(...elements: HTMLButtonElement[]) {\n  elements.forEach(element => element.style.display = \"none\");\n}\nfunction show(...elements: HTMLButtonElement[]) {\n  elements.forEach(element => element.style.display = \"inline-block\");\n  enable(...elements);\n}\n\nconst speed = 100;\n\nfunction setupMainLoop() {\n  MainLoop\n    .setUpdate(delta => {\n      if (state === \"step-fwd\") {\n        return;\n      }\n      if (state === \"fast-fwd\") {\n        delta *= 1000;\n      }\n      if (!studio.update(delta)) {\n        setState(\"done\");\n      }\n    });\n}\n\n"],"names":["a","b","x","q","e","l","d","t","i","h","f","g","j","k","c","u","o","v","w","m","n","p","r","s","module","this","global","factory","userAgent","platform","gecko","ie_upto10","ie_11up","edge","ie","ie_version","webkit","qtwebkit","chrome","chrome_version","presto","safari","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","flipCtrlCmd","captureRightClick","classTest","cls","rmClass","node","current","match","after","removeChildren","count","removeChildrenAndAdd","parent","elt","tag","content","className","style","eltP","range","start","end","endNode","contains","child","activeElt","rootNode","doc","activeElement","addClass","joinClasses","as","selectInput","cm","root","element","win","bind","args","copyObj","obj","target","overwrite","prop","countColumn","string","tabSize","startIndex","startValue","nextTab","Delayed","self","ms","time","indexOf","array","scrollerGap","Pass","sel_dontScroll","sel_mouse","sel_move","findColumn","goal","pos","col","skipped","spaceStrs","spaceStr","lst","arr","map","out","insertSorted","value","score","priority","nothing","createObj","base","props","inst","nonASCIISingleCaseWordChar","isWordCharBasic","ch","isWordChar","helper","isEmpty","extendingChars","isExtendingChar","skipExtendingChars","str","dir","findFirst","pred","from","to","midF","mid","iterateBidiSections","order","found","part","bidiOther","getBidiPartAt","sticky","cur","bidiOrdering","lowTypes","arabicTypes","charType","code","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","direction","outerType","len","types","i$1","prev","type","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","replace","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","at","isRTL","j$2","nstart","getOrder","line","noHandlers","on","emitter","getHandlers","off","index","signal","handlers","signalDOMEvent","override","e_defaultPrevented","signalCursorActivity","set","hasHandler","eventMixin","ctor","e_preventDefault","e_stopPropagation","e_stop","e_target","e_button","dragAndDrop","div","zwspSupported","zeroWidthElement","measure","test","badBidiRects","hasBadBidiRects","txt","r0","r1","splitLinesAuto","result","nl","rt","hasSelection","te","hasCopyEvent","badZoomedRects","hasBadZoomedRects","normal","fromRange","modes","mimeModes","defineMode","name","mode","defineMIME","mime","spec","resolveMode","getMode","options","mfactory","modeObj","modeExtensions","exts","prop$1","extendMode","properties","copyState","state","nstate","val","innerMode","info","startState","a1","a2","StringStream","lineOracle","ok","pattern","consume","caseInsensitive","cased","substr","inner","oracle","getLine","chunk","sz","getBetween","text","getLines","updateLineHeight","height","diff","lineNo","no","lineAtHeight","outer","lh","isLine","lineNumberFor","Pos","cmp","equalCursorPos","copyPos","maxPos","minPos","clipLine","clipPos","last","clipToLen","linelen","clipPosArray","SavedContext","lookAhead","Context","saved","copy","highlightLine","context","forceToEnd","st","lineClasses","runMode","loop","overlay","i_end","getLineStyles","updateFrontier","getContextBefore","resetState","precise","display","findStartLine","processLine","startAt","stream","callBlankLine","readToken","Token","takeToken","asArray","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","mName","minindent","minline","lim","search","indented","retreatFrontier","sawReadOnlySpans","sawCollapsedSpans","seeReadOnlySpans","seeCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","addMarkedSpan","op","inThisOp","markedSpansBefore","old","startCh","isInsert","nw","startsBefore","endsAfter","markedSpansAfter","endCh","stretchSpansOverChange","change","oldFirst","oldLast","first","sameLine","offset","span$1","found$1","clearEmptySpans","newMarkers","gap","gapMarkers","removeReadOnlyRanges","markers","mark","parts","mk","newParts","dfrom","dto","detachMarkedSpans","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","visualLine","merged","visualLineEnd","visualLineContinued","lines","visualLineNo","lineN","vis","visualLineEndNo","lineIsHidden","lineIsHiddenInner","heightAtLine","lineObj","lineLength","findMaxLine","Line","markedSpans","estimateHeight","updateLine","estHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","buildToken","buildTokenBadBidi","allowFrontierUpdate","insertLineContent","defaultSpecialCharPlaceholder","token","startStyle","endStyle","css","attributes","displayText","splitSpaces","special","mustWrap","txt$1","tabWidth","fullStyle","attr","trailingBefore","spaceBefore","buildCollapsedSpan","size","ignoreWidget","widget","styles","allText","nextChange","spanStyle","spanEndStyle","spanStartStyle","collapsed","foundBookmarks","endStyles","upto","tokenText","LineView","buildViewArray","nextPos","view","operationGroup","pushOperation","fireCallbacksForOps","group","callbacks","finishOperation","endCb","orphanDelayedCallbacks","signalLater","list","fireOrphanDelayed","delayed","updateLineForChanges","dims","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","updateLineBackground","wrap","getLineContent","ext","built","textClass","wrap$1","gutterWrap","id","isWidget","next","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","ws","positionLineWidget","width","widgetHeight","parentStyle","eventInWidget","paddingTop","paddingVert","paddingH","data","scrollGap","displayWidth","displayHeight","ensureLineHeights","rect","wrapping","curWidth","heights","rects","mapFromLineView","updateExternalMeasurement","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","prepared","varHeight","key","measureCharInner","nullRect","nodeAndOffsetInLineMap","collapse","mStart","mEnd","getUsefulRect","place","maybeUpdateRectForZooming","rSpan","charWidth","rtop","rbot","top","bot","scaleX","scaleY","clearLineMeasurementCacheFor","clearLineMeasurementCache","clearCaches","pageScrollX","pageScrollY","widgetTopHeight","ref","widgets","intoCoordSystem","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","left","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","get","right","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","y","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","targetTop","boxIsAfter","box","ltr","coordsBidiPartWrapped","coordsBidiPart","chAround","boxAround","baseX","atLeft","atStart","_lineNo","closestDist","endX","dist","measureText","textHeight","anchor","pre","gutterLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","posFromMouse","liberal","forRect","space","colDiff","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","adjustView","countDirtyView","dirty","updateSelection","prepareSelection","primary","curFragment","selFragment","customCursor","head","drawSelectionCursor","drawSelectionRange","cursor","charPos","otherCursor","cmpCoords","fragment","padding","leftSide","rightSide","docLTR","add","bottom","drawForLine","fromArg","toArg","lineLen","wrapX","side","extent","fromPos","toPos","openStart","openEnd","openLeft","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","onBlur","ensureFocus","onFocus","delayBlurEvent","updateHeightsInViewport","prevBottom","viewTop","oldHeight","mustScroll","updateWidgetHeight","chWidth","visibleLines","viewport","ensureFrom","ensureTo","maybeScrollWindow","doScroll","scrollNode","scrollPosIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","scrollIntoView","snapMargin","screentop","screen","docBottom","atTop","atBottom","newTop","gutterSpace","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","scrollToCoords","scrollToRange","scrollToCoordsRange","sPos","updateDisplaySimple","setScrollTop","startWorker","forceScroll","isScroller","alignHorizontally","measureForScrollbars","gutterW","docH","NativeScrollbars","scroll","vert","horiz","needsH","needsV","sWidth","totalHeight","totalWidth","bar","delay","maybeDisable","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","scrollbarModel","initScrollbars","axis","nextOpId","startOperation","endOperation","endOperations","ops","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","maybeClipScrollbars","DisplayUpdate","updateDisplayIfNeeded","takeFocus","setDocumentHeight","postUpdateDisplay","hidden","unhidden","runInOp","operation","methodOp","docMethodOp","highlightWorker","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","force","selectionSnapshot","active","sel","restoreSelection","snapshot","update","maybeUpdateLineNumberWidth","different","toUpdate","selSnapshot","patchDisplay","barMeasure","updateNumbersFrom","lineNumbers","container","rm","updateNumber","updateGutterSpace","comp","align","innerW","getGutters","gutters","sawLineNumbers","renderGutters","specs","gElt","updateGutters","Display","input","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","dy","wheelEventPixels","delta","onScrollWheel","pixelsPerUnit","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","ranges","primIndex","here","there","Range","normalizeSelection","mayTouch","prim","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","computeReplacedSel","changes","hint","oldPrev","newPrev","loadMode","resetModeState","isWholeLineUpdate","updateDoc","spansFor","linesFor","firstLine","lastLine","lastText","lastSpans","nlines","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","rel","shared","attachDoc","setDirectionClass","directionChanged","History","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","lastChangeEvent","hist","addChangeToHistory","selAfter","opId","pushSelectionToHistory","selectionEventCanBeMerged","origin","addSelectionToHistory","dest","existing","removeClearedSpans","getOldSpans","mergeOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","events","newGroup","instantiateSel","event","newChanges","extendRange","extend","posBefore","extendSelection","setSelection","extendSelections","heads","newSel","replaceOneSelection","setSimpleSelection","filterSelectionChange","setSelectionReplaceHistory","done","setSelectionNoUndo","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","preventCursorLeft","preventCursorRight","near","movePos","far","selectAll","filterChange","makeChange","ignoreReadOnly","split","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","source","antiChanges","filter","returned","shiftDoc","distance","shift","makeChangeSingleDocInEditor","recomputeMaxLength","checkWidthStart","changesHandler","changeHandler","replaceRange","assign","rebaseHistSelSingle","rebaseHistArray","sub","changeLine","handle","changeType","LeafChunk","BranchChunk","children","remaining","leaf","me","spilled","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","addLineWidget","aboveVisible","nextMarkerId","TextMarker","withOp","min","max","visual","dHeight","markText","markTextShared","curLine","updateMaxLine","SharedTextMarker","findSharedMarkers","copySharedMarkers","mFrom","mTo","subMark","detachSharedMarkers","linked","subMarker","nextDocId","Doc","lineSep","dup","undone","forceSplit","gen","histData","gutterID","where","realOpts","sepSize","copyHistory","CodeMirror","link","splitIds","lastDrop","onDrop","clearDragCursor","files","read","markAsReadAndPasteIfAllFilesAreRead","readTextFromFile","file","reader","text$1","selected","onDragStart","img","onDragOver","frag","forEachCodeMirror","byClass","editors","globalsRegistered","ensureGlobalHandlers","registerGlobalHandlers","resizeTimer","onResize","keyNames","keyMap","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","keys","lookupKey","getKeyMap","isModifierKey","addModifierNames","noShift","keyName","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","moveInStorageOrder","prep","moveVisually","bidi","mv","getWrappedLineExtent","searchInVisualLine","getRes","res","nextCh","commands","leftPos","rightPos","lineStart","lineStartSmart","lineEnd","spaces","sels","firstNonWS","inWS","doHandleBinding","bound","dropShift","prevShift","lookupKeyForEditor","stopSeq","dispatchKey","seq","dispatchKeyInner","handleKeyBinding","handleCharBinding","lastStoppedKey","onKeyDown","handled","showCrossHair","lineDiv","up","onKeyUp","onKeyPress","keyCode","charCode","DOUBLECLICK_DELAY","PastClick","button","lastClick","lastDoubleClick","clickRepeat","now","onMouseDown","clickInGutter","repeat","handleMappedButton","leftButtonDown","configureMouse","option","behavior","contained","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","e2","rangeForUnit","unit","ourRange","ourIndex","startSel","lastPos","extendTo","startCol","posCol","oldRange","ranges$1","bidiSimplify","editorSize","counter","curCount","visible","move","anchorLine","boundary","headIndex","usePart","gutterEvent","prevent","mX","mY","lineBox","gutter","onContextMenu","contextMenuInGutter","themeChanged","Init","defaults","optionHandlers","defineOptions","deflt","notOnInit","newBreaks","wrappingChanged","integer","dragDropChanged","wasOn","funcs","toggle","registerEventHandlers","initHooks","word","touchFinished","prevTouch","finishTouch","isMouseLikeTouchEvent","touch","farAway","inp","indentLine","how","aggressive","curSpace","curSpaceString","indentation","indentString","pos$1","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","paste","textLines","multiPaste","updateInput","changeEvent","triggerElectric","handlePaste","pasted","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","autocorrect","autocapitalize","hiddenTextarea","addEditorMethods","helpers","maps","overlays","newRanges","help","vspace","hspace","amount","findPosH","goalColumn","findPosV","goals","headPos","startChar","check","scroller","interpret","phraseText","phrases","predicate","origDir","lineDir","findNextLine","moveOnce","boundToLine","astral","sawType","pageSize","moveAmount","ContentEditableInput","belongsToInput","onCopyCut","kludge","hadFocus","label","curAnchor","domToPos","curFocus","posToDOM","rng","poll","isInGutter","fromIndex","fromNode","toIndex","toNode","newText","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","scan","badPos","bad","closing","extraLinebreak","recognizeMarker","close","addText","walk","cmText","markerID","isBlock","lineNode","locateNodeInLineView","wrapper","textNode","topNode","find","curNode","dist$1","TextareaInput","prepareCopyCut","_display","opts","wrapOff","lineOff","drawn","typing","missed","prevInput","same","reset","oldCSS","oldWrapperCSS","wrapperBox","oldScrollY","rehide","prepareSelectAllHack","extval","mouseup","fromTextArea","textarea","hasFocus","save","realSubmit","form","wrappedSubmit","addLegacyProps","dontDelegate","method","func","require$$0","config","parserConfig","indentUnit","statementIndent","jsonldMode","jsonMode","trackScope","isTS","wordRE","keywords","kw","A","B","C","D","operator","atom","isOperatorChar","isJsonldKeyword","readRegexp","escaped","inSet","ret","tp","cont","tokenBase","tokenString","tokenComment","expressionAllowed","tokenQuasi","quote","maybeEnd","brackets","findFatArrow","arrow","depth","sawSomething","bracket","atomicTypes","JSLexical","column","inScope","varname","cx","parseJS","cc","combinator","expression","statement","pass","inList","register","newContext","registerVarScoped","Var","isModifier","vars","block","defaultVars","pushcontext","pushblockcontext","popcontext","pushlex","indent","poplex","expect","wanted","exp","vardef","parenExpr","maybeexpression","maybeelse","functiondef","forspec","enumdef","typename","typeexpr","maybelabel","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","expressionNoComma","noComma","body","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","arrayLiteral","contCommasep","objprop","quasi","maybeTarget","expr","property","continueQuasi","targetNoComma","maybeTypeArgs","_","getterSetter","afterprop","maybetype","what","sep","proceed","lex","maybetypeOrIn","mayberettype","isKW","afterType","typeprops","typearg","maybeReturnType","quasiType","typeprop","functiondecl","continueQuasiType","typeparam","maybeTypeDefault","maybeAssign","vardefCont","eltpattern","proppattern","_type","forspec1","forspec2","classNameAfter","classBody","classfield","isInterface","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","isContinuedStatement","textAfter","backUp","basecolumn","firstChar","lexical","deg2rad","degrees","Vector2d","angle","modulo","that","point","Segment","translation","coords2Vector2d","ctx","ratio","Frame","position","facing","opacity","strokes","foreground","background","Animation","duration","keyFrame","__viteBrowserExternal","__webpack_modules__","__unused_webpack_exports","__webpack_require__","Interpreter","opt_initFunc","nodeConstructor","ast","stepMatch","methodName","sourceFile","stack","endTime","oldInterpreterValue","nextState","task","globalObject","thisInterpreter","_x","strFunctions","nativeFunc","var_args","pid","identifierRegexp","argsStr","thisArg","throwIfNullUndefined","proto","descriptor","getter","setter","pseudoDescriptor","newArray","functions","compareString","locales","separator","callback","sandbox","jsList","splitWorker","regexp","matchWorker","searchWorker","newSubstr","replaceWorker","numConsts","fractionDigits","digits","precision","radix","_value","date","flags","rgx","nativeRegExp","execWorker","thisPseudoRegExp","opt_message","newError","createErrorSubclass","constructor","myMath","mathConsts","numFunctions","myJSON","nativeObj","replacer","pseudoRegexp","nativeRegexp","pseudoError","tracebackData","errorName","errorMessage","stackString","loc","locString","blob","worker","argumentLength","isConstructor","scope","opt_name","asyncFunc","opt_cycles","cycles","pseudoDate","prototype","pseudoFunction","pseudoObj","nativeDate","opt_descriptor","strict","defObj","parentScope","firstNode","object","opt_object","prevNode","variableCache","nodeClass","childCache","errorClass","error","realError","errorTable","message","errorConstructor","argument","isInterval","parentState","argsArray","exec","functionRef","execNode","execStart","execEnd","funcThis","newScope","newStack","strs","maxLength","truncated","interval","elements","leftValue","rightValue","funcNode","argsList","paramName","paramValue","evalNode","argLength","argsWithCallback","gotPropName","labels","propName","kinds","switchCase","changeValue","returnValue","declarations","declarationNode","exports","inputLen","inpt","setOptions","initTokenState","parseTopLevel","defaultOptions","getLineInfo","lineBreak","tokPos","tokStart","tokEnd","tokStartLoc","tokEndLoc","tokType","tokVal","tokRegexpAllowed","tokCurLine","tokLineStart","lastStart","lastEnd","lastEndLoc","inFunction","raise","err","empty","_num","_regexp","_string","_name","_eof","_break","_case","_catch","_continue","_debugger","_default","_do","_else","_finally","_for","_function","_if","_return","_switch","_throw","_try","_var","_while","_with","_new","_this","_null","_true","_false","_in","keywordTypes","_bracketL","_bracketR","_braceL","_braceR","_parenL","_parenR","_comma","_semi","_colon","_dot","_question","_slash","_eq","_assign","_incDec","_prefix","_logicalOR","_logicalAND","_bitwiseOR","_bitwiseXOR","_bitwiseAND","_equality","_relational","_bitShift","_plusMin","_multiplyModulo","makePredicate","words","wordList","isReservedWord5","isStrictReservedWord","isStrictBadIdWord","isKeyword","nonASCIIwhitespace","nonASCIIidentifierStartChars","nonASCIIidentifierChars","nonASCIIidentifierStart","nonASCIIidentifier","newline","isIdentifierStart","isIdentifierChar","line_loc_t","skipSpace","finishToken","skipBlockComment","startLoc","skipLineComment","readToken_dot","readNumber","readToken_slash","finishOp","readToken_mult_modulo","readToken_pipe_amp","readToken_caret","readToken_plus_min","readToken_lt_gt","readToken_eq_excl","getTokenFromCode","readHexNumber","readString","forceRegexp","readWord","tok","inClass","mods","readWord1","readInt","total","startsWithDot","isFloat","octal","readHexChar","containsEsc","esc","escStr","setStrict","strct","node_t","node_loc_t","startNode","startNodeFrom","finishNode","isUseStrict","stmt","eat","canInsertSemicolon","semicolon","unexpected","checkLVal","program","parseStatement","loopLabel","switchLabel","starttype","isBreak","parseIdent","lab","parseParenExpression","parseFor","init","parseVar","parseForIn","parseExpression","parseFunction","sawDefault","isCase","parseBlock","clause","maybeName","kind","allowStrict","oldStrict","noIn","decl","parseMaybeAssign","parseMaybeConditional","parseExprOps","parseExprOp","parseMaybeUnary","minPrec","prec","exprNode","parseExprSubscripts","parseSubscripts","parseExprAtom","noCalls","parseExprList","tokStartLoc1","tokStart1","parseObj","parseNew","sawGetSet","parsePropertyName","isGetSet","conflict","isStatement","oldInFunc","oldLabels","allowTrailingComma","allowEmpty","elts","__webpack_module_cache__","moduleId","cachedModule","definition","__webpack_exports__","__WEBPACK_DEFAULT_EXPORT__","acorn","Stroke","color","scale","txtOut","clear","Instruction","currentState","animation","MOVE_DURATION","ROTATE_DURATION","RISE_DURATION","FALL_DURATION","FADE_DURATION","instructionStack","interpreter","setFn","fn","fg","bg","question","MainLoop","output.info","seconds","checkRange","fnWrapper","desc","JSInterpreter","recoverState","instruction","seek","ZOOM_DOWN","ZOOM_UP","Painter","frame","cy","_5","_3","zRatio","red","green","blue","R","ReflectApply","receiver","ReflectOwnKeys","ProcessEmitWarning","warning","NumberIsNaN","EventEmitter","eventsModule","once","defaultMaxListeners","checkListener","listener","arg","_getMaxListeners","doError","er","handler","listeners","arrayClone","_addListener","prepend","onceWrapper","_onceWrap","wrapped","originalListener","spliceOne","_listeners","unwrap","evlistener","unwrapListeners","listenerCount","resolve","reject","errorListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","wrapListener","debounce","wait","immediate","timeout","later","RAM","editor","__privateAdd","_currentState","ramValue","__privateSet","__privateGet","Disk","_Disk_instances","savesValue","__privateMethod","get_fn","idx","SavesList","ram","disk","items","currentName","item","itemName","output.clear","currEl","newState","nextItem","UI","saves","uis","initialize","ui","PainterStudio","getNextAnimation","speed","stroke","WIDTH","HEIGHT","X","Y","STEP","canvasHolder","canvas","studio","setCanvasSize","txtCode","diskUI","disk.initialize","btnPause","btnSfwd","btnPlay","btnFfwd","btnStop","btnHelp","dlgHelp","btnCloseDialog","chkTrace","clearEditorMarks","setState","MAX_LOOP_COUNT","infiniteLoopDetector","markError","output.error","startPos","endPos","setupMainLoop","hide","show","disable","ensureRunning","enable"],"mappings":"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MAAQ,KAAK,qBAAqB/O,EAAS,EAAI,EACpD,KAAK,YAAc,KAAK,MAAM,WAAW,UACzC,KAAK,YAAY+N,EAAc,QAAS,KAAK,MACzCZ,EAAY,wBAAwB,EAGxCnN,EAAU,SAAiBprC,EAAK,CAC9B,OAAOA,GAAOA,EAAI,QAAU,OAChC,EACE,KAAK,YAAY,KAAK,MAAO,UACZ,KAAK,qBAAqBorC,EAAS,EAAK,EACxCmN,EAAY,wBAAwB,EAGrD,KAAK,YAAY,KAAK,YAAa,SAAU,EACzC,CAAC,aAAgB,GAAO,WAAc,GAAO,SAAY,EAAI,CAAC,EAClE,KAAK,YAAY,MAAQ,QAEzB,KAAK,WAAW,KAElB,gBACE,4CACE,sDACA,+CACI,sDACN,IAEA,4BACE,eACE,gCACA,8CACA,yBACE,gBACA,oBACF,IACA,SACA,kBACA,iBACA,kBACA,YACF,IACF,KAEA,6BACE,uBACE,gCACA,8CACA,+CACE,yBACA,SACF,IACA,kBACA,cACF,IACF,KAEA,8BACE,eACE,gCACA,8CACA,yBACE,gBACA,oBACF,IACA,oBACA,sCACE,sBACE,mBACF,WACE,eACF,IACF,IACA,eACA,sBACA,gBACF,IACF,KAEA,gCACE,uBACE,gCACA,8CACA,yBACE,WACF,IACA,uCACE,gBACE,kCACF,WACE,kCACF,IACF,IACA,+CACE,uBACF,IACA,8CACF,IACF,KAEA,gCACE,eACE,gCACA,8CACA,yBACE,YACF,IACA,4CACE,gBACA,qBACA,4BACE,yBACF,WACE,eACF,IACA,cACE,sBACF,WACE,yBACF,IACF,IACA,YACF,IACF,KAEA,gCACE,uCACE,gCACA,8CACA,yBACA,0BACE,aACF,IACA,uDACA,oBACE,0CACE,YACF,IACA,OACF,IACA,aACF,IACF,KAEA,oCACE,uCACE,gCACA,8CACA,cACE,aACF,IACA,mBACA,8BACE,qBACA,WACE,+CACF,IACF,IACA,6DACA,mBACE,0CACE,YACF,IACA,OACF,IACA,aACF,IACF,KAEA,8BACE,yBACE,gCACA,8CAEA,cACA,2DAEA,oCACE,0BACE,YACF,IACA,iBACE,mBACF,WACE,4BACF,IACF,WACE,aACF,IACA,0BACA,gCACA,mCACE,0BACE,4BACF,IACF,IACA,iBACF,IACF,KAEA,+BACE,2CACE,gCACA,8CACA,cACA,mBACE,oCACF,WACE,gCACF,IACA,8BACE,6BACF,WACE,oBACA,iEACF,IACA,oBAEA,sDACE,gBACE,sBACF,WACE,oBACF,IACA,gCACE,6BACF,WACE,eACF,IACF,IAEA,kEACE,gCACE,6BACF,WACE,eACF,IACF,IAEA,kDACE,eACF,IACA,sBAEA,8BACE,kCACA,2CACE,gBACE,qBACF,WACE,qBACF,IACF,IACA,cACA,+CACE,mCACF,IACF,IACA,kBACA,kBACF,IACF,KAEA,+BACE,uBACE,gCACA,wBACA,mBACA,gDACE,6CACA,8BACE,kDACE,oBACE,yBACF,WACE,mBACF,IACF,IACF,WACE,sBACF,IACF,IACA,iBACF,IACF,KAEA,6BACE,4BACE,gCACA,8CACA,mDACI,8BACJ,gBACA,kCACE,4BACA,4DACF,IACA,cACF,IACF,KAIA,8BACE,gCACE,kEACA,gBACA,8CACA,yCACA,oBACE,6DACA,OACF,IACA,eACF,IACF,KAIA,+BACE,iCACE,kEACA,8CACA,gBACA,+DACA,kCACE,gBACE,kBACA,wDACF,IACF,IACA,cACF,IACF,KAIA,gCACE,gCACE,kEACA,gBACA,8CACA,yCACA,oBACE,4CACA,OACF,IACF,IACF,KAIA,4BACE,gCACE,kEACA,gBACA,8CACA,yCACA,0BACA,oBACE,mDACA,OACF,IACA,YACF,IACF,KAIA,+BACE,0CACE,kEACA,8CACA,oBACA,gCACE,wBACF,WACE,oCACA,kBACE,kEACF,IACA,kBACF,IACA,yBACE,mDACF,IACA,gBACF,IACF,KAIA,oCACE,0CACE,kEACA,8CACA,0BACA,+BACE,wBACF,WACE,mCACA,eACE,kEACF,IACA,kBACF,IACA,wBACE,mDACF,IACA,gBACF,IACF,KAIA,6BACE,qCACE,kEACA,8CACA,+DACA,kCACE,iEAC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","x_google_ignoreList":[0,1,2,6,11]}